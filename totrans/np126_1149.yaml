- en: NumPy 1.16.4 Release Notes
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://numpy.org/doc/1.26/release/1.16.4-notes.html](https://numpy.org/doc/1.26/release/1.16.4-notes.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The NumPy 1.16.4 release fixes bugs reported against the 1.16.3 release, and
    also backports several enhancements from master that seem appropriate for a release
    series that is the last to support Python 2.7\. The wheels on PyPI are linked
    with OpenBLAS v0.3.7-dev, which should fix issues on Skylake series cpus.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: Downstream developers building this release should use Cython >= 0.29.2 and,
    if using OpenBLAS, OpenBLAS > v0.3.7\. The supported Python versions are 2.7 and
    3.5-3.7.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: New deprecations
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Writeable flag of C-API wrapped arrays
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When an array is created from the C-API to wrap a pointer to data, the only
    indication we have of the read-write nature of the data is the `writeable` flag
    set during creation. It is dangerous to force the flag to writeable. In the future
    it will not be possible to switch the writeable flag to `True` from python. This
    deprecation should not affect many users since arrays created in such a manner
    are very rare in practice and only available through the NumPy C-API.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Compatibility notes
  id: totrans-7
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Potential changes to the random stream
  id: totrans-8
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Due to bugs in the application of log to random floating point numbers, the
    stream may change when sampling from `np.random.beta`, `np.random.binomial`, `np.random.laplace`,
    `np.random.logistic`, `np.random.logseries` or `np.random.multinomial` if a 0
    is generated in the underlying MT19937 random stream. There is a 1 in \(10^{53}\)
    chance of this occurring, and so the probability that the stream changes for any
    given seed is extremely small. If a 0 is encountered in the underlying generator,
    then the incorrect value produced (either `np.inf` or `np.nan`) is now dropped.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Changes
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[`numpy.lib.recfunctions.structured_to_unstructured`](../user/basics.rec.html#numpy.lib.recfunctions.structured_to_unstructured
    "numpy.lib.recfunctions.structured_to_unstructured") does not squeeze single-field
    views'
  id: totrans-11
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Previously `structured_to_unstructured(arr[['a']])` would produce a squeezed
    result inconsistent with `structured_to_unstructured(arr[['a', b']])`. This was
    accidental. The old behavior can be retained with `structured_to_unstructured(arr[['a']]).squeeze(axis=-1)`
    or far more simply, `arr['a']`.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: Contributors
  id: totrans-13
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A total of 10 people contributed to this release. People with a “+” by their
    names contributed a patch for the first time.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: Charles Harris
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Eric Wieser
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dennis Zollo +
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hunter Damron +
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Jingbei Li +
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kevin Sheppard
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Matti Picus
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nicola Soranzo +
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sebastian Berg
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tyler Reddy
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pull requests merged
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A total of 16 pull requests were merged for this release.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: '[#13392](https://github.com/numpy/numpy/pull/13392): BUG: Some PyPy versions
    lack PyStructSequence_InitType2.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13394](https://github.com/numpy/numpy/pull/13394): MAINT, DEP: Fix deprecated
    `assertEquals()`'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13396](https://github.com/numpy/numpy/pull/13396): BUG: Fix structured_to_unstructured
    on single-field types (backport)'
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13549](https://github.com/numpy/numpy/pull/13549): BLD: Make CI pass again
    with pytest 4.5'
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13552](https://github.com/numpy/numpy/pull/13552): TST: Register markers
    in conftest.py.'
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13559](https://github.com/numpy/numpy/pull/13559): BUG: Removes ValueError
    for empty kwargs in arraymultiter_new'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13560](https://github.com/numpy/numpy/pull/13560): BUG: Add TypeError to
    accepted exceptions in crackfortran.'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13561](https://github.com/numpy/numpy/pull/13561): BUG: Handle subarrays
    in descr_to_dtype'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13562](https://github.com/numpy/numpy/pull/13562): BUG: Protect generators
    from log(0.0)'
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13563](https://github.com/numpy/numpy/pull/13563): BUG: Always return views
    from structured_to_unstructured when…'
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13564](https://github.com/numpy/numpy/pull/13564): BUG: Catch stderr when
    checking compiler version'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13565](https://github.com/numpy/numpy/pull/13565): BUG: longdouble(int) does
    not work'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13587](https://github.com/numpy/numpy/pull/13587): BUG: distutils/system_info.py
    fix missing subprocess import (#13523)'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13620](https://github.com/numpy/numpy/pull/13620): BUG,DEP: Fix writeable
    flag setting for arrays without base'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13641](https://github.com/numpy/numpy/pull/13641): MAINT: Prepare for the
    1.16.4 release.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13644](https://github.com/numpy/numpy/pull/13644): BUG: special case object
    arrays when printing rel-, abs-error'
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: New deprecations
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Writeable flag of C-API wrapped arrays
  id: totrans-44
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When an array is created from the C-API to wrap a pointer to data, the only
    indication we have of the read-write nature of the data is the `writeable` flag
    set during creation. It is dangerous to force the flag to writeable. In the future
    it will not be possible to switch the writeable flag to `True` from python. This
    deprecation should not affect many users since arrays created in such a manner
    are very rare in practice and only available through the NumPy C-API.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: Writeable flag of C-API wrapped arrays
  id: totrans-46
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When an array is created from the C-API to wrap a pointer to data, the only
    indication we have of the read-write nature of the data is the `writeable` flag
    set during creation. It is dangerous to force the flag to writeable. In the future
    it will not be possible to switch the writeable flag to `True` from python. This
    deprecation should not affect many users since arrays created in such a manner
    are very rare in practice and only available through the NumPy C-API.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: Compatibility notes
  id: totrans-48
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Potential changes to the random stream
  id: totrans-49
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Due to bugs in the application of log to random floating point numbers, the
    stream may change when sampling from `np.random.beta`, `np.random.binomial`, `np.random.laplace`,
    `np.random.logistic`, `np.random.logseries` or `np.random.multinomial` if a 0
    is generated in the underlying MT19937 random stream. There is a 1 in \(10^{53}\)
    chance of this occurring, and so the probability that the stream changes for any
    given seed is extremely small. If a 0 is encountered in the underlying generator,
    then the incorrect value produced (either `np.inf` or `np.nan`) is now dropped.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: Potential changes to the random stream
  id: totrans-51
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Due to bugs in the application of log to random floating point numbers, the
    stream may change when sampling from `np.random.beta`, `np.random.binomial`, `np.random.laplace`,
    `np.random.logistic`, `np.random.logseries` or `np.random.multinomial` if a 0
    is generated in the underlying MT19937 random stream. There is a 1 in \(10^{53}\)
    chance of this occurring, and so the probability that the stream changes for any
    given seed is extremely small. If a 0 is encountered in the underlying generator,
    then the incorrect value produced (either `np.inf` or `np.nan`) is now dropped.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
- en: Changes
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[`numpy.lib.recfunctions.structured_to_unstructured`](../user/basics.rec.html#numpy.lib.recfunctions.structured_to_unstructured
    "numpy.lib.recfunctions.structured_to_unstructured") does not squeeze single-field
    views'
  id: totrans-54
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Previously `structured_to_unstructured(arr[['a']])` would produce a squeezed
    result inconsistent with `structured_to_unstructured(arr[['a', b']])`. This was
    accidental. The old behavior can be retained with `structured_to_unstructured(arr[['a']]).squeeze(axis=-1)`
    or far more simply, `arr['a']`.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '[`numpy.lib.recfunctions.structured_to_unstructured`](../user/basics.rec.html#numpy.lib.recfunctions.structured_to_unstructured
    "numpy.lib.recfunctions.structured_to_unstructured") does not squeeze single-field
    views'
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Previously `structured_to_unstructured(arr[['a']])` would produce a squeezed
    result inconsistent with `structured_to_unstructured(arr[['a', b']])`. This was
    accidental. The old behavior can be retained with `structured_to_unstructured(arr[['a']]).squeeze(axis=-1)`
    or far more simply, `arr['a']`.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: Contributors
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A total of 10 people contributed to this release. People with a “+” by their
    names contributed a patch for the first time.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: Charles Harris
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Eric Wieser
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dennis Zollo +
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hunter Damron +
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Jingbei Li +
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kevin Sheppard
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Matti Picus
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nicola Soranzo +
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sebastian Berg
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tyler Reddy
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pull requests merged
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A total of 16 pull requests were merged for this release.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: '[#13392](https://github.com/numpy/numpy/pull/13392): BUG: Some PyPy versions
    lack PyStructSequence_InitType2.'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13394](https://github.com/numpy/numpy/pull/13394): MAINT, DEP: Fix deprecated
    `assertEquals()`'
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13396](https://github.com/numpy/numpy/pull/13396): BUG: Fix structured_to_unstructured
    on single-field types (backport)'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[#13549](https://github.com/numpy/numpy/pull/13549): BLD: Make CI pass again
    with pytest 4.5'
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13549](https://github.com/numpy/numpy/pull/13549): BLD: 使用 pytest 4.5 使 CI
    重新通过。'
- en: '[#13552](https://github.com/numpy/numpy/pull/13552): TST: Register markers
    in conftest.py.'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13552](https://github.com/numpy/numpy/pull/13552): TST: 在 conftest.py 中注册标记。'
- en: '[#13559](https://github.com/numpy/numpy/pull/13559): BUG: Removes ValueError
    for empty kwargs in arraymultiter_new'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13559](https://github.com/numpy/numpy/pull/13559): BUG: 移除 arraymultiter_new
    中空 kwargs 的 ValueError。'
- en: '[#13560](https://github.com/numpy/numpy/pull/13560): BUG: Add TypeError to
    accepted exceptions in crackfortran.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13560](https://github.com/numpy/numpy/pull/13560): BUG: 在 crackfortran 中添加
    TypeError 到被接受的异常中。'
- en: '[#13561](https://github.com/numpy/numpy/pull/13561): BUG: Handle subarrays
    in descr_to_dtype'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13561](https://github.com/numpy/numpy/pull/13561): BUG: 处理 descr_to_dtype
    中的子数组。'
- en: '[#13562](https://github.com/numpy/numpy/pull/13562): BUG: Protect generators
    from log(0.0)'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13562](https://github.com/numpy/numpy/pull/13562): BUG: 保护生成器免受 log(0.0)。'
- en: '[#13563](https://github.com/numpy/numpy/pull/13563): BUG: Always return views
    from structured_to_unstructured when…'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13563](https://github.com/numpy/numpy/pull/13563): BUG: 在 structured_to_unstructured
    中始终返回视图 when…'
- en: '[#13564](https://github.com/numpy/numpy/pull/13564): BUG: Catch stderr when
    checking compiler version'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13564](https://github.com/numpy/numpy/pull/13564): BUG: 检查编译器版本时捕获 stderr。'
- en: '[#13565](https://github.com/numpy/numpy/pull/13565): BUG: longdouble(int) does
    not work'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13565](https://github.com/numpy/numpy/pull/13565): BUG: longdouble(int) 不起作用。'
- en: '[#13587](https://github.com/numpy/numpy/pull/13587): BUG: distutils/system_info.py
    fix missing subprocess import (#13523)'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13587](https://github.com/numpy/numpy/pull/13587): BUG: distutils/system_info.py
    修复缺少的 subprocess 导入（#13523）。'
- en: '[#13620](https://github.com/numpy/numpy/pull/13620): BUG,DEP: Fix writeable
    flag setting for arrays without base'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13620](https://github.com/numpy/numpy/pull/13620): BUG,DEP: 为没有基础的数组修复可写标志设置。'
- en: '[#13641](https://github.com/numpy/numpy/pull/13641): MAINT: Prepare for the
    1.16.4 release.'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13641](https://github.com/numpy/numpy/pull/13641): MAINT: 为1.16.4版本做准备。'
- en: '[#13644](https://github.com/numpy/numpy/pull/13644): BUG: special case object
    arrays when printing rel-, abs-error'
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[#13644](https://github.com/numpy/numpy/pull/13644): BUG: 在打印 rel-, abs-error
    时特殊处理对象数组。'
