# scipy.signal.lombscargle

> 原文链接：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.signal.lombscargle.html#scipy.signal.lombscargle](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.signal.lombscargle.html#scipy.signal.lombscargle)

```py
scipy.signal.lombscargle(x, y, freqs)
```

计算Lomb-Scargle周期图。

Lomb-Scargle周期图由Lomb [[1]](#r0520a0371844-1)开发，并由Scargle [[2]](#r0520a0371844-2)进一步扩展，用于发现和测试不均匀时间采样中弱周期信号的显著性。

当 *normalize* 设置为False（默认值）时，计算得到的周期图未归一化，对于具有振幅A的谐波信号，对于足够大的N，它取值为`(A**2) * N/4`。

当 *normalize* 设置为True时，计算得到的周期图将通过数据围绕常数参考模型（在零点）的残差进行归一化。

输入数组应为1-D，并将转换为float64类型。

参数：

**x**array_like

样本时间。

**y**array_like

测量值。

**freqs**array_like

输出周期图的角频率。

**precenter**bool, optional

通过减去均值预置测量值。

**normalize**bool, optional

计算归一化周期图。

返回：

**pgram**array_like

Lomb-Scargle周期图。

Raises：

ValueError

如果输入数组 *x* 和 *y* 的形状不同。

另见

[`istft`](scipy.signal.istft.html#scipy.signal.istft "scipy.signal.istft")

逆短时傅立叶变换

[`check_COLA`](scipy.signal.check_COLA.html#scipy.signal.check_COLA "scipy.signal.check_COLA")

检查是否满足常数重叠加（COLA）约束

[`welch`](scipy.signal.welch.html#scipy.signal.welch "scipy.signal.welch")

Welch方法的功率谱密度

[`spectrogram`](scipy.signal.spectrogram.html#scipy.signal.spectrogram "scipy.signal.spectrogram")

Welch方法的谱图

[`csd`](scipy.signal.csd.html#scipy.signal.csd "scipy.signal.csd")

Welch方法的交叉谱密度

Notes

此子程序使用了由Townsend稍作修改的算法来计算周期图[[3]](#r0520a0371844-3)，该算法允许在每个频率上仅通过输入数组的一次传递计算周期图。

算法运行时间大致按O(x * freqs)或O(N^2)缩放，适用于大量样本和频率。

参考文献

[[1](#id1)]

N.R. Lomb，“不等间隔数据的最小二乘频率分析”，《天体物理学和空间科学》，第39卷，第447-462页，1976年

[[2](#id2)]

J.D. Scargle，“天文时间序列分析研究 II - 不均匀间隔数据谱分析的统计方面”，《天体物理学期刊》，第263卷，第835-853页，1982年

[[3](#id3)]

R.H.D. Townsend，“使用图形处理单元快速计算Lomb-Scargle周期图”，《天体物理学期刊增刊》，第191卷，第247-253页，2010年

示例

```py
>>> import numpy as np
>>> import matplotlib.pyplot as plt
>>> rng = np.random.default_rng() 
```

首先为信号定义一些输入参数：

```py
>>> A = 2.
>>> w0 = 1.  # rad/sec
>>> nin = 150
>>> nout = 100000 
```

随机生成样本时间：

```py
>>> x = rng.uniform(0, 10*np.pi, nin) 
```

绘制所选时间的正弦波：

```py
>>> y = A * np.cos(w0*x) 
```

定义用于计算周期图的频率数组：

```py
>>> w = np.linspace(0.01, 10, nout) 
```

计算Lomb-Scargle周期图：

```py
>>> import scipy.signal as signal
>>> pgram = signal.lombscargle(x, y, w, normalize=True) 
```

现在制作输入数据的图表：

```py
>>> fig, (ax_t, ax_w) = plt.subplots(2, 1, constrained_layout=True)
>>> ax_t.plot(x, y, 'b+')
>>> ax_t.set_xlabel('Time [s]') 
```

然后绘制归一化周期图：

```py
>>> ax_w.plot(w, pgram)
>>> ax_w.set_xlabel('Angular frequency [rad/s]')
>>> ax_w.set_ylabel('Normalized amplitude')
>>> plt.show() 
```

![../../_images/scipy-signal-lombscargle-1.png](../Images/535fbd2675d2ae4a30345df48e192dd6.png)
