- en: scipy.stats.epps_singleton_2samp
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.epps_singleton_2samp.html#scipy.stats.epps_singleton_2samp](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.epps_singleton_2samp.html#scipy.stats.epps_singleton_2samp)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Compute the Epps-Singleton (ES) test statistic.
  prefs: []
  type: TYPE_NORMAL
- en: Test the null hypothesis that two samples have the same underlying probability
    distribution.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**x, y**array-like'
  prefs: []
  type: TYPE_NORMAL
- en: The two samples of observations to be tested. Input must not have more than
    one dimension. Samples can have different lengths.
  prefs: []
  type: TYPE_NORMAL
- en: '**t**array-like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: The points (t1, …, tn) where the empirical characteristic function is to be
    evaluated. It should be positive distinct numbers. The default value (0.4, 0.8)
    is proposed in [[1]](#r8ab16cf236a2-1). Input must not have more than one dimension.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, default: 0'
  prefs: []
  type: TYPE_NORMAL
- en: If an int, the axis of the input along which to compute the statistic. The statistic
    of each axis-slice (e.g. row) of the input will appear in a corresponding element
    of the output. If `None`, the input will be raveled before computing the statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '**nan_policy**{‘propagate’, ‘omit’, ‘raise’}'
  prefs: []
  type: TYPE_NORMAL
- en: Defines how to handle input NaNs.
  prefs: []
  type: TYPE_NORMAL
- en: '`propagate`: if a NaN is present in the axis slice (e.g. row) along which the
    statistic is computed, the corresponding entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`omit`: NaNs will be omitted when performing the calculation. If insufficient
    data remains in the axis slice along which the statistic is computed, the corresponding
    entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`raise`: if a NaN is present, a `ValueError` will be raised.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**keepdims**bool, default: False'
  prefs: []
  type: TYPE_NORMAL
- en: If this is set to True, the axes which are reduced are left in the result as
    dimensions with size one. With this option, the result will broadcast correctly
    against the input array.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**statistic**float'
  prefs: []
  type: TYPE_NORMAL
- en: The test statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '**pvalue**float'
  prefs: []
  type: TYPE_NORMAL
- en: The associated p-value based on the asymptotic chi2-distribution.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`ks_2samp`](scipy.stats.ks_2samp.html#scipy.stats.ks_2samp "scipy.stats.ks_2samp"),
    [`anderson_ksamp`](scipy.stats.anderson_ksamp.html#scipy.stats.anderson_ksamp
    "scipy.stats.anderson_ksamp")'
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: Testing whether two samples are generated by the same underlying distribution
    is a classical question in statistics. A widely used test is the Kolmogorov-Smirnov
    (KS) test which relies on the empirical distribution function. Epps and Singleton
    introduce a test based on the empirical characteristic function in [[1]](#r8ab16cf236a2-1).
  prefs: []
  type: TYPE_NORMAL
- en: One advantage of the ES test compared to the KS test is that is does not assume
    a continuous distribution. In [[1]](#r8ab16cf236a2-1), the authors conclude that
    the test also has a higher power than the KS test in many examples. They recommend
    the use of the ES test for discrete samples as well as continuous samples with
    at least 25 observations each, whereas [`anderson_ksamp`](scipy.stats.anderson_ksamp.html#scipy.stats.anderson_ksamp
    "scipy.stats.anderson_ksamp") is recommended for smaller sample sizes in the continuous
    case.
  prefs: []
  type: TYPE_NORMAL
- en: The p-value is computed from the asymptotic distribution of the test statistic
    which follows a [`chi2`](scipy.stats.chi2.html#scipy.stats.chi2 "scipy.stats.chi2")
    distribution. If the sample size of both *x* and *y* is below 25, the small sample
    correction proposed in [[1]](#r8ab16cf236a2-1) is applied to the test statistic.
  prefs: []
  type: TYPE_NORMAL
- en: The default values of [`t`](scipy.stats.t.html#scipy.stats.t "scipy.stats.t")
    are determined in [[1]](#r8ab16cf236a2-1) by considering various distributions
    and finding good values that lead to a high power of the test in general. Table
    III in [[1]](#r8ab16cf236a2-1) gives the optimal values for the distributions
    tested in that study. The values of [`t`](scipy.stats.t.html#scipy.stats.t "scipy.stats.t")
    are scaled by the semi-interquartile range in the implementation, see [[1]](#r8ab16cf236a2-1).
  prefs: []
  type: TYPE_NORMAL
- en: Beginning in SciPy 1.9, `np.matrix` inputs (not recommended for new code) are
    converted to `np.ndarray` before the calculation is performed. In this case, the
    output will be a scalar or `np.ndarray` of appropriate shape rather than a 2D
    `np.matrix`. Similarly, while masked elements of masked arrays are ignored, the
    output will be a scalar or `np.ndarray` rather than a masked array with `mask=False`.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1] ([1](#id1),[2](#id2),[3](#id3),[4](#id4),[5](#id5),[6](#id6),[7](#id7))'
  prefs: []
  type: TYPE_NORMAL
- en: T. W. Epps and K. J. Singleton, “An omnibus test for the two-sample problem
    using the empirical characteristic function”, Journal of Statistical Computation
    and Simulation 26, p. 177–203, 1986.
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: S. J. Goerg and J. Kaiser, “Nonparametric testing of distributions - the Epps-Singleton
    two-sample test using the empirical characteristic function”, The Stata Journal
    9(3), p. 454–465, 2009.
  prefs: []
  type: TYPE_NORMAL
