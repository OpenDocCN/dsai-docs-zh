- en: scipy.stats.false_discovery_control
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.false_discovery_control.html#scipy.stats.false_discovery_control](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.false_discovery_control.html#scipy.stats.false_discovery_control)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Adjust p-values to control the false discovery rate.
  prefs: []
  type: TYPE_NORMAL
- en: The false discovery rate (FDR) is the expected proportion of rejected null hypotheses
    that are actually true. If the null hypothesis is rejected when the *adjusted*
    p-value falls below a specified level, the false discovery rate is controlled
    at that level.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**ps**1D array_like'
  prefs: []
  type: TYPE_NORMAL
- en: The p-values to adjust. Elements must be real numbers between 0 and 1.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int'
  prefs: []
  type: TYPE_NORMAL
- en: The axis along which to perform the adjustment. The adjustment is performed
    independently along each axis-slice. If *axis* is None, *ps* is raveled before
    performing the adjustment.
  prefs: []
  type: TYPE_NORMAL
- en: '**method**{‘bh’, ‘by’}'
  prefs: []
  type: TYPE_NORMAL
- en: 'The false discovery rate control procedure to apply: `''bh''` is for Benjamini-Hochberg
    [[1]](#r4c2dbc17006a-1) (Eq. 1), `''by''` is for Benjaminini-Yekutieli [[2]](#r4c2dbc17006a-2)
    (Theorem 1.3). The latter is more conservative, but it is guaranteed to control
    the FDR even when the p-values are not from independent tests.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**ps_adusted**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: The adjusted p-values. If the null hypothesis is rejected where these fall below
    a specified level, the false discovery rate is controlled at that level.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`combine_pvalues`](scipy.stats.combine_pvalues.html#scipy.stats.combine_pvalues
    "scipy.stats.combine_pvalues")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`statsmodels.stats.multitest.multipletests`](https://www.statsmodels.org/stable/generated/statsmodels.stats.multitest.multipletests.html#statsmodels.stats.multitest.multipletests
    "(in statsmodels 0.14.1 v0.14.1)")'
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: In multiple hypothesis testing, false discovery control procedures tend to offer
    higher power than familywise error rate control procedures (e.g. Bonferroni correction
    [[1]](#r4c2dbc17006a-1)).
  prefs: []
  type: TYPE_NORMAL
- en: If the p-values correspond with independent tests (or tests with “positive regression
    dependencies” [[2]](#r4c2dbc17006a-2)), rejecting null hypotheses corresponding
    with Benjamini-Hochberg-adjusted p-values below \(q\) controls the false discovery
    rate at a level less than or equal to \(q m_0 / m\), where \(m_0\) is the number
    of true null hypotheses and \(m\) is the total number of null hypotheses tested.
    The same is true even for dependent tests when the p-values are adjusted accorded
    to the more conservative Benjaminini-Yekutieli procedure.
  prefs: []
  type: TYPE_NORMAL
- en: The adjusted p-values produced by this function are comparable to those produced
    by the R function `p.adjust` and the statsmodels function *statsmodels.stats.multitest.multipletests*.
    Please consider the latter for more advanced methods of multiple comparison correction.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1] ([1](#id1),[2](#id3),[3](#id9),[4](#id11),[5](#id12))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Benjamini, Yoav, and Yosef Hochberg. “Controlling the false discovery rate:
    a practical and powerful approach to multiple testing.” Journal of the Royal statistical
    society: series B (Methodological) 57.1 (1995): 289-300.'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] ([1](#id2),[2](#id4))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Benjamini, Yoav, and Daniel Yekutieli. “The control of the false discovery
    rate in multiple testing under dependency.” Annals of statistics (2001): 1165-1188.'
  prefs: []
  type: TYPE_NORMAL
- en: '[3]'
  prefs: []
  type: TYPE_NORMAL
- en: TileStats. FDR - Benjamini-Hochberg explained - Youtube. [https://www.youtube.com/watch?v=rZKa4tW2NKs](https://www.youtube.com/watch?v=rZKa4tW2NKs).
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id10)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Neuhaus, Karl-Ludwig, et al. “Improved thrombolysis in acute myocardial infarction
    with front-loaded administration of alteplase: results of the rt-PA-APSAC patency
    study (TAPS).” Journal of the American College of Cardiology 19.5 (1992): 885-891.'
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: We follow the example from [[1]](#r4c2dbc17006a-1).
  prefs: []
  type: TYPE_NORMAL
- en: Thrombolysis with recombinant tissue-type plasminogen activator (rt-PA) and
    anisoylated plasminogen streptokinase activator (APSAC) in myocardial infarction
    has been proved to reduce mortality. [[4]](#r4c2dbc17006a-4) investigated the
    effects of a new front-loaded administration of rt-PA versus those obtained with
    a standard regimen of APSAC, in a randomized multicentre trial in 421 patients
    with acute myocardial infarction.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: There were four families of hypotheses tested in the study, the last of which
    was “cardiac and other events after the start of thrombolitic treatment”. FDR
    control may be desired in this family of hypotheses because it would not be appropriate
    to conclude that the front-loaded treatment is better if it is merely equivalent
    to the previous treatment.
  prefs: []
  type: TYPE_NORMAL
- en: The p-values corresponding with the 15 hypotheses in this family were
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'If the chosen significance level is 0.05, we may be tempted to reject the null
    hypotheses for the tests corresponding with the first nine p-values, as the first
    nine p-values fall below the chosen significance level. However, this would ignore
    the problem of “multiplicity”: if we fail to correct for the fact that multiple
    comparisons are being performed, we are more likely to incorrectly reject true
    null hypotheses.'
  prefs: []
  type: TYPE_NORMAL
- en: One approach to the multiplicity problem is to control the family-wise error
    rate (FWER), that is, the rate at which the null hypothesis is rejected when it
    is actually true. A common procedure of this kind is the Bonferroni correction
    [[1]](#r4c2dbc17006a-1). We begin by multiplying the p-values by the number of
    hypotheses tested.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: To control the FWER at 5%, we reject only the hypotheses corresponding with
    adjusted p-values less than 0.05\. In this case, only the hypotheses corresponding
    with the first three p-values can be rejected. According to [[1]](#r4c2dbc17006a-1),
    these three hypotheses concerned “allergic reaction” and “two different aspects
    of bleeding.”
  prefs: []
  type: TYPE_NORMAL
- en: 'An alternative approach is to control the false discovery rate: the expected
    fraction of rejected null hypotheses that are actually true. The advantage of
    this approach is that it typically affords greater power: an increased rate of
    rejecting the null hypothesis when it is indeed false. To control the false discovery
    rate at 5%, we apply the Benjamini-Hochberg p-value adjustment.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Now, the first *four* adjusted p-values fall below 0.05, so we would reject
    the null hypotheses corresponding with these *four* p-values. Rejection of the
    fourth null hypothesis was particularly important to the original study as it
    led to the conclusion that the new treatment had a “substantially lower in-hospital
    mortality rate.”
  prefs: []
  type: TYPE_NORMAL
