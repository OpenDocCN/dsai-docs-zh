- en: scipy.stats.spearmanr
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.spearmanr.html#scipy.stats.spearmanr](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.spearmanr.html#scipy.stats.spearmanr)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Calculate a Spearman correlation coefficient with associated p-value.
  prefs: []
  type: TYPE_NORMAL
- en: The Spearman rank-order correlation coefficient is a nonparametric measure of
    the monotonicity of the relationship between two datasets. Like other correlation
    coefficients, this one varies between -1 and +1 with 0 implying no correlation.
    Correlations of -1 or +1 imply an exact monotonic relationship. Positive correlations
    imply that as x increases, so does y. Negative correlations imply that as x increases,
    y decreases.
  prefs: []
  type: TYPE_NORMAL
- en: The p-value roughly indicates the probability of an uncorrelated system producing
    datasets that have a Spearman correlation at least as extreme as the one computed
    from these datasets. Although calculation of the p-value does not make strong
    assumptions about the distributions underlying the samples, it is only accurate
    for very large samples (>500 observations). For smaller sample sizes, consider
    a permutation test (see Examples section below).
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**a, b**1D or 2D array_like, b is optional'
  prefs: []
  type: TYPE_NORMAL
- en: One or two 1-D or 2-D arrays containing multiple variables and observations.
    When these are 1-D, each represents a vector of observations of a single variable.
    For the behavior in the 2-D case, see under `axis`, below. Both arrays need to
    have the same length in the `axis` dimension.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'If axis=0 (default), then each column represents a variable, with observations
    in the rows. If axis=1, the relationship is transposed: each row represents a
    variable, while the columns contain observations. If axis=None, then both arrays
    will be raveled.'
  prefs: []
  type: TYPE_NORMAL
- en: '**nan_policy**{‘propagate’, ‘raise’, ‘omit’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'Defines how to handle when input contains nan. The following options are available
    (default is ‘propagate’):'
  prefs: []
  type: TYPE_NORMAL
- en: '‘propagate’: returns nan'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘raise’: throws an error'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘omit’: performs the calculations ignoring nan values'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**alternative**{‘two-sided’, ‘less’, ‘greater’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'Defines the alternative hypothesis. Default is ‘two-sided’. The following options
    are available:'
  prefs: []
  type: TYPE_NORMAL
- en: '‘two-sided’: the correlation is nonzero'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘less’: the correlation is negative (less than zero)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘greater’: the correlation is positive (greater than zero)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: New in version 1.7.0.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**res**SignificanceResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat or ndarray (2-D square)
  prefs: []
  type: TYPE_NORMAL
- en: Spearman correlation matrix or correlation coefficient (if only 2 variables
    are given as parameters). Correlation matrix is square with length equal to total
    number of variables (columns or rows) in `a` and `b` combined.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat
  prefs: []
  type: TYPE_NORMAL
- en: The p-value for a hypothesis test whose null hypothesis is that two samples
    have no ordinal correlation. See *alternative* above for alternative hypotheses.
    *pvalue* has the same shape as *statistic*.
  prefs: []
  type: TYPE_NORMAL
- en: 'Warns:'
  prefs: []
  type: TYPE_NORMAL
- en: '[`ConstantInputWarning`](scipy.stats.ConstantInputWarning.html#scipy.stats.ConstantInputWarning
    "scipy.stats.ConstantInputWarning")'
  prefs: []
  type: TYPE_NORMAL
- en: Raised if an input is a constant array. The correlation coefficient is not defined
    in this case, so `np.nan` is returned.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Zwillinger, D. and Kokoska, S. (2000). CRC Standard Probability and Statistics
    Tables and Formulae. Chapman & Hall: New York. 2000. Section 14.7'
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Kendall, M. G. and Stuart, A. (1973). The Advanced Theory of Statistics, Volume
    2: Inference and Relationship. Griffin. 1973. Section 31.18'
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id7)]'
  prefs: []
  type: TYPE_NORMAL
- en: Kershenobich, D., Fierro, F. J., & Rojkind, M. (1970). The relationship between
    the free pool of proline and collagen content in human liver cirrhosis. The Journal
    of Clinical Investigation, 49(12), 2246-2249.
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id8)]'
  prefs: []
  type: TYPE_NORMAL
- en: Hollander, M., Wolfe, D. A., & Chicken, E. (2013). Nonparametric statistical
    methods. John Wiley & Sons.
  prefs: []
  type: TYPE_NORMAL
- en: '[[5](#id9)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'B. Phipson and G. K. Smyth. “Permutation P-values Should Never Be Zero: Calculating
    Exact P-values When Permutations Are Randomly Drawn.” Statistical Applications
    in Genetics and Molecular Biology 9.1 (2010).'
  prefs: []
  type: TYPE_NORMAL
- en: '[6]'
  prefs: []
  type: TYPE_NORMAL
- en: Ludbrook, J., & Dudley, H. (1998). Why permutation tests are superior to t and
    F tests in biomedical research. The American Statistician, 52(2), 127-132.
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: Consider the following data from [[3]](#r8c2e2fa62c2f-3), which studied the
    relationship between free proline (an amino acid) and total collagen (a protein
    often found in connective tissue) in unhealthy human livers.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `x` and `y` arrays below record measurements of the two compounds. The
    observations are paired: each free proline measurement was taken from the same
    liver as the total collagen measurement at the same index.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: These data were analyzed in [[4]](#r8c2e2fa62c2f-4) using Spearman’s correlation
    coefficient, a statistic sensitive to monotonic correlation between the samples.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The value of this statistic tends to be high (close to 1) for samples with a
    strongly positive ordinal correlation, low (close to -1) for samples with a strongly
    negative ordinal correlation, and small in magnitude (close to zero) for samples
    with weak ordinal correlation.
  prefs: []
  type: TYPE_NORMAL
- en: 'The test is performed by comparing the observed value of the statistic against
    the null distribution: the distribution of statistic values derived under the
    null hypothesis that total collagen and free proline measurements are independent.'
  prefs: []
  type: TYPE_NORMAL
- en: For this test, the statistic can be transformed such that the null distribution
    for large samples is Student’s t distribution with `len(x) - 2` degrees of freedom.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-spearmanr-1_00_00.png](../Images/9fafbbcabed7349a1e5151176c44b6b2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The comparison is quantified by the p-value: the proportion of values in the
    null distribution as extreme or more extreme than the observed value of the statistic.
    In a two-sided test in which the statistic is positive, elements of the null distribution
    greater than the transformed statistic and elements of the null distribution less
    than the negative of the observed statistic are both considered “more extreme”.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-spearmanr-1_01_00.png](../Images/9b3b3f6bd6ac8f80bc6a9a4d9685c0c8.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'If the p-value is “small” - that is, if there is a low probability of sampling
    data from independent distributions that produces such an extreme value of the
    statistic - this may be taken as evidence against the null hypothesis in favor
    of the alternative: the distribution of total collagen and free proline are *not*
    independent. Note that:'
  prefs: []
  type: TYPE_NORMAL
- en: The inverse is not true; that is, the test is not used to provide evidence for
    the null hypothesis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The threshold for values that will be considered “small” is a choice that should
    be made before the data is analyzed [[5]](#r8c2e2fa62c2f-5) with consideration
    of the risks of both false positives (incorrectly rejecting the null hypothesis)
    and false negatives (failure to reject a false null hypothesis).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Small p-values are not evidence for a *large* effect; rather, they can only
    provide evidence for a “significant” effect, meaning that they are unlikely to
    have occurred under the null hypothesis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Suppose that before performing the experiment, the authors had reason to predict
    a positive correlation between the total collagen and free proline measurements,
    and that they had chosen to assess the plausibility of the null hypothesis against
    a one-sided alternative: free proline has a positive ordinal correlation with
    total collagen. In this case, only those values in the null distribution that
    are as great or greater than the observed statistic are considered to be more
    extreme.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-spearmanr-1_02_00.png](../Images/0c637a854f778d5843b5653fbbfdeb98.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Note that the t-distribution provides an asymptotic approximation of the null
    distribution; it is only accurate for samples with many observations. For small
    samples, it may be more appropriate to perform a permutation test: Under the null
    hypothesis that total collagen and free proline are independent, each of the free
    proline measurements were equally likely to have been observed with any of the
    total collagen measurements. Therefore, we can form an *exact* null distribution
    by calculating the statistic under each possible pairing of elements between `x`
    and `y`.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-spearmanr-1_03_00.png](../Images/8bb1aaa774421fdf351a691a86f8f67c.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
