- en: scipy.stats.energy_distance
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.energy_distance.html#scipy.stats.energy_distance](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.energy_distance.html#scipy.stats.energy_distance)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Compute the energy distance between two 1D distributions.
  prefs: []
  type: TYPE_NORMAL
- en: New in version 1.0.0.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**u_values, v_values**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: Values observed in the (empirical) distribution.
  prefs: []
  type: TYPE_NORMAL
- en: '**u_weights, v_weights**array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Weight for each value. If unspecified, each value is assigned the same weight.
    *u_weights* (resp. *v_weights*) must have the same length as *u_values* (resp.
    *v_values*). If the weight sum differs from 1, it must still be positive and finite
    so that the weights can be normalized to sum to 1.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**distance**float'
  prefs: []
  type: TYPE_NORMAL
- en: The computed distance between the distributions.
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: 'The energy distance between two distributions \(u\) and \(v\), whose respective
    CDFs are \(U\) and \(V\), equals to:'
  prefs: []
  type: TYPE_NORMAL
- en: \[D(u, v) = \left( 2\mathbb E|X - Y| - \mathbb E|X - X'| - \mathbb E|Y - Y'|
    \right)^{1/2}\]
  prefs: []
  type: TYPE_NORMAL
- en: where \(X\) and \(X'\) (resp. \(Y\) and \(Y'\)) are independent random variables
    whose probability distribution is \(u\) (resp. \(v\)).
  prefs: []
  type: TYPE_NORMAL
- en: Sometimes the square of this quantity is referred to as the “energy distance”
    (e.g. in [[2]](#r9c3c89b1919f-2), [[4]](#r9c3c89b1919f-4)), but as noted in [[1]](#r9c3c89b1919f-1)
    and [[3]](#r9c3c89b1919f-3), only the definition above satisfies the axioms of
    a distance function (metric).
  prefs: []
  type: TYPE_NORMAL
- en: 'As shown in [[2]](#r9c3c89b1919f-2), for one-dimensional real-valued variables,
    the energy distance is linked to the non-distribution-free version of the Cramér-von
    Mises distance:'
  prefs: []
  type: TYPE_NORMAL
- en: \[D(u, v) = \sqrt{2} l_2(u, v) = \left( 2 \int_{-\infty}^{+\infty} (U-V)^2 \right)^{1/2}\]
  prefs: []
  type: TYPE_NORMAL
- en: Note that the common Cramér-von Mises criterion uses the distribution-free version
    of the distance. See [[2]](#r9c3c89b1919f-2) (section 2), for more details about
    both versions of the distance.
  prefs: []
  type: TYPE_NORMAL
- en: The input distributions can be empirical, therefore coming from samples whose
    values are effectively inputs of the function, or they can be seen as generalized
    functions, in which case they are weighted sums of Dirac delta functions located
    at the specified values.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[[1](#id3)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Rizzo, Szekely “Energy distance.” Wiley Interdisciplinary Reviews: Computational
    Statistics, 8(1):27-38 (2015).'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] ([1](#id1),[2](#id5),[3](#id6))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Szekely “E-statistics: The energy of statistical samples.” Bowling Green State
    University, Department of Mathematics and Statistics, Technical Report 02-16 (2002).'
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id4)]'
  prefs: []
  type: TYPE_NORMAL
- en: “Energy distance”, [https://en.wikipedia.org/wiki/Energy_distance](https://en.wikipedia.org/wiki/Energy_distance)
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id2)]'
  prefs: []
  type: TYPE_NORMAL
- en: Bellemare, Danihelka, Dabney, Mohamed, Lakshminarayanan, Hoyer, Munos “The Cramer
    Distance as a Solution to Biased Wasserstein Gradients” (2017). [arXiv:1705.10743](https://arxiv.org/abs/1705.10743).
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
