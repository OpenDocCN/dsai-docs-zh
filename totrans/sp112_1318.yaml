- en: scipy.stats.fisher_exact
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.fisher_exact.html#scipy.stats.fisher_exact](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.fisher_exact.html#scipy.stats.fisher_exact)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Perform a Fisher exact test on a 2x2 contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: 'The null hypothesis is that the true odds ratio of the populations underlying
    the observations is one, and the observations were sampled from these populations
    under a condition: the marginals of the resulting table must equal those of the
    observed table. The statistic returned is the unconditional maximum likelihood
    estimate of the odds ratio, and the p-value is the probability under the null
    hypothesis of obtaining a table at least as extreme as the one that was actually
    observed. There are other possible choices of statistic and two-sided p-value
    definition associated with Fisher’s exact test; please see the Notes for more
    information.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**table**array_like of ints'
  prefs: []
  type: TYPE_NORMAL
- en: A 2x2 contingency table. Elements must be non-negative integers.
  prefs: []
  type: TYPE_NORMAL
- en: '**alternative**{‘two-sided’, ‘less’, ‘greater’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'Defines the alternative hypothesis. The following options are available (default
    is ‘two-sided’):'
  prefs: []
  type: TYPE_NORMAL
- en: '‘two-sided’: the odds ratio of the underlying population is not one'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘less’: the odds ratio of the underlying population is less than one'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘greater’: the odds ratio of the underlying population is greater than one'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: See the Notes for more details.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**res**SignificanceResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat
  prefs: []
  type: TYPE_NORMAL
- en: This is the prior odds ratio, not a posterior estimate.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat
  prefs: []
  type: TYPE_NORMAL
- en: The probability under the null hypothesis of obtaining a table at least as extreme
    as the one that was actually observed.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`chi2_contingency`](scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency
    "scipy.stats.chi2_contingency")'
  prefs: []
  type: TYPE_NORMAL
- en: Chi-square test of independence of variables in a contingency table. This can
    be used as an alternative to [`fisher_exact`](#scipy.stats.fisher_exact "scipy.stats.fisher_exact")
    when the numbers in the table are large.
  prefs: []
  type: TYPE_NORMAL
- en: '[`contingency.odds_ratio`](scipy.stats.contingency.odds_ratio.html#scipy.stats.contingency.odds_ratio
    "scipy.stats.contingency.odds_ratio")'
  prefs: []
  type: TYPE_NORMAL
- en: Compute the odds ratio (sample or conditional MLE) for a 2x2 contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: '[`barnard_exact`](scipy.stats.barnard_exact.html#scipy.stats.barnard_exact
    "scipy.stats.barnard_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Barnard’s exact test, which is a more powerful alternative than Fisher’s exact
    test for 2x2 contingency tables.
  prefs: []
  type: TYPE_NORMAL
- en: '[`boschloo_exact`](scipy.stats.boschloo_exact.html#scipy.stats.boschloo_exact
    "scipy.stats.boschloo_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Boschloo’s exact test, which is a more powerful alternative than Fisher’s exact
    test for 2x2 contingency tables.
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: '*Null hypothesis and p-values*'
  prefs: []
  type: TYPE_NORMAL
- en: 'The null hypothesis is that the true odds ratio of the populations underlying
    the observations is one, and the observations were sampled at random from these
    populations under a condition: the marginals of the resulting table must equal
    those of the observed table. Equivalently, the null hypothesis is that the input
    table is from the hypergeometric distribution with parameters (as used in [`hypergeom`](scipy.stats.hypergeom.html#scipy.stats.hypergeom
    "scipy.stats.hypergeom")) `M = a + b + c + d`, `n = a + b` and `N = a + c`, where
    the input table is `[[a, b], [c, d]]`. This distribution has support `max(0, N
    + n - M) <= x <= min(N, n)`, or, in terms of the values in the input table, `min(0,
    a - d) <= x <= a + min(b, c)`. `x` can be interpreted as the upper-left element
    of a 2x2 table, so the tables in the distribution have form:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'For example, if:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'then the support is `2 <= x <= 7`, and the tables in the distribution are:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The probability of each table is given by the hypergeometric distribution `hypergeom.pmf(x,
    M, n, N)`. For this example, these are (rounded to three significant digits):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'These can be computed with:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The two-sided p-value is the probability that, under the null hypothesis, a
    random table would have a probability equal to or less than the probability of
    the input table. For our example, the probability of the input table (where `x
    = 6`) is 0.0816\. The x values where the probability does not exceed this are
    2, 6 and 7, so the two-sided p-value is `0.0163 + 0.0816 + 0.00466 ~= 0.10256`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'The one-sided p-value for `alternative=''greater''` is the probability that
    a random table has `x >= a`, which in our example is `x >= 6`, or `0.0816 + 0.00466
    ~= 0.08626`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'This is equivalent to computing the survival function of the distribution at
    `x = 5` (one less than `x` from the input table, because we want to include the
    probability of `x = 6` in the sum):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'For `alternative=''less''`, the one-sided p-value is the probability that a
    random table has `x <= a`, (i.e. `x <= 6` in our example), or `0.0163 + 0.163
    + 0.408 + 0.326 + 0.0816 ~= 0.9949`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'This is equivalent to computing the cumulative distribution function of the
    distribution at `x = 6`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '*Odds ratio*'
  prefs: []
  type: TYPE_NORMAL
- en: The calculated odds ratio is different from the value computed by the R function
    `fisher.test`. This implementation returns the “sample” or “unconditional” maximum
    likelihood estimate, while `fisher.test` in R uses the conditional maximum likelihood
    estimate. To compute the conditional maximum likelihood estimate of the odds ratio,
    use [`scipy.stats.contingency.odds_ratio`](scipy.stats.contingency.odds_ratio.html#scipy.stats.contingency.odds_ratio
    "scipy.stats.contingency.odds_ratio").
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Fisher, Sir Ronald A, “The Design of Experiments: Mathematics of a Lady Tasting
    Tea.” ISBN 978-0-486-41151-4, 1935.'
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: “Fisher’s exact test”, [https://en.wikipedia.org/wiki/Fisher’s_exact_test](https://en.wikipedia.org/wiki/Fisher's_exact_test)
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id4)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Emma V. Low et al. “Identifying the lowest effective dose of acetazolamide
    for the prophylaxis of acute mountain sickness: systematic review and meta-analysis.”
    BMJ, 345, [DOI:10.1136/bmj.e6779](https://doi.org/10.1136/bmj.e6779), 2012.'
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: 'In [[3]](#r42ece5e08037-3), the effective dose of acetazolamide for the prophylaxis
    of acute mountain sickness was investigated. The study notably concluded:'
  prefs: []
  type: TYPE_NORMAL
- en: Acetazolamide 250 mg, 500 mg, and 750 mg daily were all efficacious for preventing
    acute mountain sickness. Acetazolamide 250 mg was the lowest effective dose with
    available evidence for this indication.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: 'The following table summarizes the results of the experiment in which some
    participants took a daily dose of acetazolamide 250 mg while others took a placebo.
    Cases of acute mountain sickness were recorded:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'Is there evidence that the acetazolamide 250 mg reduces the risk of acute mountain
    sickness? We begin by formulating a null hypothesis \(H_0\):'
  prefs: []
  type: TYPE_NORMAL
- en: The odds of experiencing acute mountain sickness are the same with the acetazolamide
    treatment as they are with placebo.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Let’s assess the plausibility of this hypothesis with Fisher’s test.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Using a significance level of 5%, we would reject the null hypothesis in favor
    of the alternative hypothesis: “The odds of experiencing acute mountain sickness
    with acetazolamide treatment are less than the odds of experiencing acute mountain
    sickness with placebo.”'
  prefs: []
  type: TYPE_NORMAL
- en: Note
  prefs: []
  type: TYPE_NORMAL
- en: Because the null distribution of Fisher’s exact test is formed under the assumption
    that both row and column sums are fixed, the result of the test are conservative
    when applied to an experiment in which the row sums are not fixed.
  prefs: []
  type: TYPE_NORMAL
- en: In this case, the column sums are fixed; there are 22 subjects in each group.
    But the number of cases of acute mountain sickness is not (and cannot be) fixed
    before conducting the experiment. It is a consequence.
  prefs: []
  type: TYPE_NORMAL
- en: Boschloo’s test does not depend on the assumption that the row sums are fixed,
    and consequently, it provides a more powerful test in this situation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: We verify that the p-value is less than with [`fisher_exact`](#scipy.stats.fisher_exact
    "scipy.stats.fisher_exact").
  prefs: []
  type: TYPE_NORMAL
