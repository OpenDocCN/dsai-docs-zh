- en: scipy.stats.chi2_contingency
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Chi-square test of independence of variables in a contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: 'This function computes the chi-square statistic and p-value for the hypothesis
    test of independence of the observed frequencies in the contingency table [[1]](#rf346382074c5-1)
    *observed*. The expected frequencies are computed based on the marginal sums under
    the assumption of independence; see [`scipy.stats.contingency.expected_freq`](scipy.stats.contingency.expected_freq.html#scipy.stats.contingency.expected_freq
    "scipy.stats.contingency.expected_freq"). The number of degrees of freedom is
    (expressed using numpy functions and attributes):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**observed**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: The contingency table. The table contains the observed frequencies (i.e. number
    of occurrences) in each category. In the two-dimensional case, the table is often
    described as an “R x C table”.
  prefs: []
  type: TYPE_NORMAL
- en: '**correction**bool, optional'
  prefs: []
  type: TYPE_NORMAL
- en: If True, *and* the degrees of freedom is 1, apply Yates’ correction for continuity.
    The effect of the correction is to adjust each observed value by 0.5 towards the
    corresponding expected value.
  prefs: []
  type: TYPE_NORMAL
- en: '**lambda_**float or str, optional'
  prefs: []
  type: TYPE_NORMAL
- en: By default, the statistic computed in this test is Pearson’s chi-squared statistic
    [[2]](#rf346382074c5-2). *lambda_* allows a statistic from the Cressie-Read power
    divergence family [[3]](#rf346382074c5-3) to be used instead. See [`scipy.stats.power_divergence`](scipy.stats.power_divergence.html#scipy.stats.power_divergence
    "scipy.stats.power_divergence") for details.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**res**Chi2ContingencyResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat
  prefs: []
  type: TYPE_NORMAL
- en: The test statistic.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat
  prefs: []
  type: TYPE_NORMAL
- en: The p-value of the test.
  prefs: []
  type: TYPE_NORMAL
- en: dofint
  prefs: []
  type: TYPE_NORMAL
- en: The degrees of freedom.
  prefs: []
  type: TYPE_NORMAL
- en: expected_freqndarray, same shape as *observed*
  prefs: []
  type: TYPE_NORMAL
- en: The expected frequencies, based on the marginal sums of the table.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.contingency.expected_freq`](scipy.stats.contingency.expected_freq.html#scipy.stats.contingency.expected_freq
    "scipy.stats.contingency.expected_freq")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.fisher_exact`](scipy.stats.fisher_exact.html#scipy.stats.fisher_exact
    "scipy.stats.fisher_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare
    "scipy.stats.chisquare")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.power_divergence`](scipy.stats.power_divergence.html#scipy.stats.power_divergence
    "scipy.stats.power_divergence")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.barnard_exact`](scipy.stats.barnard_exact.html#scipy.stats.barnard_exact
    "scipy.stats.barnard_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.boschloo_exact`](scipy.stats.boschloo_exact.html#scipy.stats.boschloo_exact
    "scipy.stats.boschloo_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: An often quoted guideline for the validity of this calculation is that the test
    should be used only if the observed and expected frequencies in each cell are
    at least 5.
  prefs: []
  type: TYPE_NORMAL
- en: This is a test for the independence of different categories of a population.
    The test is only meaningful when the dimension of *observed* is two or more. Applying
    the test to a one-dimensional table will always result in *expected* equal to
    *observed* and a chi-square statistic equal to 0.
  prefs: []
  type: TYPE_NORMAL
- en: This function does not handle masked arrays, because the calculation does not
    make sense with missing values.
  prefs: []
  type: TYPE_NORMAL
- en: 'Like [`scipy.stats.chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare
    "scipy.stats.chisquare"), this function computes a chi-square statistic; the convenience
    this function provides is to figure out the expected frequencies and degrees of
    freedom from the given contingency table. If these were already known, and if
    the Yates’ correction was not required, one could use [`scipy.stats.chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare
    "scipy.stats.chisquare"). That is, if one calls:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'then the following is true:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The *lambda_* argument was added in version 0.13.0 of scipy.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[[1](#id1)]'
  prefs: []
  type: TYPE_NORMAL
- en: “Contingency table”, [https://en.wikipedia.org/wiki/Contingency_table](https://en.wikipedia.org/wiki/Contingency_table)
  prefs: []
  type: TYPE_NORMAL
- en: '[[2](#id2)]'
  prefs: []
  type: TYPE_NORMAL
- en: “Pearson’s chi-squared test”, [https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test](https://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test)
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id3)]'
  prefs: []
  type: TYPE_NORMAL
- en: Cressie, N. and Read, T. R. C., “Multinomial Goodness-of-Fit Tests”, J. Royal
    Stat. Soc. Series B, Vol. 46, No. 3 (1984), pp. 440-464.
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id8)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Berger, Jeffrey S. et al. “Aspirin for the Primary Prevention of Cardiovascular
    Events in Women and Men: A Sex-Specific Meta-analysis of Randomized Controlled
    Trials.” JAMA, 295(3):306-313, [DOI:10.1001/jama.295.3.306](https://doi.org/10.1001/jama.295.3.306),
    2006.'
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: 'In [[4]](#rf346382074c5-4), the use of aspirin to prevent cardiovascular events
    in women and men was investigated. The study notably concluded:'
  prefs: []
  type: TYPE_NORMAL
- en: …aspirin therapy reduced the risk of a composite of cardiovascular events due
    to its effect on reducing the risk of ischemic stroke in women […]
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The article lists studies of various cardiovascular events. Let’s focus on the
    ischemic stoke in women.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following table summarizes the results of the experiment in which participants
    took aspirin or a placebo on a regular basis for several years. Cases of ischemic
    stroke were recorded:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Is there evidence that the aspirin reduces the risk of ischemic stroke? We
    begin by formulating a null hypothesis \(H_0\):'
  prefs: []
  type: TYPE_NORMAL
- en: The effect of aspirin is equivalent to that of placebo.
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Let’s assess the plausibility of this hypothesis with a chi-square test.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Using a significance level of 5%, we would reject the null hypothesis in favor
    of the alternative hypothesis: “the effect of aspirin is not equivalent to the
    effect of placebo”. Because [`scipy.stats.contingency.chi2_contingency`](scipy.stats.contingency.chi2_contingency.html#scipy.stats.contingency.chi2_contingency
    "scipy.stats.contingency.chi2_contingency") performs a two-sided test, the alternative
    hypothesis does not indicate the direction of the effect. We can use *stats.contingency.odds_ratio*
    to support the conclusion that aspirin *reduces* the risk of ischemic stroke.'
  prefs: []
  type: TYPE_NORMAL
- en: Below are further examples showing how larger contingency tables can be tested.
  prefs: []
  type: TYPE_NORMAL
- en: 'A two-way example (2 x 3):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Perform the test using the log-likelihood ratio (i.e. the “G-test”) instead
    of Pearson’s chi-squared statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'A four-way example (2 x 2 x 2 x 2):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
