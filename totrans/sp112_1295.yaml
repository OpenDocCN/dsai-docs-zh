- en: scipy.stats.normaltest
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.normaltest.html#scipy.stats.normaltest](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.normaltest.html#scipy.stats.normaltest)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Test whether a sample differs from a normal distribution.
  prefs: []
  type: TYPE_NORMAL
- en: This function tests the null hypothesis that a sample comes from a normal distribution.
    It is based on D’Agostino and Pearson’s [[1]](#r7bf2e556f491-1), [[2]](#r7bf2e556f491-2)
    test that combines skew and kurtosis to produce an omnibus test of normality.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**a**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: The array containing the sample to be tested.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Axis along which to compute test. Default is 0\. If None, compute over the whole
    array *a*.
  prefs: []
  type: TYPE_NORMAL
- en: '**nan_policy**{‘propagate’, ‘raise’, ‘omit’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'Defines how to handle when input contains nan. The following options are available
    (default is ‘propagate’):'
  prefs: []
  type: TYPE_NORMAL
- en: '‘propagate’: returns nan'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '‘raise’: throws an error'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '‘omit’: performs the calculations ignoring nan values'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**statistic**float or array'
  prefs: []
  type: TYPE_NORMAL
- en: '`s^2 + k^2`, where `s` is the z-score returned by [`skewtest`](scipy.stats.skewtest.html#scipy.stats.skewtest
    "scipy.stats.skewtest") and `k` is the z-score returned by [`kurtosistest`](scipy.stats.kurtosistest.html#scipy.stats.kurtosistest
    "scipy.stats.kurtosistest").'
  prefs: []
  type: TYPE_NORMAL
- en: '**pvalue**float or array'
  prefs: []
  type: TYPE_NORMAL
- en: A 2-sided chi squared probability for the hypothesis test.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1] ([1](#id1),[2](#id9))'
  prefs: []
  type: TYPE_NORMAL
- en: D’Agostino, R. B. (1971), “An omnibus test of normality for moderate and large
    sample size”, Biometrika, 58, 341-348
  prefs: []
  type: TYPE_NORMAL
- en: '[2] ([1](#id2),[2](#id10))'
  prefs: []
  type: TYPE_NORMAL
- en: D’Agostino, R. and Pearson, E. S. (1973), “Tests for departure from normality”,
    Biometrika, 60, 613-622
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id8)]'
  prefs: []
  type: TYPE_NORMAL
- en: Shapiro, S. S., & Wilk, M. B. (1965). An analysis of variance test for normality
    (complete samples). Biometrika, 52(3/4), 591-611.
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id11)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'B. Phipson and G. K. Smyth. “Permutation P-values Should Never Be Zero: Calculating
    Exact P-values When Permutations Are Randomly Drawn.” Statistical Applications
    in Genetics and Molecular Biology 9.1 (2010).'
  prefs: []
  type: TYPE_NORMAL
- en: '[[5](#id12)]'
  prefs: []
  type: TYPE_NORMAL
- en: Panagiotakos, D. B. (2008). The value of p-value in biomedical research. The
    open cardiovascular medicine journal, 2, 97.
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: Suppose we wish to infer from measurements whether the weights of adult human
    males in a medical study are not normally distributed [[3]](#r7bf2e556f491-3).
    The weights (lbs) are recorded in the array `x` below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The normality test of [[1]](#r7bf2e556f491-1) and [[2]](#r7bf2e556f491-2) begins
    by computing a statistic based on the sample skewness and kurtosis.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: (The test warns that our sample has too few observations to perform the test.
    We’ll return to this at the end of the example.) Because the normal distribution
    has zero skewness and zero (“excess” or “Fisher”) kurtosis, the value of this
    statistic tends to be low for samples drawn from a normal distribution.
  prefs: []
  type: TYPE_NORMAL
- en: 'The test is performed by comparing the observed value of the statistic against
    the null distribution: the distribution of statistic values derived under the
    null hypothesis that the weights were drawn from a normal distribution. For this
    normality test, the null distribution for very large samples is the chi-squared
    distribution with two degrees of freedom.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-normaltest-1_00_00.png](../Images/96933cd532c2ed3ab1417b0f04f86c65.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The comparison is quantified by the p-value: the proportion of values in the
    null distribution greater than or equal to the observed value of the statistic.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-normaltest-1_01_00.png](../Images/fe8470578d8bc76440db3356e7e40937.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'If the p-value is “small” - that is, if there is a low probability of sampling
    data from a normally distributed population that produces such an extreme value
    of the statistic - this may be taken as evidence against the null hypothesis in
    favor of the alternative: the weights were not drawn from a normal distribution.
    Note that:'
  prefs: []
  type: TYPE_NORMAL
- en: The inverse is not true; that is, the test is not used to provide evidence for
    the null hypothesis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The threshold for values that will be considered “small” is a choice that should
    be made before the data is analyzed [[4]](#r7bf2e556f491-4) with consideration
    of the risks of both false positives (incorrectly rejecting the null hypothesis)
    and false negatives (failure to reject a false null hypothesis).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note that the chi-squared distribution provides an asymptotic approximation
    of the null distribution; it is only accurate for samples with many observations.
    This is the reason we received a warning at the beginning of the example; our
    sample is quite small. In this case, [`scipy.stats.monte_carlo_test`](scipy.stats.monte_carlo_test.html#scipy.stats.monte_carlo_test
    "scipy.stats.monte_carlo_test") may provide a more accurate, albeit stochastic,
    approximation of the exact p-value.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-normaltest-1_02_00.png](../Images/759bbd688aca52e99a5544a0d3a7e909.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Furthermore, despite their stochastic nature, p-values computed in this way
    can be used to exactly control the rate of false rejections of the null hypothesis
    [[5]](#r7bf2e556f491-5).
  prefs: []
  type: TYPE_NORMAL
