- en: scipy.stats.power_divergence
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.power_divergence.html#scipy.stats.power_divergence](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.power_divergence.html#scipy.stats.power_divergence)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Cressie-Read power divergence statistic and goodness of fit test.
  prefs: []
  type: TYPE_NORMAL
- en: This function tests the null hypothesis that the categorical data has the given
    frequencies, using the Cressie-Read power divergence statistic.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**f_obs**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: Observed frequencies in each category.
  prefs: []
  type: TYPE_NORMAL
- en: '**f_exp**array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Expected frequencies in each category. By default the categories are assumed
    to be equally likely.
  prefs: []
  type: TYPE_NORMAL
- en: '**ddof**int, optional'
  prefs: []
  type: TYPE_NORMAL
- en: '“Delta degrees of freedom”: adjustment to the degrees of freedom for the p-value.
    The p-value is computed using a chi-squared distribution with `k - 1 - ddof` degrees
    of freedom, where *k* is the number of observed frequencies. The default value
    of *ddof* is 0.'
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, optional'
  prefs: []
  type: TYPE_NORMAL
- en: The axis of the broadcast result of *f_obs* and *f_exp* along which to apply
    the test. If axis is None, all values in *f_obs* are treated as a single data
    set. Default is 0.
  prefs: []
  type: TYPE_NORMAL
- en: '**lambda_**float or str, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'The power in the Cressie-Read power divergence statistic. The default is 1\.
    For convenience, *lambda_* may be assigned one of the following strings, in which
    case the corresponding numerical value is used:'
  prefs: []
  type: TYPE_NORMAL
- en: '`"pearson"` (value 1)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pearson’s chi-squared statistic. In this case, the function is equivalent to
    [`chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare "scipy.stats.chisquare").
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`"log-likelihood"` (value 0)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Log-likelihood ratio. Also known as the G-test [[3]](#rf6c2a1ea428c-3).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`"freeman-tukey"` (value -1/2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Freeman-Tukey statistic.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`"mod-log-likelihood"` (value -1)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modified log-likelihood ratio.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`"neyman"` (value -2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Neyman’s statistic.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '`"cressie-read"` (value 2/3)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The power recommended in [[5]](#rf6c2a1ea428c-5).
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: 'res: Power_divergenceResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat or ndarray
  prefs: []
  type: TYPE_NORMAL
- en: The Cressie-Read power divergence test statistic. The value is a float if *axis*
    is None or if` *f_obs* and *f_exp* are 1-D.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat or ndarray
  prefs: []
  type: TYPE_NORMAL
- en: The p-value of the test. The value is a float if *ddof* and the return value
    [`stat`](https://docs.python.org/3/library/stat.html#module-stat "(in Python v3.12)")
    are scalars.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare "scipy.stats.chisquare")'
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: This test is invalid when the observed or expected frequencies in each category
    are too small. A typical rule is that all of the observed and expected frequencies
    should be at least 5.
  prefs: []
  type: TYPE_NORMAL
- en: Also, the sum of the observed and expected frequencies must be the same for
    the test to be valid; [`power_divergence`](#scipy.stats.power_divergence "scipy.stats.power_divergence")
    raises an error if the sums do not agree within a relative tolerance of `1e-8`.
  prefs: []
  type: TYPE_NORMAL
- en: When *lambda_* is less than zero, the formula for the statistic involves dividing
    by *f_obs*, so a warning or error may be generated if any value in *f_obs* is
    0.
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, a warning or error may be generated if any value in *f_exp* is zero
    when *lambda_* >= 0.
  prefs: []
  type: TYPE_NORMAL
- en: The default degrees of freedom, k-1, are for the case when no parameters of
    the distribution are estimated. If p parameters are estimated by efficient maximum
    likelihood then the correct degrees of freedom are k-1-p. If the parameters are
    estimated in a different way, then the dof can be between k-1-p and k-1\. However,
    it is also possible that the asymptotic distribution is not a chisquare, in which
    case this test is not appropriate.
  prefs: []
  type: TYPE_NORMAL
- en: This function handles masked arrays. If an element of *f_obs* or *f_exp* is
    masked, then data at that position is ignored, and does not count towards the
    size of the data set.
  prefs: []
  type: TYPE_NORMAL
- en: New in version 0.13.0.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: Lowry, Richard. “Concepts and Applications of Inferential Statistics”. Chapter
    8. [https://web.archive.org/web/20171015035606/http://faculty.vassar.edu/lowry/ch8pt1.html](https://web.archive.org/web/20171015035606/http://faculty.vassar.edu/lowry/ch8pt1.html)
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: “Chi-squared test”, [https://en.wikipedia.org/wiki/Chi-squared_test](https://en.wikipedia.org/wiki/Chi-squared_test)
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id1)]'
  prefs: []
  type: TYPE_NORMAL
- en: “G-test”, [https://en.wikipedia.org/wiki/G-test](https://en.wikipedia.org/wiki/G-test)
  prefs: []
  type: TYPE_NORMAL
- en: '[4]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Sokal, R. R. and Rohlf, F. J. “Biometry: the principles and practice of statistics
    in biological research”, New York: Freeman (1981)'
  prefs: []
  type: TYPE_NORMAL
- en: '[[5](#id2)]'
  prefs: []
  type: TYPE_NORMAL
- en: Cressie, N. and Read, T. R. C., “Multinomial Goodness-of-Fit Tests”, J. Royal
    Stat. Soc. Series B, Vol. 46, No. 3 (1984), pp. 440-464.
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: (See [`chisquare`](scipy.stats.chisquare.html#scipy.stats.chisquare "scipy.stats.chisquare")
    for more examples.)
  prefs: []
  type: TYPE_NORMAL
- en: 'When just *f_obs* is given, it is assumed that the expected frequencies are
    uniform and given by the mean of the observed frequencies. Here we perform a G-test
    (i.e. use the log-likelihood ratio statistic):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The expected frequencies can be given with the *f_exp* argument:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: When *f_obs* is 2-D, by default the test is applied to each column.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: By setting `axis=None`, the test is applied to all data in the array, which
    is equivalent to applying the test to the flattened array.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '*ddof* is the change to make to the default degrees of freedom.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The calculation of the p-values is done by broadcasting the test statistic with
    *ddof*.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '*f_obs* and *f_exp* are also broadcast. In the following, *f_obs* has shape
    (6,) and *f_exp* has shape (2, 6), so the result of broadcasting *f_obs* and *f_exp*
    has shape (2, 6). To compute the desired chi-squared statistics, we must use `axis=1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
