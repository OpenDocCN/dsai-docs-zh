- en: scipy.stats.barnard_exact
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.barnard_exact.html#scipy.stats.barnard_exact](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.barnard_exact.html#scipy.stats.barnard_exact)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Perform a Barnard exact test on a 2x2 contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**table**array_like of ints'
  prefs: []
  type: TYPE_NORMAL
- en: A 2x2 contingency table. Elements should be non-negative integers.
  prefs: []
  type: TYPE_NORMAL
- en: '**alternative**{‘two-sided’, ‘less’, ‘greater’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Defines the null and alternative hypotheses. Default is ‘two-sided’. Please
    see explanations in the Notes section below.
  prefs: []
  type: TYPE_NORMAL
- en: '**pooled**bool, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Whether to compute score statistic with pooled variance (as in Student’s t-test,
    for example) or unpooled variance (as in Welch’s t-test). Default is `True`.
  prefs: []
  type: TYPE_NORMAL
- en: '**n**int, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Number of sampling points used in the construction of the sampling method. Note
    that this argument will automatically be converted to the next higher power of
    2 since [`scipy.stats.qmc.Sobol`](scipy.stats.qmc.Sobol.html#scipy.stats.qmc.Sobol
    "scipy.stats.qmc.Sobol") is used to select sample points. Default is 32\. Must
    be positive. In most cases, 32 points is enough to reach good precision. More
    points comes at performance cost.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**ber**BarnardExactResult'
  prefs: []
  type: TYPE_NORMAL
- en: A result object with the following attributes.
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat
  prefs: []
  type: TYPE_NORMAL
- en: The Wald statistic with pooled or unpooled variance, depending on the user choice
    of *pooled*.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat
  prefs: []
  type: TYPE_NORMAL
- en: P-value, the probability of obtaining a distribution at least as extreme as
    the one that was actually observed, assuming that the null hypothesis is true.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`chi2_contingency`](scipy.stats.chi2_contingency.html#scipy.stats.chi2_contingency
    "scipy.stats.chi2_contingency")'
  prefs: []
  type: TYPE_NORMAL
- en: Chi-square test of independence of variables in a contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: '[`fisher_exact`](scipy.stats.fisher_exact.html#scipy.stats.fisher_exact "scipy.stats.fisher_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Fisher exact test on a 2x2 contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: '[`boschloo_exact`](scipy.stats.boschloo_exact.html#scipy.stats.boschloo_exact
    "scipy.stats.boschloo_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Boschloo’s exact test on a 2x2 contingency table, which is an uniformly more
    powerful alternative to Fisher’s exact test.
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: Barnard’s test is an exact test used in the analysis of contingency tables.
    It examines the association of two categorical variables, and is a more powerful
    alternative than Fisher’s exact test for 2x2 contingency tables.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s define \(X_0\) a 2x2 matrix representing the observed sample, where each
    column stores the binomial experiment, as in the example below. Let’s also define
    \(p_1, p_2\) the theoretical binomial probabilities for \(x_{11}\) and \(x_{12}\).
    When using Barnard exact test, we can assert three different null hypotheses :'
  prefs: []
  type: TYPE_NORMAL
- en: '\(H_0 : p_1 \geq p_2\) versus \(H_1 : p_1 < p_2\), with *alternative* = “less”'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '\(H_0 : p_1 \leq p_2\) versus \(H_1 : p_1 > p_2\), with *alternative* = “greater”'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '\(H_0 : p_1 = p_2\) versus \(H_1 : p_1 \neq p_2\), with *alternative* = “two-sided”
    (default one)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In order to compute Barnard’s exact test, we are using the Wald statistic [[3]](#r6519c297ee50-3)
    with pooled or unpooled variance. Under the default assumption that both variances
    are equal (`pooled = True`), the statistic is computed as:'
  prefs: []
  type: TYPE_NORMAL
- en: \[T(X) = \frac{ \hat{p}_1 - \hat{p}_2 }{ \sqrt{ \hat{p}(1 - \hat{p}) (\frac{1}{c_1}
    + \frac{1}{c_2}) } }\]
  prefs: []
  type: TYPE_NORMAL
- en: with \(\hat{p}_1, \hat{p}_2\) and \(\hat{p}\) the estimator of \(p_1, p_2\)
    and \(p\), the latter being the combined probability, given the assumption that
    \(p_1 = p_2\).
  prefs: []
  type: TYPE_NORMAL
- en: 'If this assumption is invalid (`pooled = False`), the statistic is:'
  prefs: []
  type: TYPE_NORMAL
- en: \[T(X) = \frac{ \hat{p}_1 - \hat{p}_2 }{ \sqrt{ \frac{\hat{p}_1 (1 - \hat{p}_1)}{c_1}
    + \frac{\hat{p}_2 (1 - \hat{p}_2)}{c_2} } }\]
  prefs: []
  type: TYPE_NORMAL
- en: 'The p-value is then computed as:'
  prefs: []
  type: TYPE_NORMAL
- en: \[\sum \binom{c_1}{x_{11}} \binom{c_2}{x_{12}} \pi^{x_{11} + x_{12}} (1 - \pi)^{t
    - x_{11} - x_{12}}\]
  prefs: []
  type: TYPE_NORMAL
- en: 'where the sum is over all 2x2 contingency tables \(X\) such that: * \(T(X)
    \leq T(X_0)\) when *alternative* = “less”, * \(T(X) \geq T(X_0)\) when *alternative*
    = “greater”, or * \(T(X) \geq |T(X_0)|\) when *alternative* = “two-sided”. Above,
    \(c_1, c_2\) are the sum of the columns 1 and 2, and \(t\) the total (sum of the
    4 sample’s element).'
  prefs: []
  type: TYPE_NORMAL
- en: The returned p-value is the maximum p-value taken over the nuisance parameter
    \(\pi\), where \(0 \leq \pi \leq 1\).
  prefs: []
  type: TYPE_NORMAL
- en: This function’s complexity is \(O(n c_1 c_2)\), where *n* is the number of sample
    points.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Barnard, G. A. “Significance Tests for 2x2 Tables”. *Biometrika*. 34.1/2 (1947):
    123-138\. [DOI:dpgkg3](https://doi.org/dpgkg3)'
  prefs: []
  type: TYPE_NORMAL
- en: '[2] ([1](#id5),[2](#id6))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Mehta, Cyrus R., and Pralay Senchaudhuri. “Conditional versus unconditional
    exact tests for comparing two binomials.” *Cytel Software Corporation* 675 (2003):
    1-5.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id1)]'
  prefs: []
  type: TYPE_NORMAL
- en: “Wald Test”. *Wikipedia*. [https://en.wikipedia.org/wiki/Wald_test](https://en.wikipedia.org/wiki/Wald_test)
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: An example use of Barnard’s test is presented in [[2]](#r6519c297ee50-2).
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider the following example of a vaccine efficacy study (Chan, 1998). In
    a randomized clinical trial of 30 subjects, 15 were inoculated with a recombinant
    DNA influenza vaccine and the 15 were inoculated with a placebo. Twelve of the
    15 subjects in the placebo group (80%) eventually became infected with influenza
    whereas for the vaccine group, only 7 of the 15 subjects (47%) became infected.
    The data are tabulated as a 2 x 2 table:'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_BQ
  type: TYPE_PRE
- en: When working with statistical hypothesis testing, we usually use a threshold
    probability or significance level upon which we decide to reject the null hypothesis
    \(H_0\). Suppose we choose the common significance level of 5%.
  prefs: []
  type: TYPE_NORMAL
- en: 'Our alternative hypothesis is that the vaccine will lower the chance of becoming
    infected with the virus; that is, the probability \(p_1\) of catching the virus
    with the vaccine will be *less than* the probability \(p_2\) of catching the virus
    without the vaccine. Therefore, we call [`barnard_exact`](#scipy.stats.barnard_exact
    "scipy.stats.barnard_exact") with the `alternative="less"` option:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Under the null hypothesis that the vaccine will not lower the chance of becoming
    infected, the probability of obtaining test results at least as extreme as the
    observed data is approximately 3.4%. Since this p-value is less than our chosen
    significance level, we have evidence to reject \(H_0\) in favor of the alternative.
  prefs: []
  type: TYPE_NORMAL
- en: 'Suppose we had used Fisher’s exact test instead:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: With the same threshold significance of 5%, we would not have been able to reject
    the null hypothesis in favor of the alternative. As stated in [[2]](#r6519c297ee50-2),
    Barnard’s test is uniformly more powerful than Fisher’s exact test because Barnard’s
    test does not condition on any margin. Fisher’s test should only be used when
    both sets of marginals are fixed.
  prefs: []
  type: TYPE_NORMAL
