- en: scipy.stats.levene
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.levene.html#scipy.stats.levene](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.levene.html#scipy.stats.levene)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Perform Levene test for equal variances.
  prefs: []
  type: TYPE_NORMAL
- en: The Levene test tests the null hypothesis that all input samples are from populations
    with equal variances. Levene’s test is an alternative to Bartlett’s test [`bartlett`](scipy.stats.bartlett.html#scipy.stats.bartlett
    "scipy.stats.bartlett") in the case where there are significant deviations from
    normality.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**sample1, sample2, …**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: The sample data, possibly with different lengths. Only one-dimensional samples
    are accepted.
  prefs: []
  type: TYPE_NORMAL
- en: '**center**{‘mean’, ‘median’, ‘trimmed’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Which function of the data to use in the test. The default is ‘median’.
  prefs: []
  type: TYPE_NORMAL
- en: '**proportiontocut**float, optional'
  prefs: []
  type: TYPE_NORMAL
- en: When *center* is ‘trimmed’, this gives the proportion of data points to cut
    from each end. (See [`scipy.stats.trim_mean`](scipy.stats.trim_mean.html#scipy.stats.trim_mean
    "scipy.stats.trim_mean").) Default is 0.05.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, default: 0'
  prefs: []
  type: TYPE_NORMAL
- en: If an int, the axis of the input along which to compute the statistic. The statistic
    of each axis-slice (e.g. row) of the input will appear in a corresponding element
    of the output. If `None`, the input will be raveled before computing the statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '**nan_policy**{‘propagate’, ‘omit’, ‘raise’}'
  prefs: []
  type: TYPE_NORMAL
- en: Defines how to handle input NaNs.
  prefs: []
  type: TYPE_NORMAL
- en: '`propagate`: if a NaN is present in the axis slice (e.g. row) along which the
    statistic is computed, the corresponding entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`omit`: NaNs will be omitted when performing the calculation. If insufficient
    data remains in the axis slice along which the statistic is computed, the corresponding
    entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`raise`: if a NaN is present, a `ValueError` will be raised.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**keepdims**bool, default: False'
  prefs: []
  type: TYPE_NORMAL
- en: If this is set to True, the axes which are reduced are left in the result as
    dimensions with size one. With this option, the result will broadcast correctly
    against the input array.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**statistic**float'
  prefs: []
  type: TYPE_NORMAL
- en: The test statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '**pvalue**float'
  prefs: []
  type: TYPE_NORMAL
- en: The p-value for the test.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`fligner`](scipy.stats.fligner.html#scipy.stats.fligner "scipy.stats.fligner")'
  prefs: []
  type: TYPE_NORMAL
- en: A non-parametric test for the equality of k variances
  prefs: []
  type: TYPE_NORMAL
- en: '[`bartlett`](scipy.stats.bartlett.html#scipy.stats.bartlett "scipy.stats.bartlett")'
  prefs: []
  type: TYPE_NORMAL
- en: A parametric test for equality of k variances in normal samples
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: 'Three variations of Levene’s test are possible. The possibilities and their
    recommended usages are:'
  prefs: []
  type: TYPE_NORMAL
- en: '‘median’ : Recommended for skewed (non-normal) distributions>'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '‘mean’ : Recommended for symmetric, moderate-tailed distributions.'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: ''
  prefs:
  - PREF_BQ
  - PREF_IND
  type: TYPE_NORMAL
- en: '‘trimmed’ : Recommended for heavy-tailed distributions.'
  prefs:
  - PREF_BQ
  - PREF_UL
  type: TYPE_NORMAL
- en: The test version using the mean was proposed in the original article of Levene
    ([[2]](#r7cdc7a5c4c19-2)) while the median and trimmed mean have been studied
    by Brown and Forsythe ([[3]](#r7cdc7a5c4c19-3)), sometimes also referred to as
    Brown-Forsythe test.
  prefs: []
  type: TYPE_NORMAL
- en: Beginning in SciPy 1.9, `np.matrix` inputs (not recommended for new code) are
    converted to `np.ndarray` before the calculation is performed. In this case, the
    output will be a scalar or `np.ndarray` of appropriate shape rather than a 2D
    `np.matrix`. Similarly, while masked elements of masked arrays are ignored, the
    output will be a scalar or `np.ndarray` rather than a masked array with `mask=False`.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://www.itl.nist.gov/div898/handbook/eda/section3/eda35a.htm](https://www.itl.nist.gov/div898/handbook/eda/section3/eda35a.htm)'
  prefs: []
  type: TYPE_NORMAL
- en: '[[2](#id1)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Levene, H. (1960). In Contributions to Probability and Statistics: Essays in
    Honor of Harold Hotelling, I. Olkin et al. eds., Stanford University Press, pp.
    278-292.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id2)]'
  prefs: []
  type: TYPE_NORMAL
- en: Brown, M. B. and Forsythe, A. B. (1974), Journal of the American Statistical
    Association, 69, 364-367
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id9)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'C.I. BLISS (1952), The Statistics of Bioassay: With Special Reference to the
    Vitamins, pp 499-503, [DOI:10.1016/C2013-0-12584-6](https://doi.org/10.1016/C2013-0-12584-6).'
  prefs: []
  type: TYPE_NORMAL
- en: '[[5](#id10)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'B. Phipson and G. K. Smyth. “Permutation P-values Should Never Be Zero: Calculating
    Exact P-values When Permutations Are Randomly Drawn.” Statistical Applications
    in Genetics and Molecular Biology 9.1 (2010).'
  prefs: []
  type: TYPE_NORMAL
- en: '[[6](#id11)]'
  prefs: []
  type: TYPE_NORMAL
- en: Ludbrook, J., & Dudley, H. (1998). Why permutation tests are superior to t and
    F tests in biomedical research. The American Statistician, 52(2), 127-132.
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: In [[4]](#r7cdc7a5c4c19-4), the influence of vitamin C on the tooth growth of
    guinea pigs was investigated. In a control study, 60 subjects were divided into
    small dose, medium dose, and large dose groups that received daily doses of 0.5,
    1.0 and 2.0 mg of vitamin C, respectively. After 42 days, the tooth growth was
    measured.
  prefs: []
  type: TYPE_NORMAL
- en: The `small_dose`, `medium_dose`, and `large_dose` arrays below record tooth
    growth measurements of the three groups in microns.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The [`levene`](#scipy.stats.levene "scipy.stats.levene") statistic is sensitive
    to differences in variances between the samples.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: The value of the statistic tends to be high when there is a large difference
    in variances.
  prefs: []
  type: TYPE_NORMAL
- en: 'We can test for inequality of variance among the groups by comparing the observed
    value of the statistic against the null distribution: the distribution of statistic
    values derived under the null hypothesis that the population variances of the
    three groups are equal.'
  prefs: []
  type: TYPE_NORMAL
- en: For this test, the null distribution follows the F distribution as shown below.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-levene-1_00_00.png](../Images/3e68fee5c664eaa86611f83c9e5c043d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The comparison is quantified by the p-value: the proportion of values in the
    null distribution greater than or equal to the observed value of the statistic.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-levene-1_01_00.png](../Images/b389722ced8b5e9699482be28c7b72b1.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'If the p-value is “small” - that is, if there is a low probability of sampling
    data from distributions with identical variances that produces such an extreme
    value of the statistic - this may be taken as evidence against the null hypothesis
    in favor of the alternative: the variances of the groups are not equal. Note that:'
  prefs: []
  type: TYPE_NORMAL
- en: The inverse is not true; that is, the test is not used to provide evidence for
    the null hypothesis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The threshold for values that will be considered “small” is a choice that should
    be made before the data is analyzed [[5]](#r7cdc7a5c4c19-5) with consideration
    of the risks of both false positives (incorrectly rejecting the null hypothesis)
    and false negatives (failure to reject a false null hypothesis).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Small p-values are not evidence for a *large* effect; rather, they can only
    provide evidence for a “significant” effect, meaning that they are unlikely to
    have occurred under the null hypothesis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Note that the F distribution provides an asymptotic approximation of the null
    distribution. For small samples, it may be more appropriate to perform a permutation
    test: Under the null hypothesis that all three samples were drawn from the same
    population, each of the measurements is equally likely to have been observed in
    any of the three samples. Therefore, we can form a randomized null distribution
    by calculating the statistic under many randomly-generated partitionings of the
    observations into the three samples.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-stats-levene-1_02_00.png](../Images/55babe47b715953305803ca3f77b9d4a.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Note that there is significant disagreement between the p-value calculated here
    and the asymptotic approximation returned by [`levene`](#scipy.stats.levene "scipy.stats.levene")
    above. The statistical inferences that can be drawn rigorously from a permutation
    test are limited; nonetheless, they may be the preferred approach in many circumstances
    [[6]](#r7cdc7a5c4c19-6).
  prefs: []
  type: TYPE_NORMAL
- en: Following is another generic example where the null hypothesis would be rejected.
  prefs: []
  type: TYPE_NORMAL
- en: Test whether the lists *a*, *b* and *c* come from populations with equal variances.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: The small p-value suggests that the populations do not have equal variances.
  prefs: []
  type: TYPE_NORMAL
- en: 'This is not surprising, given that the sample variance of *b* is much larger
    than that of *a* and *c*:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
