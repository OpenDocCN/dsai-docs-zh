- en: Comparison with spreadsheets
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 与电子表格的比较
- en: 原文：[https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_spreadsheets.html](https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_spreadsheets.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_spreadsheets.html](https://pandas.pydata.org/docs/getting_started/comparison/comparison_with_spreadsheets.html)
- en: Since many potential pandas users have some familiarity with spreadsheet programs
    like [Excel](https://support.microsoft.com/en-us/excel), this page is meant to
    provide some examples of how various spreadsheet operations would be performed
    using pandas. This page will use terminology and link to documentation for Excel,
    but much will be the same/similar in [Google Sheets](https://support.google.com/a/users/answer/9282959),
    [LibreOffice Calc](https://help.libreoffice.org/latest/en-US/text/scalc/main0000.html?DbPAR=CALC),
    [Apple Numbers](https://www.apple.com/numbers/compatibility/), and other Excel-compatible
    spreadsheet software.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 由于许多潜在的 pandas 用户对电子表格程序（如 [Excel](https://support.microsoft.com/en-us/excel)）有一定的了解，因此本页面旨在提供使用
    pandas 执行各种电子表格操作的示例。本页面将使用 Excel 的术语和链接到文档，但在 [Google Sheets](https://support.google.com/a/users/answer/9282959)、[LibreOffice
    Calc](https://help.libreoffice.org/latest/en-US/text/scalc/main0000.html?DbPAR=CALC)、[Apple
    Numbers](https://www.apple.com/numbers/compatibility/) 和其他兼容 Excel 的电子表格软件中，情况将是相同/类似的。
- en: If you’re new to pandas, you might want to first read through [10 Minutes to
    pandas](../../user_guide/10min.html#min) to familiarize yourself with the library.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您是 pandas 的新手，您可能首先想阅读 [10分钟入门 pandas](../../user_guide/10min.html#min) 来熟悉该库。
- en: 'As is customary, we import pandas and NumPy as follows:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 惯例上，我们导入 pandas 和 NumPy 如下：
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Data structures
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据结构
- en: General terminology translation
  id: totrans-7
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 通用术语翻译
- en: '| pandas | Excel |'
  id: totrans-8
  prefs: []
  type: TYPE_TB
  zh: '| pandas | Excel |'
- en: '| --- | --- |'
  id: totrans-9
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `DataFrame` | worksheet |'
  id: totrans-10
  prefs: []
  type: TYPE_TB
  zh: '| `DataFrame` | 工作表 |'
- en: '| `Series` | column |'
  id: totrans-11
  prefs: []
  type: TYPE_TB
  zh: '| `Series` | 列 |'
- en: '| `Index` | row headings |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '| `Index` | 行标题 |'
- en: '| row | row |'
  id: totrans-13
  prefs: []
  type: TYPE_TB
  zh: '| 行 | 行 |'
- en: '| `NaN` | empty cell |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '| `NaN` | 空单元格 |'
- en: '`DataFrame`'
  id: totrans-15
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`DataFrame`'
- en: A `DataFrame` in pandas is analogous to an Excel worksheet. While an Excel workbook
    can contain multiple worksheets, pandas `DataFrame`s exist independently.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，`DataFrame`类似于 Excel 工作表。虽然 Excel 工作簿可以包含多个工作表，但 pandas 的`DataFrame`是独立存在的。
- en: '`Series`'
  id: totrans-17
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Series`'
- en: A `Series` is the data structure that represents one column of a `DataFrame`.
    Working with a `Series` is analogous to referencing a column of a spreadsheet.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '`Series` 是表示`DataFrame`的一列的数据结构。与处理电子表格的列类似，操作`Series`。'
- en: '`Index`'
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Index`'
- en: Every `DataFrame` and `Series` has an `Index`, which are labels on the *rows*
    of the data. In pandas, if no index is specified, a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") is used by default (first row = 0, second row = 1, and so
    on), analogous to row headings/numbers in spreadsheets.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 每个`DataFrame`和`Series`都有一个`Index`，这些是数据的*行*上的标签。在 pandas 中，如果没有指定索引，默认使用 [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex)（第一行
    = 0，第二行 = 1，依此类推），类似于电子表格中的行标题/编号。
- en: In pandas, indexes can be set to one (or multiple) unique values, which is like
    having a column that is used as the row identifier in a worksheet. Unlike most
    spreadsheets, these `Index` values can actually be used to reference the rows.
    (Note that [this can be done in Excel with structured references](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e).)
    For example, in spreadsheets, you would reference the first row as `A1:Z1`, while
    in pandas you could use `populations.loc['Chicago']`.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，索引可以设置为一个（或多个）唯一值，就像在工作表中使用作为行标识符的列一样。与大多数电子表格不同，这些`Index`值实际上可以用于引用行。（请注意，[在
    Excel 中可以使用结构引用执行此操作](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e)。）例如，在电子表格中，您可以将第一行引用为`A1:Z1`，而在
    pandas 中，您可以使用`populations.loc['Chicago']`。
- en: Index values are also persistent, so if you re-order the rows in a `DataFrame`,
    the label for a particular row don’t change.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 索引值也是持久的，因此���果重新排列`DataFrame`中的行，特定行的标签不会改变。
- en: See the [indexing documentation](../../user_guide/indexing.html#indexing) for
    much more on how to use an `Index` effectively.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 查看 [索引文档](../../user_guide/indexing.html#indexing) 以了解如何有效使用`Index`。
- en: Copies vs. in place operations
  id: totrans-24
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 复制 vs. 原地操作
- en: 'Most pandas operations return copies of the `Series`/`DataFrame`. To make the
    changes “stick”, you’ll need to either assign to a new variable:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 pandas 操作返回`Series`/`DataFrame`的副本。要使更改“生效”，您需要将其分配给一个新变量：
- en: '[PRE1]'
  id: totrans-26
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'or overwrite the original one:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 或覆盖原始数据：
- en: '[PRE2]'
  id: totrans-28
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Note
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'You will see an `inplace=True` or `copy=False` keyword argument available for
    some methods:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到一些方法可用的 `inplace=True` 或 `copy=False` 关键字参数：
- en: '[PRE3]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: There is an active discussion about deprecating and removing `inplace` and `copy`
    for most methods (e.g. `dropna`) except for a very small subset of methods (including
    `replace`). Both keywords won’t be necessary anymore in the context of Copy-on-Write.
    The proposal can be found [here](https://github.com/pandas-dev/pandas/pull/51466).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 目前正在就大多数方法（例如 `dropna`）废弃和移除 `inplace` 和 `copy` 进行积极讨论，除了一小部分方法（包括 `replace`）之外。在写时复制的情况下，这两个关键字将不再必要。提案可以在[这里](https://github.com/pandas-dev/pandas/pull/51466)找到。
- en: Data input / output
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据输入/输出
- en: Constructing a DataFrame from values
  id: totrans-34
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从值构建 DataFrame
- en: In a spreadsheet, [values can be typed directly into cells](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038).
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，[值可以直接输入到单元格中](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038)。
- en: A pandas `DataFrame` can be constructed in many different ways, but for a small
    number of values, it is often convenient to specify it as a Python dictionary,
    where the keys are the column names and the values are the data.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 一个 pandas `DataFrame` 可以以许多不同的方式构建，但对于少量值，通常将其指定为 Python 字典是方便的，其中键是列名，值是数据。
- en: '[PRE4]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: Reading external data
  id: totrans-38
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 读取外部数据
- en: Both [Excel](https://support.microsoft.com/en-us/office/import-data-from-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a)
    and [pandas](../intro_tutorials/02_read_write.html#min-tut-02-read-write) can
    import data from various sources in various formats.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: '[Excel](https://support.microsoft.com/en-us/office/import-data-from-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a)
    和 [pandas](../intro_tutorials/02_read_write.html#min-tut-02-read-write) 都可以从各种来源以各种格式导入数据。'
- en: CSV
  id: totrans-40
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: CSV
- en: 'Let’s load and display the [tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)
    dataset from the pandas tests, which is a CSV file. In Excel, you would download
    and then [open the CSV](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba).
    In pandas, you pass the URL or local path of the CSV file to [`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv"):'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们加载并显示来自 pandas 测试的[tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)数据集，这是一个
    CSV 文件。在 Excel 中，您会下载然后[打开 CSV](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba)。在
    pandas 中，您将 URL 或本地路径传递给 [`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv")：
- en: '[PRE5]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Like [Excel’s Text Import Wizard](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857),
    `read_csv` can take a number of parameters to specify how the data should be parsed.
    For example, if the data was instead tab delimited, and did not have column names,
    the pandas command would be:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 像[Excel 的文本导入向导](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857)一样，`read_csv`
    可以接受多个参数来指定数据应如何解析。例如，如果数据实际上是制表符分隔的，并且没有列名，那么 pandas 命令将是：
- en: '[PRE6]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Excel files
  id: totrans-45
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Excel 文件
- en: Excel opens [various Excel file formats](https://support.microsoft.com/en-us/office/file-formats-that-are-supported-in-excel-0943ff2c-6014-4e8d-aaea-b83d51d46247)
    by double-clicking them, or using [the Open menu](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176).
    In pandas, you use [special methods for reading and writing from/to Excel files](../../user_guide/io.html#io-excel).
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: Excel 通过双击打开[各种 Excel 文件格式](https://support.microsoft.com/en-us/office/file-formats-that-are-supported-in-excel-0943ff2c-6014-4e8d-aaea-b83d51d46247)，或使用[打开菜单](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176)。在
    pandas 中，您可以使用[特殊方法来读取和写入 Excel 文件](../../user_guide/io.html#io-excel)。
- en: 'Let’s first [create a new Excel file](../../user_guide/io.html#io-excel-writer)
    based on the `tips` dataframe in the above example:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先根据上面示例中的 `tips` 数据框[创建一个新的 Excel 文件](../../user_guide/io.html#io-excel-writer)：
- en: '[PRE7]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Should you wish to subsequently access the data in the `tips.xlsx` file, you
    can read it into your module using
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望随后访问 `tips.xlsx` 文件中的数据，可以使用以下方式将其读入您的模块中
- en: '[PRE8]'
  id: totrans-50
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You have just read in an Excel file using pandas!
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 你刚刚使用 pandas 读取了一个 Excel 文件！
- en: Limiting output
  id: totrans-52
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 限制输出
- en: Spreadsheet programs will only show one screenful of data at a time and then
    allow you to scroll, so there isn’t really a need to limit output. In pandas,
    you’ll need to put a little more thought into controlling how your `DataFrame`s
    are displayed.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 电子表格程序一次只会显示一个屏幕的数据，然后允许你滚动，因此实际上不需要限制输出。在 pandas 中，你需要更多地考虑如何控制你的`DataFrame`的显示方式。
- en: By default, pandas will truncate output of large `DataFrame`s to show the first
    and last rows. This can be overridden by [changing the pandas options](../../user_guide/options.html#options),
    or using [`DataFrame.head()`](../../reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head
    "pandas.DataFrame.head") or [`DataFrame.tail()`](../../reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail
    "pandas.DataFrame.tail").
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，pandas会截断大型`DataFrame`的输出以显示第一行和最后一行。这可以通过[更改 pandas 选项](../../user_guide/options.html#options)，或使用[`DataFrame.head()`](../../reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head
    "pandas.DataFrame.head")或[`DataFrame.tail()`](../../reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail
    "pandas.DataFrame.tail")来覆盖。
- en: '[PRE9]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Exporting data
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 导出数据
- en: By default, desktop spreadsheet software will save to its respective file format
    (`.xlsx`, `.ods`, etc). You can, however, [save to other file formats](https://support.microsoft.com/en-us/office/save-a-workbook-in-another-file-format-6a16c862-4a36-48f9-a300-c2ca0065286e).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，桌面电子表格软件会保存到其相应的文件格式（`.xlsx`，`.ods`等）。但是，你可以[保存到其他文件格式](https://support.microsoft.com/en-us/office/save-a-workbook-in-another-file-format-6a16c862-4a36-48f9-a300-c2ca0065286e)。
- en: '[pandas can create Excel files](../../user_guide/io.html#io-excel-writer),
    [CSV](../../user_guide/io.html#io-store-in-csv), or [a number of other formats](../../user_guide/io.html#io).'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: '[pandas可以创建Excel文件](../../user_guide/io.html#io-excel-writer)，[CSV](../../user_guide/io.html#io-store-in-csv)，或[其他多种格式](../../user_guide/io.html#io)。'
- en: Data operations
  id: totrans-59
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据操作
- en: Operations on columns
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列上的操作
- en: In spreadsheets, [formulas](https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173)
    are often created in individual cells and then [dragged](https://support.microsoft.com/en-us/office/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218)
    into other cells to compute them for other columns. In pandas, you’re able to
    do operations on whole columns directly.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，[公式](https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173)通常在单独的单元格中创建，然后通过[拖动](https://support.microsoft.com/en-us/office/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218)到其他单元格中以计算其他列的值。在
    pandas 中，你可以直接对整列进行操作。
- en: pandas provides vectorized operations by specifying the individual `Series`
    in the `DataFrame`. New columns can be assigned in the same way. The [`DataFrame.drop()`](../../reference/api/pandas.DataFrame.drop.html#pandas.DataFrame.drop
    "pandas.DataFrame.drop") method drops a column from the `DataFrame`.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: pandas通过在`DataFrame`中指定单独的`Series`提供矢量化操作。新列可以以相同的方式分配。[`DataFrame.drop()`](../../reference/api/pandas.DataFrame.drop.html#pandas.DataFrame.drop
    "pandas.DataFrame.drop")方法从`DataFrame`中删除列。
- en: '[PRE10]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Note that we aren’t having to tell it to do that subtraction cell-by-cell —
    pandas handles that for us. See [how to create new columns derived from existing
    columns](../intro_tutorials/05_add_columns.html#min-tut-05-columns).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们不需要逐个单元格地告诉它执行减法 — pandas会为我们处理。查看[如何从现有列创建新列](../intro_tutorials/05_add_columns.html#min-tut-05-columns)。
- en: Filtering
  id: totrans-65
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 过滤
- en: '[In Excel, filtering is done through a graphical menu.](https://support.microsoft.com/en-us/office/filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e)'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '[在 Excel 中，过滤是通过图形菜单完成的。](https://support.microsoft.com/en-us/office/filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e)'
- en: '![Screenshot showing filtering of the total_bill column to values greater than
    10](../Images/504670cee47d6136c9bd2d70afce698f.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示将total_bill列过滤为大于10的值](../Images/504670cee47d6136c9bd2d70afce698f.png)'
- en: DataFrames can be filtered in multiple ways; the most intuitive of which is
    using [boolean indexing](../../user_guide/indexing.html#indexing-boolean).
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 数据框可以通过多种方式进行过滤；其中最直观的是使用[布尔索引](../../user_guide/indexing.html#indexing-boolean)。
- en: '[PRE11]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: The above statement is simply passing a `Series` of `True`/`False` objects to
    the DataFrame, returning all rows with `True`.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 上述语句只是将`True`/`False`对象的`Series`传递给数据框，返回所有具有`True`的��。
- en: '[PRE12]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: If/then logic
  id: totrans-72
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: If/then 逻辑
- en: Let’s say we want to make a `bucket` column with values of `low` and `high`,
    based on whether the `total_bill` is less or more than $10.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要根据`total_bill`是小于还是大于$10来创建一个`bucket`列，值为`low`和`high`。
- en: In spreadsheets, logical comparison can be done with [conditional formulas](https://support.microsoft.com/en-us/office/create-conditional-formulas-ca916c57-abd8-4b44-997c-c309b7307831).
    We’d use a formula of `=IF(A2 < 10, "low", "high")`, dragged to all cells in a
    new `bucket` column.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，可以使用[条件公式](https://support.microsoft.com/en-us/office/create-conditional-formulas-ca916c57-abd8-4b44-997c-c309b7307831)进行逻辑比较。我们会使用公式`=IF(A2
    < 10, "low", "high")`，拖动到新的`bucket`列中的所有单元格。
- en: '![Screenshot showing the formula from above in a bucket column of the tips
    spreadsheet](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示了在提示电子表格的桶列中的上述公式](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
- en: The same operation in pandas can be accomplished using the `where` method from
    `numpy`.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在pandas中，可以使用`numpy`中的`where`方法来完成相同的操作。
- en: '[PRE13]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Date functionality
  id: totrans-78
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 日期功能
- en: '*This section will refer to “dates”, but timestamps are handled similarly.*'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: '*本节将涉及“日期”，但时间戳处理方式类似。*'
- en: 'We can think of date functionality in two parts: parsing, and output. In spreadsheets,
    date values are generally parsed automatically, though there is a [DATEVALUE](https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252)
    function if you need it. In pandas, you need to explicitly convert plain text
    to datetime objects, either [while reading from a CSV](../../user_guide/io.html#io-read-csv-table-datetime)
    or [once in a DataFrame](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties).'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将日期功能分为两部分：解析和输出。在电子表格中，日期值通常会自动解析，尽管如果需要，可以使用[DATEVALUE](https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252)函数。在pandas中，您需要显式将纯文本转换为日期时间对象，可以在[从CSV读取时](../../user_guide/io.html#io-read-csv-table-datetime)或[在DataFrame中的某个时刻](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)进行转换。
- en: Once parsed, spreadsheets display the dates in a default format, though [the
    format can be changed](https://support.microsoft.com/en-us/office/format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e).
    In pandas, you’ll generally want to keep dates as `datetime` objects while you’re
    doing calculations with them. Outputting *parts* of dates (such as the year) is
    done through [date functions](https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81)
    in spreadsheets, and [datetime properties](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)
    in pandas.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 解析后，电子表格会以默认格式显示日期，尽管[格式可以更改](https://support.microsoft.com/en-us/office/format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e)。在pandas中，您通常希望在进行计算时将日期保留为`datetime`对象。在电子表格中，输出日期的*部分*（如年份）是通过[日期函数](https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81)完成的，在pandas中则通过[datetime属性](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)完成。
- en: 'Given `date1` and `date2` in columns `A` and `B` of a spreadsheet, you might
    have these formulas:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，如果在列`A`和`B`中给出`date1`和`date2`，你可能会有这些公式：
- en: '| column | formula |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| 列 | 公式 |'
- en: '| --- | --- |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `date1_year` | `=YEAR(A2)` |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| `date1_year` | `=YEAR(A2)` |'
- en: '| `date2_month` | `=MONTH(B2)` |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| `date2_month` | `=MONTH(B2)` |'
- en: '| `date1_next` | `=DATE(YEAR(A2),MONTH(A2)+1,1)` |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| `date1_next` | `=DATE(YEAR(A2),MONTH(A2)+1,1)` |'
- en: '| `months_between` | `=DATEDIF(A2,B2,"M")` |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| `months_between` | `=DATEDIF(A2,B2,"M")` |'
- en: The equivalent pandas operations are shown below.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 下面显示了等效的pandas操作。
- en: '[PRE14]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: See [Time series / date functionality](../../user_guide/timeseries.html#timeseries)
    for more details.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 查看[时间序列/日期功能](../../user_guide/timeseries.html#timeseries)以获取更多详细信息。
- en: Selection of columns
  id: totrans-92
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列的选择
- en: 'In spreadsheets, you can select columns you want by:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，您可以通过以下方式选择要选择的列：
- en: '[Hiding columns](https://support.microsoft.com/en-us/office/hide-or-show-rows-or-columns-659c2cad-802e-44ee-a614-dde8443579f8)'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[隐藏列](https://support.microsoft.com/en-us/office/hide-or-show-rows-or-columns-659c2cad-802e-44ee-a614-dde8443579f8)'
- en: '[Deleting columns](https://support.microsoft.com/en-us/office/insert-or-delete-rows-and-columns-6f40e6e4-85af-45e0-b39d-65dd504a3246)'
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[删除列](https://support.microsoft.com/en-us/office/insert-or-delete-rows-and-columns-6f40e6e4-85af-45e0-b39d-65dd504a3246)'
- en: '[Referencing a range](https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa)
    from one worksheet into another'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[引用范围](https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa)从一个工作表到另一个工作表'
- en: Since spreadsheet columns are typically [named in a header row](https://support.microsoft.com/en-us/office/turn-excel-table-headers-on-or-off-c91d1742-312c-4480-820f-cf4b534c8b3b),
    renaming a column is simply a matter of changing the text in that first cell.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 由于电子表格列通常在[标题行中命名](https://support.microsoft.com/en-us/office/turn-excel-table-headers-on-or-off-c91d1742-312c-4480-820f-cf4b534c8b3b)，所以重命名列只是简单地更改该第一个单元格中的文本。
- en: The same operations are expressed in pandas below.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: pandas中使用相同的操作如下所示。
- en: Keep certain columns
  id: totrans-99
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 保留某些列
- en: '[PRE15]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Drop a column
  id: totrans-101
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 删除列
- en: '[PRE16]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Rename a column
  id: totrans-103
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重命名列
- en: '[PRE17]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Sorting by values
  id: totrans-105
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 按值排序
- en: Sorting in spreadsheets is accomplished via [the sort dialog](https://support.microsoft.com/en-us/office/sort-data-in-a-range-or-table-62d0b95d-2a90-4610-a6ae-2e545c4a4654).
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中进行排序是通过[排序对话框](https://support.microsoft.com/en-us/office/sort-data-in-a-range-or-table-62d0b95d-2a90-4610-a6ae-2e545c4a4654)完成的。
- en: '![Screenshot of dialog from Excel showing sorting by the sex then total_bill
    columns](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-107
  prefs: []
  type: TYPE_IMG
  zh: '![Excel对话框截图，显示按性别然后total_bill列排序](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
- en: pandas has a [`DataFrame.sort_values()`](../../reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values
    "pandas.DataFrame.sort_values") method, which takes a list of columns to sort
    by.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: pandas有一个[`DataFrame.sort_values()`](../../reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values
    "pandas.DataFrame.sort_values")方法，它接受要按列排序的列列表。
- en: '[PRE18]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: String processing
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 字符串处理
- en: Finding length of string
  id: totrans-111
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查找字符串的长度
- en: In spreadsheets, the number of characters in text can be found with the [LEN](https://support.microsoft.com/en-us/office/len-lenb-functions-29236f94-cedc-429d-affd-b5e33d2c67cb)
    function. This can be used with the [TRIM](https://support.microsoft.com/en-us/office/trim-function-410388fa-c5df-49c6-b16c-9e5630b479f9)
    function to remove extra whitespace.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，可以使用[LEN](https://support.microsoft.com/en-us/office/len-lenb-functions-29236f94-cedc-429d-affd-b5e33d2c67cb)函数找到文本中的字符数。这可以与[TRIM](https://support.microsoft.com/en-us/office/trim-function-410388fa-c5df-49c6-b16c-9e5630b479f9)函数一起使用以删除额外的空格。
- en: '[PRE19]'
  id: totrans-113
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: You can find the length of a character string with [`Series.str.len()`](../../reference/api/pandas.Series.str.len.html#pandas.Series.str.len
    "pandas.Series.str.len"). In Python 3, all strings are Unicode strings. `len`
    includes trailing blanks. Use `len` and `rstrip` to exclude trailing blanks.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用[`Series.str.len()`](../../reference/api/pandas.Series.str.len.html#pandas.Series.str.len
    "pandas.Series.str.len")找到字符字符串的长度。在Python 3中，所有字符串都是Unicode字符串。`len`包括尾随空格。使用`len`和`rstrip`排除尾随空格。
- en: '[PRE20]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Note this will still include multiple spaces within the string, so isn’t 100%
    equivalent.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，这仍将包括字符串中的多个空格，因此不是100%等效。
- en: Finding position of substring
  id: totrans-117
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查找子串的位置
- en: The [FIND](https://support.microsoft.com/en-us/office/find-findb-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628)
    spreadsheet function returns the position of a substring, with the first character
    being `1`.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: '[FIND](https://support.microsoft.com/en-us/office/find-findb-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628)电子表格函数返回子字符串的位置，第一个字符为`1`。'
- en: '![Screenshot of FIND formula being used in Excel](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![Excel中使用FIND公式的截图](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
- en: You can find the position of a character in a column of strings with the [`Series.str.find()`](../../reference/api/pandas.Series.str.find.html#pandas.Series.str.find
    "pandas.Series.str.find") method. `find` searches for the first position of the
    substring. If the substring is found, the method returns its position. If not
    found, it returns `-1`. Keep in mind that Python indexes are zero-based.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用[`Series.str.find()`](../../reference/api/pandas.Series.str.find.html#pandas.Series.str.find
    "pandas.Series.str.find")方法在字符串列中查找字符的位置。`find`搜索子字符串的第一个位置。如果找到子字符串，则该方法返回其位置。如果未找到，则返回`-1`。请记住，Python索引是从零开始的。
- en: '[PRE21]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Extracting substring by position
  id: totrans-122
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 根据位置提取子串
- en: 'Spreadsheets have a [MID](https://support.microsoft.com/en-us/office/mid-midb-functions-d5f9e25c-d7d6-472e-b568-4ecb12433028)
    formula for extracting a substring from a given position. To get the first character:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 电子表格中有一个[MID](https://support.microsoft.com/en-us/office/mid-midb-functions-d5f9e25c-d7d6-472e-b568-4ecb12433028)公式，用于从给定位置提取子串。要获取第一个字符：
- en: '[PRE22]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: With pandas you can use `[]` notation to extract a substring from a string by
    position locations. Keep in mind that Python indexes are zero-based.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 使用pandas，您可以使用`[]`符号根据位置提取字符串中的子串。请记住，Python索引是从零开始的。
- en: '[PRE23]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Extracting nth word
  id: totrans-127
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提取第n个单词
- en: In Excel, you might use the [Text to Columns Wizard](https://support.microsoft.com/en-us/office/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7)
    for splitting text and retrieving a specific column. (Note [it’s possible to do
    so through a formula as well](https://exceljet.net/formula/extract-nth-word-from-text-string).)
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Excel 中，您可能会使用[文本分列向导](https://support.microsoft.com/en-us/office/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7)来拆分文本并检索特定列。（注意[也可以通过公式来实现](https://exceljet.net/formula/extract-nth-word-from-text-string)。）
- en: The simplest way to extract words in pandas is to split the strings by spaces,
    then reference the word by index. Note there are more powerful approaches should
    you need them.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中提取单词的最简单方法是通过空格拆分字符串，然后按索引引用单词。注意，如果需要的话，还有更强大的方法。
- en: '[PRE24]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Changing case
  id: totrans-131
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 更改大小写
- en: Spreadsheets provide [UPPER, LOWER, and PROPER functions](https://support.microsoft.com/en-us/office/change-the-case-of-text-01481046-0fa7-4f3b-a693-496795a7a44d)
    for converting text to upper, lower, and title case, respectively.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 电子表格提供[UPPER、LOWER 和 PROPER 函数](https://support.microsoft.com/en-us/office/change-the-case-of-text-01481046-0fa7-4f3b-a693-496795a7a44d)，分别用于将文本转换为大写、小写和首字母大写。
- en: The equivalent pandas methods are [`Series.str.upper()`](../../reference/api/pandas.Series.str.upper.html#pandas.Series.str.upper
    "pandas.Series.str.upper"), [`Series.str.lower()`](../../reference/api/pandas.Series.str.lower.html#pandas.Series.str.lower
    "pandas.Series.str.lower"), and [`Series.str.title()`](../../reference/api/pandas.Series.str.title.html#pandas.Series.str.title
    "pandas.Series.str.title").
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 等效的 pandas 方法分别是[`Series.str.upper()`](../../reference/api/pandas.Series.str.upper.html#pandas.Series.str.upper
    "pandas.Series.str.upper")、[`Series.str.lower()`](../../reference/api/pandas.Series.str.lower.html#pandas.Series.str.lower
    "pandas.Series.str.lower") 和[`Series.str.title()`](../../reference/api/pandas.Series.str.title.html#pandas.Series.str.title
    "pandas.Series.str.title")。
- en: '[PRE25]'
  id: totrans-134
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Merging
  id: totrans-135
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 合并
- en: 'The following tables will be used in the merge examples:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 下面的表将用于合并示例：
- en: '[PRE26]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: In Excel, there are [merging of tables can be done through a VLOOKUP](https://support.microsoft.com/en-us/office/how-can-i-merge-two-or-more-tables-c80a9fce-c1ab-4425-bb96-497dd906d656).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Excel 中，[可以通过 VLOOKUP 合并表格](https://support.microsoft.com/en-us/office/how-can-i-merge-two-or-more-tables-c80a9fce-c1ab-4425-bb96-497dd906d656)。
- en: '![Screenshot showing a VLOOKUP formula between two tables in Excel, with some
    values being filled in and others with "#N/A"](../Images/45b212b0b5aad19471118c664f8faa1d.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![显示 Excel 中两个表格之间 VLOOKUP 公式的截图，其中一些值已填充，而其他值显示为“#N/A”](../Images/45b212b0b5aad19471118c664f8faa1d.png)'
- en: pandas DataFrames have a [`merge()`](../../reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge
    "pandas.DataFrame.merge") method, which provides similar functionality. The data
    does not have to be sorted ahead of time, and different join types are accomplished
    via the `how` keyword.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: pandas 数据帧有一个[`merge()`](../../reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge
    "pandas.DataFrame.merge")方法，提供类似的功能。数据不需要提前排序，并且不同的连接类型通过`how`关键字实现。
- en: '[PRE27]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '`merge` has a number of advantages over `VLOOKUP`:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: '`merge`相对于`VLOOKUP`有一些优势：'
- en: The lookup value doesn’t need to be the first column of the lookup table
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 查找值不需要是查找表的第一列
- en: If multiple rows are matched, there will be one row for each match, instead
    of just the first
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果匹配了多行，则每个匹配都会有一行，而不仅仅是第一个
- en: It will include all columns from the lookup table, instead of just a single
    specified column
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它将包括查找表中的所有列，而不仅仅是单个指定的列
- en: It supports [more complex join operations](../../user_guide/merging.html#merging-join)
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它支持[更复杂的连接操作](../../user_guide/merging.html#merging-join)
- en: Other considerations
  id: totrans-147
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 其他考虑事项
- en: Fill Handle
  id: totrans-148
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 填充手柄
- en: Create a series of numbers following a set pattern in a certain set of cells.
    In a spreadsheet, this would be done by shift+drag after entering the first number
    or by entering the first two or three values and then dragging.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 在一定的一系列单元格中创建一个遵循特定模式的数字序列。在电子表格中，这可以通过输入第一个数字后按住 Shift+拖动，或者输入前两个或三个值然后拖动来完成。
- en: This can be achieved by creating a series and assigning it to the desired cells.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 这可以通过创建一个系列并将其分配给所需的单元格来实现。
- en: '[PRE28]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Drop Duplicates
  id: totrans-152
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 删除重复项
- en: Excel has built-in functionality for [removing duplicate values](https://support.microsoft.com/en-us/office/find-and-remove-duplicates-00e35bea-b46a-4d5d-b28e-66a552dc138d).
    This is supported in pandas via [`drop_duplicates()`](../../reference/api/pandas.DataFrame.drop_duplicates.html#pandas.DataFrame.drop_duplicates
    "pandas.DataFrame.drop_duplicates").
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: Excel内置功能可用于[删除重复值](https://support.microsoft.com/en-us/office/find-and-remove-duplicates-00e35bea-b46a-4d5d-b28e-66a552dc138d)。在
    pandas 中通过 [`drop_duplicates()`](../../reference/api/pandas.DataFrame.drop_duplicates.html#pandas.DataFrame.drop_duplicates
    "pandas.DataFrame.drop_duplicates") 支持此功能。
- en: '[PRE29]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Pivot Tables
  id: totrans-155
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 透视表
- en: '[PivotTables](https://support.microsoft.com/en-us/office/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576)
    from spreadsheets can be replicated in pandas through [Reshaping and pivot tables](../../user_guide/reshaping.html#reshaping).
    Using the `tips` dataset again, let’s find the average gratuity by size of the
    party and sex of the server.'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '[电子表格的数据透视表](https://support.microsoft.com/en-us/office/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576)可以通过
    [数据重塑和数据透视表](../../user_guide/reshaping.html#reshaping) 在 pandas 中复制。再次使用 `tips`
    数据集，让我们找到按照客人数量和服务员性别的平均小费。'
- en: 'In Excel, we use the following configuration for the PivotTable:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Excel 中，我们使用以下配置进行数据透视表：
- en: '![Screenshot showing a PivotTable in Excel, using sex as the column, size as
    the rows, then average tip as the values](../Images/a75631a6c79429bb08cae93014856707.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示 Excel 中的数据透视表，使用性别作为列，大小作为行，然后平均小费作为值](../Images/a75631a6c79429bb08cae93014856707.png)'
- en: 'The equivalent in pandas:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: pandas 中的等价物：
- en: '[PRE30]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: Adding a row
  id: totrans-161
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 添加一行
- en: Assuming we are using a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") (numbered `0`, `1`, etc.), we can use [`concat()`](../../reference/api/pandas.concat.html#pandas.concat
    "pandas.concat") to add a row to the bottom of a `DataFrame`.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们使用的是 [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex")（编号为 `0`、`1` 等），我们可以使用 [`concat()`](../../reference/api/pandas.concat.html#pandas.concat
    "pandas.concat") 将一行添加到 `DataFrame` 的底部。
- en: '[PRE31]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: Find and Replace
  id: totrans-164
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 查找和替换
- en: '[Excel’s Find dialog](https://support.microsoft.com/en-us/office/find-or-replace-text-and-numbers-on-a-worksheet-0e304ca5-ecef-4808-b90f-fdb42f892e90)
    takes you to cells that match, one by one. In pandas, this operation is generally
    done for an entire column or `DataFrame` at once through [conditional expressions](../intro_tutorials/03_subset_data.html#min-tut-03-subset-rows-and-columns).'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '[Excel 的查找对话框](https://support.microsoft.com/en-us/office/find-or-replace-text-and-numbers-on-a-worksheet-0e304ca5-ecef-4808-b90f-fdb42f892e90)将逐个匹配的单元格显示出来。在
    pandas 中，此操作通常针对整个列或 `DataFrame` 一次性进行，通过 [条件表达式](../intro_tutorials/03_subset_data.html#min-tut-03-subset-rows-and-columns)。'
- en: '[PRE32]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: pandas’ [`replace()`](../../reference/api/pandas.DataFrame.replace.html#pandas.DataFrame.replace
    "pandas.DataFrame.replace") is comparable to Excel’s `Replace All`.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: pandas 的 [`replace()`](../../reference/api/pandas.DataFrame.replace.html#pandas.DataFrame.replace
    "pandas.DataFrame.replace") 类似于 Excel 的 `全部替换`。
- en: '[PRE33]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Data structures
  id: totrans-169
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据结构
- en: General terminology translation
  id: totrans-170
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 一般术语翻译
- en: '| pandas | Excel |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| pandas | Excel |'
- en: '| --- | --- |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `DataFrame` | worksheet |'
  id: totrans-173
  prefs: []
  type: TYPE_TB
  zh: '| `DataFrame` | 工作表 |'
- en: '| `Series` | column |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| `Series` | 列 |'
- en: '| `Index` | row headings |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| `Index` | 行标题 |'
- en: '| row | row |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| 行 | 行 |'
- en: '| `NaN` | empty cell |'
  id: totrans-177
  prefs: []
  type: TYPE_TB
  zh: '| `NaN` | 空单元格 |'
- en: '`DataFrame`'
  id: totrans-178
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`DataFrame`'
- en: A `DataFrame` in pandas is analogous to an Excel worksheet. While an Excel workbook
    can contain multiple worksheets, pandas `DataFrame`s exist independently.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，`DataFrame` 类似于 Excel 的工作表。虽然 Excel 工作簿可以包含多个工作表，但 pandas 的 `DataFrame`
    是独立存在的。
- en: '`Series`'
  id: totrans-180
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Series`'
- en: A `Series` is the data structure that represents one column of a `DataFrame`.
    Working with a `Series` is analogous to referencing a column of a spreadsheet.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '`Series` 是代表 `DataFrame` 的一列的数据结构。与处理电子表格的列类似，处理 `Series`。'
- en: '`Index`'
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Index`'
- en: Every `DataFrame` and `Series` has an `Index`, which are labels on the *rows*
    of the data. In pandas, if no index is specified, a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") is used by default (first row = 0, second row = 1, and so
    on), analogous to row headings/numbers in spreadsheets.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 每个 `DataFrame` 和 `Series` 都有一个 `Index`，这些是数据的 *行* 上的标签。在 pandas 中，如果没有指定索引，则默认使用
    [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex "pandas.RangeIndex")（第一行
    = 0，第二行 = 1，依此类推），类似于电子表格中的行标题/行号。
- en: In pandas, indexes can be set to one (or multiple) unique values, which is like
    having a column that is used as the row identifier in a worksheet. Unlike most
    spreadsheets, these `Index` values can actually be used to reference the rows.
    (Note that [this can be done in Excel with structured references](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e).)
    For example, in spreadsheets, you would reference the first row as `A1:Z1`, while
    in pandas you could use `populations.loc['Chicago']`.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，索引可以设置为一个（或多个）唯一值，这类似于在工作表中使用作为行标识符的列。与大多数电子表格不同，这些`Index`值实际上可以用于引用行。
    （请注意，[Excel 中可以使用结构化引用](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e)执行此操作。）例如，在电子表格中，您可以引用第一行为`A1:Z1`，而在
    pandas 中，您可以使用`populations.loc['Chicago']`。
- en: Index values are also persistent, so if you re-order the rows in a `DataFrame`,
    the label for a particular row don’t change.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 索引值也是持久的，因此如果重新排序`DataFrame`的行，则特定行的标签不会更改。
- en: See the [indexing documentation](../../user_guide/indexing.html#indexing) for
    much more on how to use an `Index` effectively.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 查看 [索引文档](../../user_guide/indexing.html#indexing)以获取更多关于如何有效使用`Index`的信息。
- en: Copies vs. in place operations
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 副本 vs. 原地操作
- en: 'Most pandas operations return copies of the `Series`/`DataFrame`. To make the
    changes “stick”, you’ll need to either assign to a new variable:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数 pandas 操作都返回`Series`/`DataFrame`的副本。要使更改“生效”，您需要将其分配给一个新变量：
- en: '[PRE34]'
  id: totrans-189
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'or overwrite the original one:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 或覆盖原始的：
- en: '[PRE35]'
  id: totrans-191
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE35]'
- en: Note
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'You will see an `inplace=True` or `copy=False` keyword argument available for
    some methods:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某些方法，您会看到一个可用的`inplace=True`或`copy=False`关键字参数：
- en: '[PRE36]'
  id: totrans-194
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: There is an active discussion about deprecating and removing `inplace` and `copy`
    for most methods (e.g. `dropna`) except for a very small subset of methods (including
    `replace`). Both keywords won’t be necessary anymore in the context of Copy-on-Write.
    The proposal can be found [here](https://github.com/pandas-dev/pandas/pull/51466).
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 关于大多数方法（例如`dropna`）的逐步弃用和移除`inplace`和`copy`存在活跃讨论，除了极少数方法（包括`replace`）。在写时复制的情况下，这两个关键字将不再需要。提案可以在[这里](https://github.com/pandas-dev/pandas/pull/51466)找到。
- en: General terminology translation
  id: totrans-196
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 一般术语翻译
- en: '| pandas | Excel |'
  id: totrans-197
  prefs: []
  type: TYPE_TB
  zh: '| pandas | Excel |'
- en: '| --- | --- |'
  id: totrans-198
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `DataFrame` | worksheet |'
  id: totrans-199
  prefs: []
  type: TYPE_TB
  zh: '| `DataFrame` | 工作表 |'
- en: '| `Series` | column |'
  id: totrans-200
  prefs: []
  type: TYPE_TB
  zh: '| `Series` | 列 |'
- en: '| `Index` | row headings |'
  id: totrans-201
  prefs: []
  type: TYPE_TB
  zh: '| `Index` | 行标题 |'
- en: '| row | row |'
  id: totrans-202
  prefs: []
  type: TYPE_TB
  zh: '| 行 | 行 |'
- en: '| `NaN` | empty cell |'
  id: totrans-203
  prefs: []
  type: TYPE_TB
  zh: '| `NaN` | 空单元格 |'
- en: '`DataFrame`'
  id: totrans-204
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`DataFrame`'
- en: A `DataFrame` in pandas is analogous to an Excel worksheet. While an Excel workbook
    can contain multiple worksheets, pandas `DataFrame`s exist independently.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，`DataFrame` 类似于 Excel 中的工作表。虽然 Excel 工作簿可以包含多个工作表，但 pandas 的`DataFrame`存在独立于此。
- en: '`Series`'
  id: totrans-206
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Series`'
- en: A `Series` is the data structure that represents one column of a `DataFrame`.
    Working with a `Series` is analogous to referencing a column of a spreadsheet.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: '`Series` 是表示`DataFrame`的一列的数据结构。与引用电子表格列类似，与`Series`一起工作。'
- en: '`Index`'
  id: totrans-208
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '`Index`'
- en: Every `DataFrame` and `Series` has an `Index`, which are labels on the *rows*
    of the data. In pandas, if no index is specified, a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") is used by default (first row = 0, second row = 1, and so
    on), analogous to row headings/numbers in spreadsheets.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 每个`DataFrame`和`Series`都有一个`Index`，这些是数据的*行*上的标签。在 pandas 中，如果未指定索引，则默认使用[`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex")（第一行= 0，第二行= 1，依此类推），类似于电子表格中的行标题/数字。
- en: In pandas, indexes can be set to one (or multiple) unique values, which is like
    having a column that is used as the row identifier in a worksheet. Unlike most
    spreadsheets, these `Index` values can actually be used to reference the rows.
    (Note that [this can be done in Excel with structured references](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e).)
    For example, in spreadsheets, you would reference the first row as `A1:Z1`, while
    in pandas you could use `populations.loc['Chicago']`.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 在 pandas 中，索引可以设置为一个（或多个）唯一值，这类似于在工作表中使用作为行标识符的列。与大多数电子表格不同，这些`Index`值实际上可以用于引用行。
    （请注意，[Excel 中可以使用结构化引用](https://support.microsoft.com/en-us/office/using-structured-references-with-excel-tables-f5ed2452-2337-4f71-bed3-c8ae6d2b276e)执行此操作。）例如，在电子表格中，您可以引用第一行为`A1:Z1`，而在
    pandas 中，您可以使用`populations.loc['Chicago']`。
- en: Index values are also persistent, so if you re-order the rows in a `DataFrame`,
    the label for a particular row don’t change.
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 索引值也是持久的，因此如果重新排列`DataFrame`中的行，则特定行的标签不会更改。
- en: See the [indexing documentation](../../user_guide/indexing.html#indexing) for
    much more on how to use an `Index` effectively.
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 查看[索引文档](../../user_guide/indexing.html#indexing)以了解如何有效地使用`Index`。
- en: Copies vs. in place operations
  id: totrans-213
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 复制与原地操作
- en: 'Most pandas operations return copies of the `Series`/`DataFrame`. To make the
    changes “stick”, you’ll need to either assign to a new variable:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 大多数pandas操作返回`Series`/`DataFrame`的副本。要使更改“生效”，您需要将其分配给一个新变量：
- en: '[PRE37]'
  id: totrans-215
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'or overwrite the original one:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 或覆盖原始数据：
- en: '[PRE38]'
  id: totrans-217
  prefs:
  - PREF_BQ
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Note
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 注意
- en: 'You will see an `inplace=True` or `copy=False` keyword argument available for
    some methods:'
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: 您将看到一些方法可用的`inplace=True`或`copy=False`关键字参数：
- en: '[PRE39]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: There is an active discussion about deprecating and removing `inplace` and `copy`
    for most methods (e.g. `dropna`) except for a very small subset of methods (including
    `replace`). Both keywords won’t be necessary anymore in the context of Copy-on-Write.
    The proposal can be found [here](https://github.com/pandas-dev/pandas/pull/51466).
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 关于在大多数方法（例如`dropna`）中弃用和删除`inplace`和`copy`的讨论正在进行中，除了一小部分方法（包括`replace`）。在Copy-on-Write的上下文中，这两个关键字将不再是必需的。提案可以在[这里](https://github.com/pandas-dev/pandas/pull/51466)找到。
- en: Data input / output
  id: totrans-222
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据输入/输出
- en: Constructing a DataFrame from values
  id: totrans-223
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从值构建DataFrame
- en: In a spreadsheet, [values can be typed directly into cells](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038).
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，[可以直接在单元格中输入值](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038)。
- en: A pandas `DataFrame` can be constructed in many different ways, but for a small
    number of values, it is often convenient to specify it as a Python dictionary,
    where the keys are the column names and the values are the data.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
  zh: pandas的`DataFrame`可以以许多不同的方式构建，但对于少量值来说，通常将其指定为Python字典是方便的，其中键是列名，值是数据。
- en: '[PRE40]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: Reading external data
  id: totrans-227
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 读取外部数据
- en: Both [Excel](https://support.microsoft.com/en-us/office/import-data-from-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a)
    and [pandas](../intro_tutorials/02_read_write.html#min-tut-02-read-write) can
    import data from various sources in various formats.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
  zh: Excel和pandas都可以从各种来源以各种格式导入数据。
- en: CSV
  id: totrans-229
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: CSV
- en: 'Let’s load and display the [tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)
    dataset from the pandas tests, which is a CSV file. In Excel, you would download
    and then [open the CSV](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba).
    In pandas, you pass the URL or local path of the CSV file to [`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv"):'
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们加载并显示来自pandas测试的[tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)数据集，这是一个CSV文件。在Excel中，您将下载然后[打开CSV文件](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba)。在pandas中，您将URL或CSV文件的本地路径传递给[`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv")：
- en: '[PRE41]'
  id: totrans-231
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'Like [Excel’s Text Import Wizard](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857),
    `read_csv` can take a number of parameters to specify how the data should be parsed.
    For example, if the data was instead tab delimited, and did not have column names,
    the pandas command would be:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 像[Excel的文本导入向导](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857)一样，`read_csv`可以接受多个参数来指定数据应该如何解析。例如，如果数据是制表符分隔的，并且没有列名，那么pandas命令将是：
- en: '[PRE42]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: Excel files
  id: totrans-234
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: Excel文件
- en: Excel opens [various Excel file formats](https://support.microsoft.com/en-us/office/file-formats-that-are-supported-in-excel-0943ff2c-6014-4e8d-aaea-b83d51d46247)
    by double-clicking them, or using [the Open menu](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176).
    In pandas, you use [special methods for reading and writing from/to Excel files](../../user_guide/io.html#io-excel).
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: Excel通过双击或使用[打开菜单](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176)打开各种Excel文件格式。在pandas中，您可以使用[特殊方法来读取和写入Excel文件](../../user_guide/io.html#io-excel)。
- en: 'Let’s first [create a new Excel file](../../user_guide/io.html#io-excel-writer)
    based on the `tips` dataframe in the above example:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先根据上面示例中的`tips`数据框[创建一个新的Excel文件](../../user_guide/io.html#io-excel-writer)：
- en: '[PRE43]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Should you wish to subsequently access the data in the `tips.xlsx` file, you
    can read it into your module using
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您希望随后访问`tips.xlsx`文件中的数据，可以使用以下方式将其读入模块中
- en: '[PRE44]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: You have just read in an Excel file using pandas!
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: 您刚刚使用pandas读取了一个Excel文件！
- en: Limiting output
  id: totrans-241
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 限制输出
- en: Spreadsheet programs will only show one screenful of data at a time and then
    allow you to scroll, so there isn’t really a need to limit output. In pandas,
    you’ll need to put a little more thought into controlling how your `DataFrame`s
    are displayed.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
  zh: 电子表格程序一次只会显示一个屏幕的数据，然后允许您滚动，因此实际上没有必要限制输出。在pandas中，您需要更多地考虑如何控制您的`DataFrame`的显示方式。
- en: By default, pandas will truncate output of large `DataFrame`s to show the first
    and last rows. This can be overridden by [changing the pandas options](../../user_guide/options.html#options),
    or using [`DataFrame.head()`](../../reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head
    "pandas.DataFrame.head") or [`DataFrame.tail()`](../../reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail
    "pandas.DataFrame.tail").
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，pandas会截断大型`DataFrame`的输出以显示第一行和最后一行。这可以通过[更改pandas选项](../../user_guide/options.html#options)，或使用[`DataFrame.head()`](../../reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head
    "pandas.DataFrame.head")或[`DataFrame.tail()`](../../reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail
    "pandas.DataFrame.tail")来覆盖。
- en: '[PRE45]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Exporting data
  id: totrans-245
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 导出数据
- en: By default, desktop spreadsheet software will save to its respective file format
    (`.xlsx`, `.ods`, etc). You can, however, [save to other file formats](https://support.microsoft.com/en-us/office/save-a-workbook-in-another-file-format-6a16c862-4a36-48f9-a300-c2ca0065286e).
  id: totrans-246
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，桌面电子表格软件将保存为其相应的文件格式（`.xlsx`，`.ods`等）。但是，您可以[保存为其他文件格式](https://support.microsoft.com/en-us/office/save-a-workbook-in-another-file-format-6a16c862-4a36-48f9-a300-c2ca0065286e)。
- en: '[pandas can create Excel files](../../user_guide/io.html#io-excel-writer),
    [CSV](../../user_guide/io.html#io-store-in-csv), or [a number of other formats](../../user_guide/io.html#io).'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: '[pandas可以创建Excel文件](../../user_guide/io.html#io-excel-writer)，[CSV](../../user_guide/io.html#io-store-in-csv)，或者[其他多种格式](../../user_guide/io.html#io)。'
- en: Constructing a DataFrame from values
  id: totrans-248
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 从值构建DataFrame
- en: In a spreadsheet, [values can be typed directly into cells](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038).
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，[可以直接在单元格中输入值](https://support.microsoft.com/en-us/office/enter-data-manually-in-worksheet-cells-c798181d-d75a-41b1-92ad-6c0800f80038)。
- en: A pandas `DataFrame` can be constructed in many different ways, but for a small
    number of values, it is often convenient to specify it as a Python dictionary,
    where the keys are the column names and the values are the data.
  id: totrans-250
  prefs: []
  type: TYPE_NORMAL
  zh: 可以以许多不同的方式构建pandas `DataFrame`，但对于少量值，通常将其指定为Python字典是方便的，其中键是列名，值是数据。
- en: '[PRE46]'
  id: totrans-251
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: Reading external data
  id: totrans-252
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 读取外部数据
- en: Both [Excel](https://support.microsoft.com/en-us/office/import-data-from-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a)
    and [pandas](../intro_tutorials/02_read_write.html#min-tut-02-read-write) can
    import data from various sources in various formats.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: '[Excel](https://support.microsoft.com/en-us/office/import-data-from-data-sources-power-query-be4330b3-5356-486c-a168-b68e9e616f5a)和[pandas](../intro_tutorials/02_read_write.html#min-tut-02-read-write)都可以从各种来源以各种格式导入数据。'
- en: CSV
  id: totrans-254
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: CSV
- en: 'Let’s load and display the [tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)
    dataset from the pandas tests, which is a CSV file. In Excel, you would download
    and then [open the CSV](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba).
    In pandas, you pass the URL or local path of the CSV file to [`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv"):'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们加载并显示来自pandas测试的[tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)数据集，这是一个CSV文件。在Excel中，您将下载然后[打开CSV文件](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba)。在pandas中，您将CSV文件的URL或本地路径传递给[`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv")：
- en: '[PRE47]'
  id: totrans-256
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: 'Like [Excel’s Text Import Wizard](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857),
    `read_csv` can take a number of parameters to specify how the data should be parsed.
    For example, if the data was instead tab delimited, and did not have column names,
    the pandas command would be:'
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE48]'
  id: totrans-258
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: Excel files
  id: totrans-259
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Excel opens [various Excel file formats](https://support.microsoft.com/en-us/office/file-formats-that-are-supported-in-excel-0943ff2c-6014-4e8d-aaea-b83d51d46247)
    by double-clicking them, or using [the Open menu](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176).
    In pandas, you use [special methods for reading and writing from/to Excel files](../../user_guide/io.html#io-excel).
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s first [create a new Excel file](../../user_guide/io.html#io-excel-writer)
    based on the `tips` dataframe in the above example:'
  id: totrans-261
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]'
  id: totrans-262
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Should you wish to subsequently access the data in the `tips.xlsx` file, you
    can read it into your module using
  id: totrans-263
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  id: totrans-264
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: You have just read in an Excel file using pandas!
  id: totrans-265
  prefs: []
  type: TYPE_NORMAL
- en: CSV
  id: totrans-266
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'Let’s load and display the [tips](https://github.com/pandas-dev/pandas/blob/main/pandas/tests/io/data/csv/tips.csv)
    dataset from the pandas tests, which is a CSV file. In Excel, you would download
    and then [open the CSV](https://support.microsoft.com/en-us/office/import-or-export-text-txt-or-csv-files-5250ac4c-663c-47ce-937b-339e391393ba).
    In pandas, you pass the URL or local path of the CSV file to [`read_csv()`](../../reference/api/pandas.read_csv.html#pandas.read_csv
    "pandas.read_csv"):'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  id: totrans-268
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'Like [Excel’s Text Import Wizard](https://support.microsoft.com/en-us/office/text-import-wizard-c5b02af6-fda1-4440-899f-f78bafe41857),
    `read_csv` can take a number of parameters to specify how the data should be parsed.
    For example, if the data was instead tab delimited, and did not have column names,
    the pandas command would be:'
  id: totrans-269
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  id: totrans-270
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: Excel files
  id: totrans-271
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Excel opens [various Excel file formats](https://support.microsoft.com/en-us/office/file-formats-that-are-supported-in-excel-0943ff2c-6014-4e8d-aaea-b83d51d46247)
    by double-clicking them, or using [the Open menu](https://support.microsoft.com/en-us/office/open-files-from-the-file-menu-97f087d8-3136-4485-8e86-c5b12a8c4176).
    In pandas, you use [special methods for reading and writing from/to Excel files](../../user_guide/io.html#io-excel).
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s first [create a new Excel file](../../user_guide/io.html#io-excel-writer)
    based on the `tips` dataframe in the above example:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Should you wish to subsequently access the data in the `tips.xlsx` file, you
    can read it into your module using
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  id: totrans-276
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: You have just read in an Excel file using pandas!
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: Limiting output
  id: totrans-278
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Spreadsheet programs will only show one screenful of data at a time and then
    allow you to scroll, so there isn’t really a need to limit output. In pandas,
    you’ll need to put a little more thought into controlling how your `DataFrame`s
    are displayed.
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: By default, pandas will truncate output of large `DataFrame`s to show the first
    and last rows. This can be overridden by [changing the pandas options](../../user_guide/options.html#options),
    or using [`DataFrame.head()`](../../reference/api/pandas.DataFrame.head.html#pandas.DataFrame.head
    "pandas.DataFrame.head") or [`DataFrame.tail()`](../../reference/api/pandas.DataFrame.tail.html#pandas.DataFrame.tail
    "pandas.DataFrame.tail").
  id: totrans-280
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE55]'
  id: totrans-281
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Exporting data
  id: totrans-282
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: By default, desktop spreadsheet software will save to its respective file format
    (`.xlsx`, `.ods`, etc). You can, however, [save to other file formats](https://support.microsoft.com/en-us/office/save-a-workbook-in-another-file-format-6a16c862-4a36-48f9-a300-c2ca0065286e).
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
- en: '[pandas can create Excel files](../../user_guide/io.html#io-excel-writer),
    [CSV](../../user_guide/io.html#io-store-in-csv), or [a number of other formats](../../user_guide/io.html#io).'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
- en: Data operations
  id: totrans-285
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Operations on columns
  id: totrans-286
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In spreadsheets, [formulas](https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173)
    are often created in individual cells and then [dragged](https://support.microsoft.com/en-us/office/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218)
    into other cells to compute them for other columns. In pandas, you’re able to
    do operations on whole columns directly.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
- en: pandas provides vectorized operations by specifying the individual `Series`
    in the `DataFrame`. New columns can be assigned in the same way. The [`DataFrame.drop()`](../../reference/api/pandas.DataFrame.drop.html#pandas.DataFrame.drop
    "pandas.DataFrame.drop") method drops a column from the `DataFrame`.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  id: totrans-289
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: Note that we aren’t having to tell it to do that subtraction cell-by-cell —
    pandas handles that for us. See [how to create new columns derived from existing
    columns](../intro_tutorials/05_add_columns.html#min-tut-05-columns).
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
- en: Filtering
  id: totrans-291
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[In Excel, filtering is done through a graphical menu.](https://support.microsoft.com/en-us/office/filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e)'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing filtering of the total_bill column to values greater than
    10](../Images/504670cee47d6136c9bd2d70afce698f.png)'
  id: totrans-293
  prefs: []
  type: TYPE_IMG
- en: DataFrames can be filtered in multiple ways; the most intuitive of which is
    using [boolean indexing](../../user_guide/indexing.html#indexing-boolean).
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  id: totrans-295
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: The above statement is simply passing a `Series` of `True`/`False` objects to
    the DataFrame, returning all rows with `True`.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE58]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: If/then logic
  id: totrans-298
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Let’s say we want to make a `bucket` column with values of `low` and `high`,
    based on whether the `total_bill` is less or more than $10.
  id: totrans-299
  prefs: []
  type: TYPE_NORMAL
- en: In spreadsheets, logical comparison can be done with [conditional formulas](https://support.microsoft.com/en-us/office/create-conditional-formulas-ca916c57-abd8-4b44-997c-c309b7307831).
    We’d use a formula of `=IF(A2 < 10, "low", "high")`, dragged to all cells in a
    new `bucket` column.
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing the formula from above in a bucket column of the tips
    spreadsheet](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
  id: totrans-301
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示上述公式在小费电子表格的桶列中](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
- en: The same operation in pandas can be accomplished using the `where` method from
    `numpy`.
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 在pandas中，可以使用`numpy`中的`where`方法来完成相同的操作。
- en: '[PRE59]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: Date functionality
  id: totrans-304
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 日期功能
- en: '*This section will refer to “dates”, but timestamps are handled similarly.*'
  id: totrans-305
  prefs: []
  type: TYPE_NORMAL
  zh: '*本节将提到“日期”，但时间戳处理方式类似。*'
- en: 'We can think of date functionality in two parts: parsing, and output. In spreadsheets,
    date values are generally parsed automatically, though there is a [DATEVALUE](https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252)
    function if you need it. In pandas, you need to explicitly convert plain text
    to datetime objects, either [while reading from a CSV](../../user_guide/io.html#io-read-csv-table-datetime)
    or [once in a DataFrame](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties).'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将日期功能分为两部分：解析和输出。在电子表格中，日期值通常会自动解析，尽管如果需要，可以使用[DATEVALUE](https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252)函数。在pandas中，您需要显式地将纯文本转换为datetime对象，可以在[从CSV读取时](../../user_guide/io.html#io-read-csv-table-datetime)或在[DataFrame中](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)进行转换。
- en: Once parsed, spreadsheets display the dates in a default format, though [the
    format can be changed](https://support.microsoft.com/en-us/office/format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e).
    In pandas, you’ll generally want to keep dates as `datetime` objects while you’re
    doing calculations with them. Outputting *parts* of dates (such as the year) is
    done through [date functions](https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81)
    in spreadsheets, and [datetime properties](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)
    in pandas.
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
  zh: 解析后，电子表格以默认格式显示日期，尽管[格式可以更改](https://support.microsoft.com/en-us/office/format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e)。在pandas中，您通常希望在进行计算时将日期保留为`datetime`对象。在电子表格中，通过[日期函数](https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81)和在pandas中通过[datetime属性](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)来输出日期的*部分*（如年份）。
- en: 'Given `date1` and `date2` in columns `A` and `B` of a spreadsheet, you might
    have these formulas:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格的列`A`和`B`中给定`date1`和`date2`，您可能会有以下公式：
- en: '| column | formula |'
  id: totrans-309
  prefs: []
  type: TYPE_TB
  zh: '| 列名 | 公式 |'
- en: '| --- | --- |'
  id: totrans-310
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `date1_year` | `=YEAR(A2)` |'
  id: totrans-311
  prefs: []
  type: TYPE_TB
  zh: '| `date1_year` | `=YEAR(A2)` |'
- en: '| `date2_month` | `=MONTH(B2)` |'
  id: totrans-312
  prefs: []
  type: TYPE_TB
  zh: '| `date2_month` | `=MONTH(B2)` |'
- en: '| `date1_next` | `=DATE(YEAR(A2),MONTH(A2)+1,1)` |'
  id: totrans-313
  prefs: []
  type: TYPE_TB
  zh: '| `date1_next` | `=DATE(YEAR(A2),MONTH(A2)+1,1)` |'
- en: '| `months_between` | `=DATEDIF(A2,B2,"M")` |'
  id: totrans-314
  prefs: []
  type: TYPE_TB
  zh: '| `months_between` | `=DATEDIF(A2,B2,"M")` |'
- en: The equivalent pandas operations are shown below.
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
  zh: 下面显示了等效的pandas操作。
- en: '[PRE60]'
  id: totrans-316
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: See [Time series / date functionality](../../user_guide/timeseries.html#timeseries)
    for more details.
  id: totrans-317
  prefs: []
  type: TYPE_NORMAL
  zh: 更多详细信息，请参阅[时间序列/日期功能](../../user_guide/timeseries.html#timeseries)。
- en: Selection of columns
  id: totrans-318
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 选择列
- en: 'In spreadsheets, you can select columns you want by:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，您可以通过以下方式选择所需的列：
- en: '[Hiding columns](https://support.microsoft.com/en-us/office/hide-or-show-rows-or-columns-659c2cad-802e-44ee-a614-dde8443579f8)'
  id: totrans-320
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[隐藏列](https://support.microsoft.com/en-us/office/hide-or-show-rows-or-columns-659c2cad-802e-44ee-a614-dde8443579f8)'
- en: '[Deleting columns](https://support.microsoft.com/en-us/office/insert-or-delete-rows-and-columns-6f40e6e4-85af-45e0-b39d-65dd504a3246)'
  id: totrans-321
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[删除列](https://support.microsoft.com/en-us/office/insert-or-delete-rows-and-columns-6f40e6e4-85af-45e0-b39d-65dd504a3246)'
- en: '[Referencing a range](https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa)
    from one worksheet into another'
  id: totrans-322
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从一个工作表引用到另一个工作表的[范围](https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa)
- en: Since spreadsheet columns are typically [named in a header row](https://support.microsoft.com/en-us/office/turn-excel-table-headers-on-or-off-c91d1742-312c-4480-820f-cf4b534c8b3b),
    renaming a column is simply a matter of changing the text in that first cell.
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
  zh: 由于电子表格列通常是在[标题行中命名的](https://support.microsoft.com/en-us/office/turn-excel-table-headers-on-or-off-c91d1742-312c-4480-820f-cf4b534c8b3b)，重命名列只需简单地更改该第一个单元格中的文本。
- en: The same operations are expressed in pandas below.
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 下面展示了pandas中相同的操作。
- en: Keep certain columns
  id: totrans-325
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 保留特定列
- en: '[PRE61]'
  id: totrans-326
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: Drop a column
  id: totrans-327
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 删除一列
- en: '[PRE62]'
  id: totrans-328
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: Rename a column
  id: totrans-329
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 重命名列
- en: '[PRE63]'
  id: totrans-330
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: Sorting by values
  id: totrans-331
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 按值排序
- en: Sorting in spreadsheets is accomplished via [the sort dialog](https://support.microsoft.com/en-us/office/sort-data-in-a-range-or-table-62d0b95d-2a90-4610-a6ae-2e545c4a4654).
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: 电子表格中的排序通过[排序对话框](https://support.microsoft.com/en-us/office/sort-data-in-a-range-or-table-62d0b95d-2a90-4610-a6ae-2e545c4a4654)完成。
- en: '![Screenshot of dialog from Excel showing sorting by the sex then total_bill
    columns](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-333
  prefs: []
  type: TYPE_IMG
  zh: '![Excel中显示按性别然后按total_bill列排序的对话框的屏幕截图](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
- en: pandas has a [`DataFrame.sort_values()`](../../reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values
    "pandas.DataFrame.sort_values") method, which takes a list of columns to sort
    by.
  id: totrans-334
  prefs: []
  type: TYPE_NORMAL
  zh: pandas有一个[`DataFrame.sort_values()`](../../reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values
    "pandas.DataFrame.sort_values")方法，接受一个要排序的列列表。
- en: '[PRE64]'
  id: totrans-335
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: Operations on columns
  id: totrans-336
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 列操作
- en: In spreadsheets, [formulas](https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173)
    are often created in individual cells and then [dragged](https://support.microsoft.com/en-us/office/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218)
    into other cells to compute them for other columns. In pandas, you’re able to
    do operations on whole columns directly.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，[公式](https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173)通常在单独的单元格中创建，然后[拖动](https://support.microsoft.com/en-us/office/copy-a-formula-by-dragging-the-fill-handle-in-excel-for-mac-dd928259-622b-473f-9a33-83aa1a63e218)到其他单元格中以计算其他列的值。在pandas中，您可以直接对整列进行操作。
- en: pandas provides vectorized operations by specifying the individual `Series`
    in the `DataFrame`. New columns can be assigned in the same way. The [`DataFrame.drop()`](../../reference/api/pandas.DataFrame.drop.html#pandas.DataFrame.drop
    "pandas.DataFrame.drop") method drops a column from the `DataFrame`.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
  zh: pandas通过在`DataFrame`中指定单独的`Series`提供矢量化操作。新列可以以相同的方式分配。[`DataFrame.drop()`](../../reference/api/pandas.DataFrame.drop.html#pandas.DataFrame.drop
    "pandas.DataFrame.drop")方法从`DataFrame`中删除列。
- en: '[PRE65]'
  id: totrans-339
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: Note that we aren’t having to tell it to do that subtraction cell-by-cell —
    pandas handles that for us. See [how to create new columns derived from existing
    columns](../intro_tutorials/05_add_columns.html#min-tut-05-columns).
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，我们不需要逐个单元格地告诉它执行减法 - pandas会为我们处理。参见[如何从现有列派生新列](../intro_tutorials/05_add_columns.html#min-tut-05-columns)。
- en: Filtering
  id: totrans-341
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 过滤
- en: '[In Excel, filtering is done through a graphical menu.](https://support.microsoft.com/en-us/office/filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e)'
  id: totrans-342
  prefs: []
  type: TYPE_NORMAL
  zh: '[在Excel中，过滤是通过图形菜单完成的。](https://support.microsoft.com/en-us/office/filter-data-in-a-range-or-table-01832226-31b5-4568-8806-38c37dcc180e)'
- en: '![Screenshot showing filtering of the total_bill column to values greater than
    10](../Images/504670cee47d6136c9bd2d70afce698f.png)'
  id: totrans-343
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示了将total_bill列过滤为大于10的值](../Images/504670cee47d6136c9bd2d70afce698f.png)'
- en: DataFrames can be filtered in multiple ways; the most intuitive of which is
    using [boolean indexing](../../user_guide/indexing.html#indexing-boolean).
  id: totrans-344
  prefs: []
  type: TYPE_NORMAL
  zh: DataFrames可以以多种方式进行过滤；其中最直观的是使用[布尔索引](../../user_guide/indexing.html#indexing-boolean)。
- en: '[PRE66]'
  id: totrans-345
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: The above statement is simply passing a `Series` of `True`/`False` objects to
    the DataFrame, returning all rows with `True`.
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 上述语句只是简单地将`True`/`False`对象的`Series`传递给DataFrame，返回所有具有`True`的行。
- en: '[PRE67]'
  id: totrans-347
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: If/then logic
  id: totrans-348
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: If/then 逻辑
- en: Let’s say we want to make a `bucket` column with values of `low` and `high`,
    based on whether the `total_bill` is less or more than $10.
  id: totrans-349
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们想要根据`total_bill`是低于还是高于$10来创建一个`bucket`列，值为`low`和`high`。
- en: In spreadsheets, logical comparison can be done with [conditional formulas](https://support.microsoft.com/en-us/office/create-conditional-formulas-ca916c57-abd8-4b44-997c-c309b7307831).
    We’d use a formula of `=IF(A2 < 10, "low", "high")`, dragged to all cells in a
    new `bucket` column.
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
  zh: 在电子表格中，可以使用[条件公式](https://support.microsoft.com/en-us/office/create-conditional-formulas-ca916c57-abd8-4b44-997c-c309b7307831)进行逻辑比较。我们会使用一个公式`=IF(A2
    < 10, "low", "high")`，拖动到新的`bucket`列中的所有单元格。
- en: '![Screenshot showing the formula from above in a bucket column of the tips
    spreadsheet](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
  id: totrans-351
  prefs: []
  type: TYPE_IMG
  zh: '![屏幕截图显示了在小费电子表格的桶列中的公式](../Images/763d17cbbee2c4ab3188d987c2b121df.png)'
- en: The same operation in pandas can be accomplished using the `where` method from
    `numpy`.
  id: totrans-352
  prefs: []
  type: TYPE_NORMAL
  zh: 在pandas中，可以使用`numpy`的`where`方法来完成相同的操作。
- en: '[PRE68]'
  id: totrans-353
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: Date functionality
  id: totrans-354
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 日期功能
- en: '*This section will refer to “dates”, but timestamps are handled similarly.*'
  id: totrans-355
  prefs: []
  type: TYPE_NORMAL
  zh: '*本节将涉及“日期”，但时间戳处理方式类似。*'
- en: 'We can think of date functionality in two parts: parsing, and output. In spreadsheets,
    date values are generally parsed automatically, though there is a [DATEVALUE](https://support.microsoft.com/en-us/office/datevalue-function-df8b07d4-7761-4a93-bc33-b7471bbff252)
    function if you need it. In pandas, you need to explicitly convert plain text
    to datetime objects, either [while reading from a CSV](../../user_guide/io.html#io-read-csv-table-datetime)
    or [once in a DataFrame](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties).'
  id: totrans-356
  prefs: []
  type: TYPE_NORMAL
- en: Once parsed, spreadsheets display the dates in a default format, though [the
    format can be changed](https://support.microsoft.com/en-us/office/format-a-date-the-way-you-want-8e10019e-d5d8-47a1-ba95-db95123d273e).
    In pandas, you’ll generally want to keep dates as `datetime` objects while you’re
    doing calculations with them. Outputting *parts* of dates (such as the year) is
    done through [date functions](https://support.microsoft.com/en-us/office/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81)
    in spreadsheets, and [datetime properties](../intro_tutorials/09_timeseries.html#min-tut-09-timeseries-properties)
    in pandas.
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
- en: 'Given `date1` and `date2` in columns `A` and `B` of a spreadsheet, you might
    have these formulas:'
  id: totrans-358
  prefs: []
  type: TYPE_NORMAL
- en: '| column | formula |'
  id: totrans-359
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-360
  prefs: []
  type: TYPE_TB
- en: '| `date1_year` | `=YEAR(A2)` |'
  id: totrans-361
  prefs: []
  type: TYPE_TB
- en: '| `date2_month` | `=MONTH(B2)` |'
  id: totrans-362
  prefs: []
  type: TYPE_TB
- en: '| `date1_next` | `=DATE(YEAR(A2),MONTH(A2)+1,1)` |'
  id: totrans-363
  prefs: []
  type: TYPE_TB
- en: '| `months_between` | `=DATEDIF(A2,B2,"M")` |'
  id: totrans-364
  prefs: []
  type: TYPE_TB
- en: The equivalent pandas operations are shown below.
  id: totrans-365
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE69]'
  id: totrans-366
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: See [Time series / date functionality](../../user_guide/timeseries.html#timeseries)
    for more details.
  id: totrans-367
  prefs: []
  type: TYPE_NORMAL
- en: Selection of columns
  id: totrans-368
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In spreadsheets, you can select columns you want by:'
  id: totrans-369
  prefs: []
  type: TYPE_NORMAL
- en: '[Hiding columns](https://support.microsoft.com/en-us/office/hide-or-show-rows-or-columns-659c2cad-802e-44ee-a614-dde8443579f8)'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Deleting columns](https://support.microsoft.com/en-us/office/insert-or-delete-rows-and-columns-6f40e6e4-85af-45e0-b39d-65dd504a3246)'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Referencing a range](https://support.microsoft.com/en-us/office/create-or-change-a-cell-reference-c7b8b95d-c594-4488-947e-c835903cebaa)
    from one worksheet into another'
  id: totrans-372
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Since spreadsheet columns are typically [named in a header row](https://support.microsoft.com/en-us/office/turn-excel-table-headers-on-or-off-c91d1742-312c-4480-820f-cf4b534c8b3b),
    renaming a column is simply a matter of changing the text in that first cell.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
- en: The same operations are expressed in pandas below.
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
- en: Keep certain columns
  id: totrans-375
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE70]'
  id: totrans-376
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: Drop a column
  id: totrans-377
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE71]'
  id: totrans-378
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: Rename a column
  id: totrans-379
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE72]'
  id: totrans-380
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: Keep certain columns
  id: totrans-381
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE73]'
  id: totrans-382
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: Drop a column
  id: totrans-383
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE74]'
  id: totrans-384
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: Rename a column
  id: totrans-385
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '[PRE75]'
  id: totrans-386
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: Sorting by values
  id: totrans-387
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Sorting in spreadsheets is accomplished via [the sort dialog](https://support.microsoft.com/en-us/office/sort-data-in-a-range-or-table-62d0b95d-2a90-4610-a6ae-2e545c4a4654).
  id: totrans-388
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot of dialog from Excel showing sorting by the sex then total_bill
    columns](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-389
  prefs: []
  type: TYPE_IMG
- en: pandas has a [`DataFrame.sort_values()`](../../reference/api/pandas.DataFrame.sort_values.html#pandas.DataFrame.sort_values
    "pandas.DataFrame.sort_values") method, which takes a list of columns to sort
    by.
  id: totrans-390
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE76]'
  id: totrans-391
  prefs: []
  type: TYPE_PRE
  zh: '[PRE76]'
- en: String processing
  id: totrans-392
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Finding length of string
  id: totrans-393
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In spreadsheets, the number of characters in text can be found with the [LEN](https://support.microsoft.com/en-us/office/len-lenb-functions-29236f94-cedc-429d-affd-b5e33d2c67cb)
    function. This can be used with the [TRIM](https://support.microsoft.com/en-us/office/trim-function-410388fa-c5df-49c6-b16c-9e5630b479f9)
    function to remove extra whitespace.
  id: totrans-394
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE77]'
  id: totrans-395
  prefs: []
  type: TYPE_PRE
  zh: '[PRE77]'
- en: You can find the length of a character string with [`Series.str.len()`](../../reference/api/pandas.Series.str.len.html#pandas.Series.str.len
    "pandas.Series.str.len"). In Python 3, all strings are Unicode strings. `len`
    includes trailing blanks. Use `len` and `rstrip` to exclude trailing blanks.
  id: totrans-396
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE78]'
  id: totrans-397
  prefs: []
  type: TYPE_PRE
  zh: '[PRE78]'
- en: Note this will still include multiple spaces within the string, so isn’t 100%
    equivalent.
  id: totrans-398
  prefs: []
  type: TYPE_NORMAL
- en: Finding position of substring
  id: totrans-399
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The [FIND](https://support.microsoft.com/en-us/office/find-findb-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628)
    spreadsheet function returns the position of a substring, with the first character
    being `1`.
  id: totrans-400
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot of FIND formula being used in Excel](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-401
  prefs: []
  type: TYPE_IMG
- en: You can find the position of a character in a column of strings with the [`Series.str.find()`](../../reference/api/pandas.Series.str.find.html#pandas.Series.str.find
    "pandas.Series.str.find") method. `find` searches for the first position of the
    substring. If the substring is found, the method returns its position. If not
    found, it returns `-1`. Keep in mind that Python indexes are zero-based.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE79]'
  id: totrans-403
  prefs: []
  type: TYPE_PRE
  zh: '[PRE79]'
- en: Extracting substring by position
  id: totrans-404
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Spreadsheets have a [MID](https://support.microsoft.com/en-us/office/mid-midb-functions-d5f9e25c-d7d6-472e-b568-4ecb12433028)
    formula for extracting a substring from a given position. To get the first character:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE80]'
  id: totrans-406
  prefs: []
  type: TYPE_PRE
  zh: '[PRE80]'
- en: With pandas you can use `[]` notation to extract a substring from a string by
    position locations. Keep in mind that Python indexes are zero-based.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE81]'
  id: totrans-408
  prefs: []
  type: TYPE_PRE
  zh: '[PRE81]'
- en: Extracting nth word
  id: totrans-409
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In Excel, you might use the [Text to Columns Wizard](https://support.microsoft.com/en-us/office/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7)
    for splitting text and retrieving a specific column. (Note [it’s possible to do
    so through a formula as well](https://exceljet.net/formula/extract-nth-word-from-text-string).)
  id: totrans-410
  prefs: []
  type: TYPE_NORMAL
- en: The simplest way to extract words in pandas is to split the strings by spaces,
    then reference the word by index. Note there are more powerful approaches should
    you need them.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE82]'
  id: totrans-412
  prefs: []
  type: TYPE_PRE
  zh: '[PRE82]'
- en: Changing case
  id: totrans-413
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Spreadsheets provide [UPPER, LOWER, and PROPER functions](https://support.microsoft.com/en-us/office/change-the-case-of-text-01481046-0fa7-4f3b-a693-496795a7a44d)
    for converting text to upper, lower, and title case, respectively.
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
- en: The equivalent pandas methods are [`Series.str.upper()`](../../reference/api/pandas.Series.str.upper.html#pandas.Series.str.upper
    "pandas.Series.str.upper"), [`Series.str.lower()`](../../reference/api/pandas.Series.str.lower.html#pandas.Series.str.lower
    "pandas.Series.str.lower"), and [`Series.str.title()`](../../reference/api/pandas.Series.str.title.html#pandas.Series.str.title
    "pandas.Series.str.title").
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE83]'
  id: totrans-416
  prefs: []
  type: TYPE_PRE
  zh: '[PRE83]'
- en: Finding length of string
  id: totrans-417
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In spreadsheets, the number of characters in text can be found with the [LEN](https://support.microsoft.com/en-us/office/len-lenb-functions-29236f94-cedc-429d-affd-b5e33d2c67cb)
    function. This can be used with the [TRIM](https://support.microsoft.com/en-us/office/trim-function-410388fa-c5df-49c6-b16c-9e5630b479f9)
    function to remove extra whitespace.
  id: totrans-418
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE84]'
  id: totrans-419
  prefs: []
  type: TYPE_PRE
  zh: '[PRE84]'
- en: You can find the length of a character string with [`Series.str.len()`](../../reference/api/pandas.Series.str.len.html#pandas.Series.str.len
    "pandas.Series.str.len"). In Python 3, all strings are Unicode strings. `len`
    includes trailing blanks. Use `len` and `rstrip` to exclude trailing blanks.
  id: totrans-420
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE85]'
  id: totrans-421
  prefs: []
  type: TYPE_PRE
  zh: '[PRE85]'
- en: Note this will still include multiple spaces within the string, so isn’t 100%
    equivalent.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
- en: Finding position of substring
  id: totrans-423
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The [FIND](https://support.microsoft.com/en-us/office/find-findb-functions-c7912941-af2a-4bdf-a553-d0d89b0a0628)
    spreadsheet function returns the position of a substring, with the first character
    being `1`.
  id: totrans-424
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot of FIND formula being used in Excel](../Images/b689a4959a66e481ffeaf85cd8d0d137.png)'
  id: totrans-425
  prefs: []
  type: TYPE_IMG
- en: You can find the position of a character in a column of strings with the [`Series.str.find()`](../../reference/api/pandas.Series.str.find.html#pandas.Series.str.find
    "pandas.Series.str.find") method. `find` searches for the first position of the
    substring. If the substring is found, the method returns its position. If not
    found, it returns `-1`. Keep in mind that Python indexes are zero-based.
  id: totrans-426
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE86]'
  id: totrans-427
  prefs: []
  type: TYPE_PRE
  zh: '[PRE86]'
- en: Extracting substring by position
  id: totrans-428
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'Spreadsheets have a [MID](https://support.microsoft.com/en-us/office/mid-midb-functions-d5f9e25c-d7d6-472e-b568-4ecb12433028)
    formula for extracting a substring from a given position. To get the first character:'
  id: totrans-429
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE87]'
  id: totrans-430
  prefs: []
  type: TYPE_PRE
  zh: '[PRE87]'
- en: With pandas you can use `[]` notation to extract a substring from a string by
    position locations. Keep in mind that Python indexes are zero-based.
  id: totrans-431
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE88]'
  id: totrans-432
  prefs: []
  type: TYPE_PRE
  zh: '[PRE88]'
- en: Extracting nth word
  id: totrans-433
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: In Excel, you might use the [Text to Columns Wizard](https://support.microsoft.com/en-us/office/split-text-into-different-columns-with-the-convert-text-to-columns-wizard-30b14928-5550-41f5-97ca-7a3e9c363ed7)
    for splitting text and retrieving a specific column. (Note [it’s possible to do
    so through a formula as well](https://exceljet.net/formula/extract-nth-word-from-text-string).)
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
- en: The simplest way to extract words in pandas is to split the strings by spaces,
    then reference the word by index. Note there are more powerful approaches should
    you need them.
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE89]'
  id: totrans-436
  prefs: []
  type: TYPE_PRE
  zh: '[PRE89]'
- en: Changing case
  id: totrans-437
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Spreadsheets provide [UPPER, LOWER, and PROPER functions](https://support.microsoft.com/en-us/office/change-the-case-of-text-01481046-0fa7-4f3b-a693-496795a7a44d)
    for converting text to upper, lower, and title case, respectively.
  id: totrans-438
  prefs: []
  type: TYPE_NORMAL
- en: The equivalent pandas methods are [`Series.str.upper()`](../../reference/api/pandas.Series.str.upper.html#pandas.Series.str.upper
    "pandas.Series.str.upper"), [`Series.str.lower()`](../../reference/api/pandas.Series.str.lower.html#pandas.Series.str.lower
    "pandas.Series.str.lower"), and [`Series.str.title()`](../../reference/api/pandas.Series.str.title.html#pandas.Series.str.title
    "pandas.Series.str.title").
  id: totrans-439
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE90]'
  id: totrans-440
  prefs: []
  type: TYPE_PRE
  zh: '[PRE90]'
- en: Merging
  id: totrans-441
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following tables will be used in the merge examples:'
  id: totrans-442
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE91]'
  id: totrans-443
  prefs: []
  type: TYPE_PRE
  zh: '[PRE91]'
- en: In Excel, there are [merging of tables can be done through a VLOOKUP](https://support.microsoft.com/en-us/office/how-can-i-merge-two-or-more-tables-c80a9fce-c1ab-4425-bb96-497dd906d656).
  id: totrans-444
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing a VLOOKUP formula between two tables in Excel, with some
    values being filled in and others with "#N/A"](../Images/45b212b0b5aad19471118c664f8faa1d.png)'
  id: totrans-445
  prefs: []
  type: TYPE_IMG
- en: pandas DataFrames have a [`merge()`](../../reference/api/pandas.DataFrame.merge.html#pandas.DataFrame.merge
    "pandas.DataFrame.merge") method, which provides similar functionality. The data
    does not have to be sorted ahead of time, and different join types are accomplished
    via the `how` keyword.
  id: totrans-446
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE92]'
  id: totrans-447
  prefs: []
  type: TYPE_PRE
  zh: '[PRE92]'
- en: '`merge` has a number of advantages over `VLOOKUP`:'
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
- en: The lookup value doesn’t need to be the first column of the lookup table
  id: totrans-449
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If multiple rows are matched, there will be one row for each match, instead
    of just the first
  id: totrans-450
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It will include all columns from the lookup table, instead of just a single
    specified column
  id: totrans-451
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It supports [more complex join operations](../../user_guide/merging.html#merging-join)
  id: totrans-452
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other considerations
  id: totrans-453
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fill Handle
  id: totrans-454
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Create a series of numbers following a set pattern in a certain set of cells.
    In a spreadsheet, this would be done by shift+drag after entering the first number
    or by entering the first two or three values and then dragging.
  id: totrans-455
  prefs: []
  type: TYPE_NORMAL
- en: This can be achieved by creating a series and assigning it to the desired cells.
  id: totrans-456
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE93]'
  id: totrans-457
  prefs: []
  type: TYPE_PRE
  zh: '[PRE93]'
- en: Drop Duplicates
  id: totrans-458
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Excel has built-in functionality for [removing duplicate values](https://support.microsoft.com/en-us/office/find-and-remove-duplicates-00e35bea-b46a-4d5d-b28e-66a552dc138d).
    This is supported in pandas via [`drop_duplicates()`](../../reference/api/pandas.DataFrame.drop_duplicates.html#pandas.DataFrame.drop_duplicates
    "pandas.DataFrame.drop_duplicates").
  id: totrans-459
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE94]'
  id: totrans-460
  prefs: []
  type: TYPE_PRE
  zh: '[PRE94]'
- en: Pivot Tables
  id: totrans-461
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[PivotTables](https://support.microsoft.com/en-us/office/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576)
    from spreadsheets can be replicated in pandas through [Reshaping and pivot tables](../../user_guide/reshaping.html#reshaping).
    Using the `tips` dataset again, let’s find the average gratuity by size of the
    party and sex of the server.'
  id: totrans-462
  prefs: []
  type: TYPE_NORMAL
- en: 'In Excel, we use the following configuration for the PivotTable:'
  id: totrans-463
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing a PivotTable in Excel, using sex as the column, size as
    the rows, then average tip as the values](../Images/a75631a6c79429bb08cae93014856707.png)'
  id: totrans-464
  prefs: []
  type: TYPE_IMG
- en: 'The equivalent in pandas:'
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE95]'
  id: totrans-466
  prefs: []
  type: TYPE_PRE
  zh: '[PRE95]'
- en: Adding a row
  id: totrans-467
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Assuming we are using a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") (numbered `0`, `1`, etc.), we can use [`concat()`](../../reference/api/pandas.concat.html#pandas.concat
    "pandas.concat") to add a row to the bottom of a `DataFrame`.
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE96]'
  id: totrans-469
  prefs: []
  type: TYPE_PRE
  zh: '[PRE96]'
- en: Find and Replace
  id: totrans-470
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Excel’s Find dialog](https://support.microsoft.com/en-us/office/find-or-replace-text-and-numbers-on-a-worksheet-0e304ca5-ecef-4808-b90f-fdb42f892e90)
    takes you to cells that match, one by one. In pandas, this operation is generally
    done for an entire column or `DataFrame` at once through [conditional expressions](../intro_tutorials/03_subset_data.html#min-tut-03-subset-rows-and-columns).'
  id: totrans-471
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE97]'
  id: totrans-472
  prefs: []
  type: TYPE_PRE
  zh: '[PRE97]'
- en: pandas’ [`replace()`](../../reference/api/pandas.DataFrame.replace.html#pandas.DataFrame.replace
    "pandas.DataFrame.replace") is comparable to Excel’s `Replace All`.
  id: totrans-473
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE98]'
  id: totrans-474
  prefs: []
  type: TYPE_PRE
  zh: '[PRE98]'
- en: Fill Handle
  id: totrans-475
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Create a series of numbers following a set pattern in a certain set of cells.
    In a spreadsheet, this would be done by shift+drag after entering the first number
    or by entering the first two or three values and then dragging.
  id: totrans-476
  prefs: []
  type: TYPE_NORMAL
- en: This can be achieved by creating a series and assigning it to the desired cells.
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE99]'
  id: totrans-478
  prefs: []
  type: TYPE_PRE
  zh: '[PRE99]'
- en: Drop Duplicates
  id: totrans-479
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Excel has built-in functionality for [removing duplicate values](https://support.microsoft.com/en-us/office/find-and-remove-duplicates-00e35bea-b46a-4d5d-b28e-66a552dc138d).
    This is supported in pandas via [`drop_duplicates()`](../../reference/api/pandas.DataFrame.drop_duplicates.html#pandas.DataFrame.drop_duplicates
    "pandas.DataFrame.drop_duplicates").
  id: totrans-480
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE100]'
  id: totrans-481
  prefs: []
  type: TYPE_PRE
  zh: '[PRE100]'
- en: Pivot Tables
  id: totrans-482
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[PivotTables](https://support.microsoft.com/en-us/office/create-a-pivottable-to-analyze-worksheet-data-a9a84538-bfe9-40a9-a8e9-f99134456576)
    from spreadsheets can be replicated in pandas through [Reshaping and pivot tables](../../user_guide/reshaping.html#reshaping).
    Using the `tips` dataset again, let’s find the average gratuity by size of the
    party and sex of the server.'
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
- en: 'In Excel, we use the following configuration for the PivotTable:'
  id: totrans-484
  prefs: []
  type: TYPE_NORMAL
- en: '![Screenshot showing a PivotTable in Excel, using sex as the column, size as
    the rows, then average tip as the values](../Images/a75631a6c79429bb08cae93014856707.png)'
  id: totrans-485
  prefs: []
  type: TYPE_IMG
- en: 'The equivalent in pandas:'
  id: totrans-486
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE101]'
  id: totrans-487
  prefs: []
  type: TYPE_PRE
  zh: '[PRE101]'
- en: Adding a row
  id: totrans-488
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Assuming we are using a [`RangeIndex`](../../reference/api/pandas.RangeIndex.html#pandas.RangeIndex
    "pandas.RangeIndex") (numbered `0`, `1`, etc.), we can use [`concat()`](../../reference/api/pandas.concat.html#pandas.concat
    "pandas.concat") to add a row to the bottom of a `DataFrame`.
  id: totrans-489
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE102]'
  id: totrans-490
  prefs: []
  type: TYPE_PRE
  zh: '[PRE102]'
- en: Find and Replace
  id: totrans-491
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '[Excel’s Find dialog](https://support.microsoft.com/en-us/office/find-or-replace-text-and-numbers-on-a-worksheet-0e304ca5-ecef-4808-b90f-fdb42f892e90)
    takes you to cells that match, one by one. In pandas, this operation is generally
    done for an entire column or `DataFrame` at once through [conditional expressions](../intro_tutorials/03_subset_data.html#min-tut-03-subset-rows-and-columns).'
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
  zh: '[Excel的查找对话框](https://support.microsoft.com/en-us/office/find-or-replace-text-and-numbers-on-a-worksheet-0e304ca5-ecef-4808-b90f-fdb42f892e90)会逐个显示匹配的单元格。在pandas中，这个操作通常是针对整列或`DataFrame`一次性通过[条件表达式](../intro_tutorials/03_subset_data.html#min-tut-03-subset-rows-and-columns)完成的。'
- en: '[PRE103]'
  id: totrans-493
  prefs: []
  type: TYPE_PRE
  zh: '[PRE103]'
- en: pandas’ [`replace()`](../../reference/api/pandas.DataFrame.replace.html#pandas.DataFrame.replace
    "pandas.DataFrame.replace") is comparable to Excel’s `Replace All`.
  id: totrans-494
  prefs: []
  type: TYPE_NORMAL
  zh: pandas的[`replace()`](../../reference/api/pandas.DataFrame.replace.html#pandas.DataFrame.replace
    "pandas.DataFrame.replace")与Excel的`Replace All`相当。
- en: '[PRE104]'
  id: totrans-495
  prefs: []
  type: TYPE_PRE
  zh: '[PRE104]'
