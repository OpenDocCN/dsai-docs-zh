- en: scipy.integrate.cumulative_simpson
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.integrate.cumulative_simpson.html#scipy.integrate.cumulative_simpson](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.integrate.cumulative_simpson.html#scipy.integrate.cumulative_simpson)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Cumulatively integrate y(x) using the composite Simpson’s 1/3 rule. The integral
    of the samples at every point is calculated by assuming a quadratic relationship
    between each point and the two adjacent points.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**y**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: Values to integrate. Requires at least one point along *axis*. If two or fewer
    points are provided along *axis*, Simpson’s integration is not possible and the
    result is calculated with [`cumulative_trapezoid`](scipy.integrate.cumulative_trapezoid.html#scipy.integrate.cumulative_trapezoid
    "scipy.integrate.cumulative_trapezoid").
  prefs: []
  type: TYPE_NORMAL
- en: '**x**array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: The coordinate to integrate along. Must have the same shape as *y* or must be
    1D with the same length as *y* along *axis*. *x* must also be strictly increasing
    along *axis*. If *x* is None (default), integration is performed using spacing
    *dx* between consecutive elements in *y*.
  prefs: []
  type: TYPE_NORMAL
- en: '**dx**scalar or array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Spacing between elements of *y*. Only used if *x* is None. Can either be a float,
    or an array with the same shape as *y*, but of length one along *axis*. Default
    is 1.0.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Specifies the axis to integrate along. Default is -1 (last axis).
  prefs: []
  type: TYPE_NORMAL
- en: '**initial**scalar or array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: If given, insert this value at the beginning of the returned result, and add
    it to the rest of the result. Default is None, which means no value at `x[0]`
    is returned and *res* has one element less than *y* along the axis of integration.
    Can either be a float, or an array with the same shape as *y*, but of length one
    along *axis*.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**res**ndarray'
  prefs: []
  type: TYPE_NORMAL
- en: The result of cumulative integration of *y* along *axis*. If *initial* is None,
    the shape is such that the axis of integration has one less value than *y*. If
    *initial* is given, the shape is equal to that of *y*.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`numpy.cumsum`](https://numpy.org/devdocs/reference/generated/numpy.cumsum.html#numpy.cumsum
    "(in NumPy v2.0.dev0)")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`cumulative_trapezoid`](scipy.integrate.cumulative_trapezoid.html#scipy.integrate.cumulative_trapezoid
    "scipy.integrate.cumulative_trapezoid")'
  prefs: []
  type: TYPE_NORMAL
- en: cumulative integration using the composite trapezoidal rule
  prefs: []
  type: TYPE_NORMAL
- en: '[`simpson`](scipy.integrate.simpson.html#scipy.integrate.simpson "scipy.integrate.simpson")'
  prefs: []
  type: TYPE_NORMAL
- en: integrator for sampled data using the Composite Simpson’s Rule
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: New in version 1.12.0.
  prefs: []
  type: TYPE_NORMAL
- en: The composite Simpson’s 1/3 method can be used to approximate the definite integral
    of a sampled input function \(y(x)\) [[1]](#rb3a817c91225-1). The method assumes
    a quadratic relationship over the interval containing any three consecutive sampled
    points.
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider three consecutive points: \((x_1, y_1), (x_2, y_2), (x_3, y_3)\).'
  prefs: []
  type: TYPE_NORMAL
- en: 'Assuming a quadratic relationship over the three points, the integral over
    the subinterval between \(x_1\) and \(x_2\) is given by formula (8) of [[2]](#rb3a817c91225-2):'
  prefs: []
  type: TYPE_NORMAL
- en: \[\begin{split}\int_{x_1}^{x_2} y(x) dx\ &= \frac{x_2-x_1}{6}\left[\ \left\{3-\frac{x_2-x_1}{x_3-x_1}\right\}
    y_1 + \ \left\{3 + \frac{(x_2-x_1)^2}{(x_3-x_2)(x_3-x_1)} + \ \frac{x_2-x_1}{x_3-x_1}\right\}
    y_2\\ - \frac{(x_2-x_1)^2}{(x_3-x_2)(x_3-x_1)} y_3\right]\end{split}\]
  prefs: []
  type: TYPE_NORMAL
- en: The integral between \(x_2\) and \(x_3\) is given by swapping appearances of
    \(x_1\) and \(x_3\). The integral is estimated separately for each subinterval
    and then cumulatively summed to obtain the final result.
  prefs: []
  type: TYPE_NORMAL
- en: For samples that are equally spaced, the result is exact if the function is
    a polynomial of order three or less [[1]](#rb3a817c91225-1) and the number of
    subintervals is even. Otherwise, the integral is exact for polynomials of order
    two or less.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1] ([1](#id1),[2](#id3))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Wikipedia page: [https://en.wikipedia.org/wiki/Simpson’s_rule](https://en.wikipedia.org/wiki/Simpson''s_rule)'
  prefs: []
  type: TYPE_NORMAL
- en: '[[2](#id2)]'
  prefs: []
  type: TYPE_NORMAL
- en: 'Cartwright, Kenneth V. Simpson’s Rule Cumulative Integration with MS Excel
    and Irregularly-spaced Data. Journal of Mathematical Sciences and Mathematics
    Education. 12 (2): 1-9'
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![../../_images/scipy-integrate-cumulative_simpson-1_00_00.png](../Images/88e7cd2977177c7eb259b90059a4d9c3.png)'
  prefs: []
  type: TYPE_IMG
- en: The output of [`cumulative_simpson`](#scipy.integrate.cumulative_simpson "scipy.integrate.cumulative_simpson")
    is similar to that of iteratively calling [`simpson`](scipy.integrate.simpson.html#scipy.integrate.simpson
    "scipy.integrate.simpson") with successively higher upper limits of integration,
    but not identical.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'This is expected: because [`cumulative_simpson`](#scipy.integrate.cumulative_simpson
    "scipy.integrate.cumulative_simpson") has access to more information than [`simpson`](scipy.integrate.simpson.html#scipy.integrate.simpson
    "scipy.integrate.simpson"), it can typically produce more accurate estimates of
    the underlying integral over subintervals.'
  prefs: []
  type: TYPE_NORMAL
