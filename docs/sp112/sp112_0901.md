# scipy.special.smirnov

> 原文链接：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.special.smirnov.html#scipy.special.smirnov](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.special.smirnov.html#scipy.special.smirnov)

```py
scipy.special.smirnov(n, d, out=None) = <ufunc 'smirnov'>
```

Kolmogorov-Smirnov 单侧累积分布函数

返回 Kolmogorov-Smirnov 单侧检验（即生存函数）的确切值 Dn+（或 Dn-），用于衡量经验分布与理论分布的一致性。它等于理论分布与基于 *n* 个样本的经验分布之间的最大差异大于 d 的概率。

参数：

**n** 整数

样本数量

**d** 浮点数数组

经验 CDF（ECDF）与目标 CDF 之间的偏差。

**out** ndarray，可选

可选的输出数组，用于函数结果

返回：

标量或者ndarray

smirnov(n, d) 的值，Prob(Dn+ >= d)（也是 Prob(Dn- >= d)）

参见

[`smirnovi`](scipy.special.smirnovi.html#scipy.special.smirnovi "scipy.special.smirnovi")

分布的逆生存函数

[`scipy.stats.ksone`](scipy.stats.ksone.html#scipy.stats.ksone "scipy.stats.ksone")

提供连续分布的功能

[`kolmogorov`](scipy.special.kolmogorov.html#scipy.special.kolmogorov "scipy.special.kolmogorov")，[`kolmogi`](scipy.special.kolmogi.html#scipy.special.kolmogi "scipy.special.kolmogi")

两侧分布的函数

注意：

[`smirnov`](#scipy.special.smirnov "scipy.special.smirnov") 在 Kolmogorov-Smirnov 拟合优度检验中由 *stats.kstest* 应用。出于历史原因，此函数在 *scpy.special* 中公开，但建议以最准确的 CDF/SF/PDF/PPF/ISF 计算方式使用 *stats.ksone* 分布。

示例

```py
>>> import numpy as np
>>> from scipy.special import smirnov
>>> from scipy.stats import norm 
```

显示大小至少为 0、0.5 和 1.0 的间隙的概率，对于大小为 5 的样本。

```py
>>> smirnov(5, [0, 0.5, 1.0])
array([ 1\.   ,  0.056,  0\.   ]) 
```

比较大小为 5 的样本与 N(0, 1) 的标准正态分布，其中均值为 0，标准差为 1。

*x* 是样本。

```py
>>> x = np.array([-1.392, -0.135, 0.114, 0.190, 1.82]) 
```

```py
>>> target = norm(0, 1)
>>> cdfs = target.cdf(x)
>>> cdfs
array([0.0819612 , 0.44630594, 0.5453811 , 0.57534543, 0.9656205 ]) 
```

构造经验 CDF 和 K-S 统计量（Dn+、Dn-、Dn）。

```py
>>> n = len(x)
>>> ecdfs = np.arange(n+1, dtype=float)/n
>>> cols = np.column_stack([x, ecdfs[1:], cdfs, cdfs - ecdfs[:n],
...                        ecdfs[1:] - cdfs])
>>> with np.printoptions(precision=3):
...    print(cols)
[[-1.392  0.2    0.082  0.082  0.118]
 [-0.135  0.4    0.446  0.246 -0.046]
 [ 0.114  0.6    0.545  0.145  0.055]
 [ 0.19   0.8    0.575 -0.025  0.225]
 [ 1.82   1\.     0.966  0.166  0.034]]
>>> gaps = cols[:, -2:]
>>> Dnpm = np.max(gaps, axis=0)
>>> print(f'Dn-={Dnpm[0]:f}, Dn+={Dnpm[1]:f}')
Dn-=0.246306, Dn+=0.224655
>>> probs = smirnov(n, Dnpm)
>>> print(f'For a sample of size {n} drawn from N(0, 1):',
...       f' Smirnov n={n}: Prob(Dn- >= {Dnpm[0]:f}) = {probs[0]:.4f}',
...       f' Smirnov n={n}: Prob(Dn+ >= {Dnpm[1]:f}) = {probs[1]:.4f}',
...       sep='\n')
For a sample of size 5 drawn from N(0, 1):
 Smirnov n=5: Prob(Dn- >= 0.246306) = 0.4711
 Smirnov n=5: Prob(Dn+ >= 0.224655) = 0.5245 
```

绘制经验 CDF 和标准正态 CDF。

```py
>>> import matplotlib.pyplot as plt
>>> plt.step(np.concatenate(([-2.5], x, [2.5])),
...          np.concatenate((ecdfs, [1])),
...          where='post', label='Empirical CDF')
>>> xx = np.linspace(-2.5, 2.5, 100)
>>> plt.plot(xx, target.cdf(xx), '--', label='CDF for N(0, 1)') 
```

添加标记 Dn+ 和 Dn- 的垂直线。

```py
>>> iminus, iplus = np.argmax(gaps, axis=0)
>>> plt.vlines([x[iminus]], ecdfs[iminus], cdfs[iminus], color='r',
...            alpha=0.5, lw=4)
>>> plt.vlines([x[iplus]], cdfs[iplus], ecdfs[iplus+1], color='m',
...            alpha=0.5, lw=4) 
```

```py
>>> plt.grid(True)
>>> plt.legend(framealpha=1, shadow=True)
>>> plt.show() 
```

![../../_images/scipy-special-smirnov-1.png](../Images/3db075c983cc5da8f272d2fff19c3163.png)
