- en: scipy.stats.mannwhitneyu
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.mannwhitneyu.html#scipy.stats.mannwhitneyu)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Perform the Mann-Whitney U rank test on two independent samples.
  prefs: []
  type: TYPE_NORMAL
- en: The Mann-Whitney U test is a nonparametric test of the null hypothesis that
    the distribution underlying sample *x* is the same as the distribution underlying
    sample *y*. It is often used as a test of difference in location between distributions.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**x, y**array-like'
  prefs: []
  type: TYPE_NORMAL
- en: N-d arrays of samples. The arrays must be broadcastable except along the dimension
    given by *axis*.
  prefs: []
  type: TYPE_NORMAL
- en: '**use_continuity**bool, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Whether a continuity correction (1/2) should be applied. Default is True when
    *method* is `'asymptotic'`; has no effect otherwise.
  prefs: []
  type: TYPE_NORMAL
- en: '**alternative**{‘two-sided’, ‘less’, ‘greater’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: 'Defines the alternative hypothesis. Default is ‘two-sided’. Let *F(u)* and
    *G(u)* be the cumulative distribution functions of the distributions underlying
    *x* and *y*, respectively. Then the following alternative hypotheses are available:'
  prefs: []
  type: TYPE_NORMAL
- en: '‘two-sided’: the distributions are not equal, i.e. *F(u) ≠ G(u)* for at least
    one *u*.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘less’: the distribution underlying *x* is stochastically less than the distribution
    underlying *y*, i.e. *F(u) > G(u)* for all *u*.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‘greater’: the distribution underlying *x* is stochastically greater than the
    distribution underlying *y*, i.e. *F(u) < G(u)* for all *u*.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Note that the mathematical expressions in the alternative hypotheses above describe
    the CDFs of the underlying distributions. The directions of the inequalities appear
    inconsistent with the natural language description at first glance, but they are
    not. For example, suppose *X* and *Y* are random variables that follow distributions
    with CDFs *F* and *G*, respectively. If *F(u) > G(u)* for all *u*, samples drawn
    from *X* tend to be less than those drawn from *Y*.
  prefs: []
  type: TYPE_NORMAL
- en: Under a more restrictive set of assumptions, the alternative hypotheses can
    be expressed in terms of the locations of the distributions; see [5] section 5.1.
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, default: 0'
  prefs: []
  type: TYPE_NORMAL
- en: If an int, the axis of the input along which to compute the statistic. The statistic
    of each axis-slice (e.g. row) of the input will appear in a corresponding element
    of the output. If `None`, the input will be raveled before computing the statistic.
  prefs: []
  type: TYPE_NORMAL
- en: '**method**{‘auto’, ‘asymptotic’, ‘exact’}, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Selects the method used to calculate the *p*-value. Default is ‘auto’. The following
    options are available.
  prefs: []
  type: TYPE_NORMAL
- en: '`''asymptotic''`: compares the standardized test statistic against the normal
    distribution, correcting for ties.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`''exact''`: computes the exact *p*-value by comparing the observed \(U\) statistic
    against the exact distribution of the \(U\) statistic under the null hypothesis.
    No correction is made for ties.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`''auto''`: chooses `''exact''` when the size of one of the samples is less
    than or equal to 8 and there are no ties; chooses `''asymptotic''` otherwise.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**nan_policy**{‘propagate’, ‘omit’, ‘raise’}'
  prefs: []
  type: TYPE_NORMAL
- en: Defines how to handle input NaNs.
  prefs: []
  type: TYPE_NORMAL
- en: '`propagate`: if a NaN is present in the axis slice (e.g. row) along which the
    statistic is computed, the corresponding entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`omit`: NaNs will be omitted when performing the calculation. If insufficient
    data remains in the axis slice along which the statistic is computed, the corresponding
    entry of the output will be NaN.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`raise`: if a NaN is present, a `ValueError` will be raised.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**keepdims**bool, default: False'
  prefs: []
  type: TYPE_NORMAL
- en: If this is set to True, the axes which are reduced are left in the result as
    dimensions with size one. With this option, the result will broadcast correctly
    against the input array.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: '**res**MannwhitneyuResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat
  prefs: []
  type: TYPE_NORMAL
- en: The Mann-Whitney U statistic corresponding with sample *x*. See Notes for the
    test statistic corresponding with sample *y*.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat
  prefs: []
  type: TYPE_NORMAL
- en: The associated *p*-value for the chosen *alternative*.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.wilcoxon`](scipy.stats.wilcoxon.html#scipy.stats.wilcoxon "scipy.stats.wilcoxon"),
    [`scipy.stats.ranksums`](scipy.stats.ranksums.html#scipy.stats.ranksums "scipy.stats.ranksums"),
    [`scipy.stats.ttest_ind`](scipy.stats.ttest_ind.html#scipy.stats.ttest_ind "scipy.stats.ttest_ind")'
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: If `U1` is the statistic corresponding with sample *x*, then the statistic corresponding
    with sample *y* is `U2 = x.shape[axis] * y.shape[axis] - U1`.
  prefs: []
  type: TYPE_NORMAL
- en: '[`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu") is for
    independent samples. For related / paired samples, consider [`scipy.stats.wilcoxon`](scipy.stats.wilcoxon.html#scipy.stats.wilcoxon
    "scipy.stats.wilcoxon").'
  prefs: []
  type: TYPE_NORMAL
- en: '*method* `''exact''` is recommended when there are no ties and when either
    sample size is less than 8 [[1]](#r31b0b1c0fec3-1). The implementation follows
    the recurrence relation originally proposed in [[1]](#r31b0b1c0fec3-1) as it is
    described in [[3]](#r31b0b1c0fec3-3). Note that the exact method is *not* corrected
    for ties, but [`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu")
    will not raise errors or warnings if there are ties in the data.'
  prefs: []
  type: TYPE_NORMAL
- en: The Mann-Whitney U test is a non-parametric version of the t-test for independent
    samples. When the means of samples from the populations are normally distributed,
    consider [`scipy.stats.ttest_ind`](scipy.stats.ttest_ind.html#scipy.stats.ttest_ind
    "scipy.stats.ttest_ind").
  prefs: []
  type: TYPE_NORMAL
- en: Beginning in SciPy 1.9, `np.matrix` inputs (not recommended for new code) are
    converted to `np.ndarray` before the calculation is performed. In this case, the
    output will be a scalar or `np.ndarray` of appropriate shape rather than a 2D
    `np.matrix`. Similarly, while masked elements of masked arrays are ignored, the
    output will be a scalar or `np.ndarray` rather than a masked array with `mask=False`.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1] ([1](#id1),[2](#id2))'
  prefs: []
  type: TYPE_NORMAL
- en: H.B. Mann and D.R. Whitney, “On a test of whether one of two random variables
    is stochastically larger than the other”, The Annals of Mathematical Statistics,
    Vol. 18, pp. 50-60, 1947.
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: Mann-Whitney U Test, Wikipedia, [http://en.wikipedia.org/wiki/Mann-Whitney_U_test](http://en.wikipedia.org/wiki/Mann-Whitney_U_test)
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id3)]'
  prefs: []
  type: TYPE_NORMAL
- en: A. Di Bucchianico, “Combinatorics, computer algebra, and the Wilcoxon-Mann-Whitney
    test”, Journal of Statistical Planning and Inference, Vol. 79, pp. 349-364, 1999.
  prefs: []
  type: TYPE_NORMAL
- en: '[4] ([1](#id9),[2](#id10),[3](#id11),[4](#id12),[5](#id13),[6](#id14),[7](#id15))'
  prefs: []
  type: TYPE_NORMAL
- en: 'Rosie Shier, “Statistics: 2.3 The Mann-Whitney U Test”, Mathematics Learning
    Support Centre, 2004.'
  prefs: []
  type: TYPE_NORMAL
- en: '[5]'
  prefs: []
  type: TYPE_NORMAL
- en: Michael P. Fay and Michael A. Proschan. “Wilcoxon-Mann-Whitney or t-test? On
    assumptions for hypothesis tests and multiple interpretations of decision rules.”
    Statistics surveys, Vol. 4, pp. 1-39, 2010\. [https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2857732/)
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: 'We follow the example from [[4]](#r31b0b1c0fec3-4): nine randomly sampled young
    adults were diagnosed with type II diabetes at the ages below.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: We use the Mann-Whitney U test to assess whether there is a statistically significant
    difference in the diagnosis age of males and females. The null hypothesis is that
    the distribution of male diagnosis ages is the same as the distribution of female
    diagnosis ages. We decide that a confidence level of 95% is required to reject
    the null hypothesis in favor of the alternative that the distributions are different.
    Since the number of samples is very small and there are no ties in the data, we
    can compare the observed test statistic against the *exact* distribution of the
    test statistic under the null hypothesis.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu") always
    reports the statistic associated with the first sample, which, in this case, is
    males. This agrees with \(U_M = 17\) reported in [[4]](#r31b0b1c0fec3-4). The
    statistic associated with the second statistic can be calculated:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: This agrees with \(U_F = 3\) reported in [[4]](#r31b0b1c0fec3-4). The two-sided
    *p*-value can be calculated from either statistic, and the value produced by [`mannwhitneyu`](#scipy.stats.mannwhitneyu
    "scipy.stats.mannwhitneyu") agrees with \(p = 0.11\) reported in [[4]](#r31b0b1c0fec3-4).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: The exact distribution of the test statistic is asymptotically normal, so the
    example continues by comparing the exact *p*-value against the *p*-value produced
    using the normal approximation.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: Here [`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu")’s
    reported *p*-value appears to conflict with the value \(p = 0.09\) given in [[4]](#r31b0b1c0fec3-4).
    The reason is that [[4]](#r31b0b1c0fec3-4) does not apply the continuity correction
    performed by [`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu");
    [`mannwhitneyu`](#scipy.stats.mannwhitneyu "scipy.stats.mannwhitneyu") reduces
    the distance between the test statistic and the mean \(\mu = n_x n_y / 2\) by
    0.5 to correct for the fact that the discrete statistic is being compared against
    a continuous distribution. Here, the \(U\) statistic used is less than the mean,
    so we reduce the distance by adding 0.5 in the numerator.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: If desired, we can disable the continuity correction to get a result that agrees
    with that reported in [[4]](#r31b0b1c0fec3-4).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Regardless of whether we perform an exact or asymptotic test, the probability
    of the test statistic being as extreme or more extreme by chance exceeds 5%, so
    we do not consider the results statistically significant.
  prefs: []
  type: TYPE_NORMAL
- en: 'Suppose that, before seeing the data, we had hypothesized that females would
    tend to be diagnosed at a younger age than males. In that case, it would be natural
    to provide the female ages as the first input, and we would have performed a one-sided
    test using `alternative = ''less''`: females are diagnosed at an age that is stochastically
    less than that of males.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Again, the probability of getting a sufficiently low value of the test statistic
    by chance under the null hypothesis is greater than 5%, so we do not reject the
    null hypothesis in favor of our alternative.
  prefs: []
  type: TYPE_NORMAL
- en: If it is reasonable to assume that the means of samples from the populations
    are normally distributed, we could have used a t-test to perform the analysis.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Under this assumption, the *p*-value would be low enough to reject the null
    hypothesis in favor of the alternative.
  prefs: []
  type: TYPE_NORMAL
