- en: scipy.stats.chisquare
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.chisquare.html#scipy.stats.chisquare](https://docs.scipy.org/doc/scipy-1.12.0/reference/generated/scipy.stats.chisquare.html#scipy.stats.chisquare)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Calculate a one-way chi-square test.
  prefs: []
  type: TYPE_NORMAL
- en: The chi-square test tests the null hypothesis that the categorical data has
    the given frequencies.
  prefs: []
  type: TYPE_NORMAL
- en: 'Parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**f_obs**array_like'
  prefs: []
  type: TYPE_NORMAL
- en: Observed frequencies in each category.
  prefs: []
  type: TYPE_NORMAL
- en: '**f_exp**array_like, optional'
  prefs: []
  type: TYPE_NORMAL
- en: Expected frequencies in each category. By default the categories are assumed
    to be equally likely.
  prefs: []
  type: TYPE_NORMAL
- en: '**ddof**int, optional'
  prefs: []
  type: TYPE_NORMAL
- en: '“Delta degrees of freedom”: adjustment to the degrees of freedom for the p-value.
    The p-value is computed using a chi-squared distribution with `k - 1 - ddof` degrees
    of freedom, where *k* is the number of observed frequencies. The default value
    of *ddof* is 0.'
  prefs: []
  type: TYPE_NORMAL
- en: '**axis**int or None, optional'
  prefs: []
  type: TYPE_NORMAL
- en: The axis of the broadcast result of *f_obs* and *f_exp* along which to apply
    the test. If axis is None, all values in *f_obs* are treated as a single data
    set. Default is 0.
  prefs: []
  type: TYPE_NORMAL
- en: 'Returns:'
  prefs: []
  type: TYPE_NORMAL
- en: 'res: Power_divergenceResult'
  prefs: []
  type: TYPE_NORMAL
- en: 'An object containing attributes:'
  prefs: []
  type: TYPE_NORMAL
- en: statisticfloat or ndarray
  prefs: []
  type: TYPE_NORMAL
- en: The chi-squared test statistic. The value is a float if *axis* is None or *f_obs*
    and *f_exp* are 1-D.
  prefs: []
  type: TYPE_NORMAL
- en: pvaluefloat or ndarray
  prefs: []
  type: TYPE_NORMAL
- en: The p-value of the test. The value is a float if *ddof* and the result attribute
    *statistic* are scalars.
  prefs: []
  type: TYPE_NORMAL
- en: See also
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.power_divergence`](scipy.stats.power_divergence.html#scipy.stats.power_divergence
    "scipy.stats.power_divergence")'
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.fisher_exact`](scipy.stats.fisher_exact.html#scipy.stats.fisher_exact
    "scipy.stats.fisher_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: Fisher exact test on a 2x2 contingency table.
  prefs: []
  type: TYPE_NORMAL
- en: '[`scipy.stats.barnard_exact`](scipy.stats.barnard_exact.html#scipy.stats.barnard_exact
    "scipy.stats.barnard_exact")'
  prefs: []
  type: TYPE_NORMAL
- en: An unconditional exact test. An alternative to chi-squared test for small sample
    sizes.
  prefs: []
  type: TYPE_NORMAL
- en: Notes
  prefs: []
  type: TYPE_NORMAL
- en: This test is invalid when the observed or expected frequencies in each category
    are too small. A typical rule is that all of the observed and expected frequencies
    should be at least 5\. According to [[3]](#r81ecfb019d82-3), the total number
    of samples is recommended to be greater than 13, otherwise exact tests (such as
    Barnard’s Exact test) should be used because they do not overreject.
  prefs: []
  type: TYPE_NORMAL
- en: Also, the sum of the observed and expected frequencies must be the same for
    the test to be valid; [`chisquare`](#scipy.stats.chisquare "scipy.stats.chisquare")
    raises an error if the sums do not agree within a relative tolerance of `1e-8`.
  prefs: []
  type: TYPE_NORMAL
- en: The default degrees of freedom, k-1, are for the case when no parameters of
    the distribution are estimated. If p parameters are estimated by efficient maximum
    likelihood then the correct degrees of freedom are k-1-p. If the parameters are
    estimated in a different way, then the dof can be between k-1-p and k-1\. However,
    it is also possible that the asymptotic distribution is not chi-square, in which
    case this test is not appropriate.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: '[1]'
  prefs: []
  type: TYPE_NORMAL
- en: Lowry, Richard. “Concepts and Applications of Inferential Statistics”. Chapter
    8. [https://web.archive.org/web/20171022032306/http://vassarstats.net:80/textbook/ch8pt1.html](https://web.archive.org/web/20171022032306/http://vassarstats.net:80/textbook/ch8pt1.html)
  prefs: []
  type: TYPE_NORMAL
- en: '[2]'
  prefs: []
  type: TYPE_NORMAL
- en: “Chi-squared test”, [https://en.wikipedia.org/wiki/Chi-squared_test](https://en.wikipedia.org/wiki/Chi-squared_test)
  prefs: []
  type: TYPE_NORMAL
- en: '[[3](#id1)]'
  prefs: []
  type: TYPE_NORMAL
- en: Pearson, Karl. “On the criterion that a given system of deviations from the
    probable in the case of a correlated system of variables is such that it can be
    reasonably supposed to have arisen from random sampling”, Philosophical Magazine.
    Series 5\. 50 (1900), pp. 157-175.
  prefs: []
  type: TYPE_NORMAL
- en: '[[4](#id6)]'
  prefs: []
  type: TYPE_NORMAL
- en: Mannan, R. William and E. Charles. Meslow. “Bird populations and vegetation
    characteristics in managed and old-growth forests, northeastern Oregon.” Journal
    of Wildlife Management 48, 1219-1238, [DOI:10.2307/3801783](https://doi.org/10.2307/3801783),
    1984.
  prefs: []
  type: TYPE_NORMAL
- en: Examples
  prefs: []
  type: TYPE_NORMAL
- en: In [[4]](#r81ecfb019d82-4), bird foraging behavior was investigated in an old-growth
    forest of Oregon. In the forest, 44% of the canopy volume was Douglas fir, 24%
    was ponderosa pine, 29% was grand fir, and 3% was western larch. The authors observed
    the behavior of several species of birds, one of which was the red-breasted nuthatch.
    They made 189 observations of this species foraging, recording 43 (“23%”) of observations
    in Douglas fir, 52 (“28%”) in ponderosa pine, 54 (“29%”) in grand fir, and 40
    (“21%”) in western larch.
  prefs: []
  type: TYPE_NORMAL
- en: Using a chi-square test, we can test the null hypothesis that the proportions
    of foraging events are equal to the proportions of canopy volume. The authors
    of the paper considered a p-value less than 1% to be significant.
  prefs: []
  type: TYPE_NORMAL
- en: Using the above proportions of canopy volume and observed events, we can infer
    expected frequencies.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The observed frequencies of foraging were:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: We can now compare the observed frequencies with the expected frequencies.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The p-value is well below the chosen significance level. Hence, the authors
    considered the difference to be significant and concluded that the relative proportions
    of foraging events were not the same as the relative proportions of tree canopy
    volume.
  prefs: []
  type: TYPE_NORMAL
- en: Following are other generic examples to demonstrate how the other parameters
    can be used.
  prefs: []
  type: TYPE_NORMAL
- en: When just *f_obs* is given, it is assumed that the expected frequencies are
    uniform and given by the mean of the observed frequencies.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: With *f_exp* the expected frequencies can be given.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: When *f_obs* is 2-D, by default the test is applied to each column.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: By setting `axis=None`, the test is applied to all data in the array, which
    is equivalent to applying the test to the flattened array.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '*ddof* is the change to make to the default degrees of freedom.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: The calculation of the p-values is done by broadcasting the chi-squared statistic
    with *ddof*.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '*f_obs* and *f_exp* are also broadcast. In the following, *f_obs* has shape
    (6,) and *f_exp* has shape (2, 6), so the result of broadcasting *f_obs* and *f_exp*
    has shape (2, 6). To compute the desired chi-squared statistics, we use `axis=1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
